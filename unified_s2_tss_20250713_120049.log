2025-07-13 12:00:49,844 - INFO - [sentinel2_tss_pipeline.py:6047] - Auto-detected SNAP_HOME: C:\Program Files\esa-snap
2025-07-13 12:00:49,844 - INFO - [sentinel2_tss_pipeline.py:6088] - ================================================================================
2025-07-13 12:00:49,844 - INFO - [sentinel2_tss_pipeline.py:6089] - UNIFIED S2 PROCESSING & TSS ESTIMATION PIPELINE v1.0
2025-07-13 12:00:49,860 - INFO - [sentinel2_tss_pipeline.py:6090] - ================================================================================
2025-07-13 12:00:49,860 - INFO - [sentinel2_tss_pipeline.py:6091] - SNAP_HOME: C:\Program Files\esa-snap
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6092] - GPT: C:\Program Files\esa-snap\bin\gpt.exe
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6093] - Python: 3.9.22 | packaged by conda-forge | (main, Apr 10 2025, 22:07:06) [MSC v.1929 64 bit (AMD64)]
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6094] - Platform: win32
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6095] - Working Directory: C:\Users\pedro.goncalves\OneDrive - LNEG - Laboratorio Nacional de Energia e Geologia\GitHub\sentinel2-tss-pipeline
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6096] - ================================================================================
2025-07-13 12:00:49,863 - INFO - [sentinel2_tss_pipeline.py:6105] - Starting GUI application...
2025-07-13 12:02:06,990 - INFO - [sentinel2_tss_pipeline.py:2474] - SNAP_HOME: C:\Program Files\esa-snap
2025-07-13 12:02:11,342 - INFO - [sentinel2_tss_pipeline.py:2485] - ‚úì GPT validated: C:\Program Files\esa-snap\bin\gpt.exe
2025-07-13 12:02:11,358 - INFO - [sentinel2_tss_pipeline.py:2592] - Complete processing graph saved: s2_complete_processing_with_subset.xml
2025-07-13 12:02:11,361 - INFO - [sentinel2_tss_pipeline.py:2514] - ‚úì Processing graph created for mode: complete_pipeline
2025-07-13 12:02:11,363 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 12:02:11,363 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 12:02:11,364 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 12:02:11,364 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 12:02:11,365 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 12:02:11,366 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 12:02:11,367 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 12:02:11,367 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 12:02:11,368 - INFO - [sentinel2_tss_pipeline.py:3226] - Initialized Unified S2-TSS Processor - Mode: complete_pipeline
2025-07-13 12:02:11,369 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 12:02:11,369 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 1/63: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 12:02:11,370 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 12:02:11,376 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:07:37,307 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 12:07:37,314 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 12:07:37,314 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 12:07:37,315 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 12:07:37,315 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:07:37,315 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 12:07:37,317 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 12:07:37,325 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 12:07:37,325 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 12:07:37,325 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 12:07:37,539 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0340
2025-07-13 12:07:37,762 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.5250
2025-07-13 12:07:37,986 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1841
2025-07-13 12:07:37,986 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 12:07:38,407 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27075849 valid pixels out of 27075849 processed
2025-07-13 12:07:39,984 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 12:07:40,233 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.4% coverage, mean=0.797 mg/m¬≥
2025-07-13 12:07:40,233 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 12:07:40,741 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27075849 valid pixels out of 27075849 processed
2025-07-13 12:07:42,227 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 12:07:42,389 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.4% coverage, mean=0.882 g/m¬≥
2025-07-13 12:07:42,421 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 12:07:42,421 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:07:42,429 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:07:42,439 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:07:42,439 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:07:42,439 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 12:07:42,441 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 12:07:42,449 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 12:07:42,449 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 12:07:42,449 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-13 12:07:42,449 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 12:07:43,490 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 12:07:44,026 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27075849 valid pixels with corrected Jiang algorithm
2025-07-13 12:16:17,496 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 12:16:17,496 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27075849/32874120 (82.4%)
2025-07-13 12:16:17,557 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 12:16:17,579 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 18499064 pixels (68.3%)
2025-07-13 12:16:17,599 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 7193289 pixels (26.6%)
2025-07-13 12:16:17,628 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1383488 pixels (5.1%)
2025-07-13 12:16:17,650 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 12:16:17,679 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 12:16:17,681 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 12:16:17,681 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 12:16:17,681 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 12:16:18,016 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27075849 pixels
2025-07-13 12:16:18,139 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 15.44 m
2025-07-13 12:16:18,251 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.822
2025-07-13 12:16:18,251 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 12:16:18,251 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:16:18,401 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:16:18,444 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 12:16:18,767 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27075849 pixels
2025-07-13 12:16:18,767 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 12:16:19,050 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 12:16:19,052 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 12:16:19,400 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 12:16:19,725 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 12:16:19,725 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 12:16:19,725 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 107 pixels (0.0%)
2025-07-13 12:16:19,725 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 3068 pixels (0.0%)
2025-07-13 12:16:19,725 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1431 pixels (0.0%)
2025-07-13 12:16:19,736 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 12:16:19,736 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 12:16:19,756 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 12:16:19,756 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 12:16:19,756 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 12:16:19,764 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 12:16:21,328 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_Absorption.tif
2025-07-13 12:16:23,019 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_Backscattering.tif
2025-07-13 12:16:23,932 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_ReferenceBand.tif
2025-07-13 12:16:25,612 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_TSS.tif
2025-07-13 12:16:26,586 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_WaterTypes.tif
2025-07-13 12:16:27,489 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Jiang_ValidMask.tif
2025-07-13 12:16:29,287 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Secchidepth.tif
2025-07-13 12:16:31,038 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Clarityindex.tif
2025-07-13 12:16:32,846 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Euphoticdepth.tif
2025-07-13 12:16:34,655 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Diffuseattenuation.tif
2025-07-13 12:16:36,452 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Beamattenuation.tif
2025-07-13 12:16:38,146 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_Clarity_Turbidityproxy.tif
2025-07-13 12:16:38,899 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Probability.tif
2025-07-13 12:16:39,772 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Risk_Level.tif
2025-07-13 12:16:40,650 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_High_Biomass_Alert.tif
2025-07-13 12:16:41,555 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Extreme_Biomass_Alert.tif
2025-07-13 12:16:42,441 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Ndci_Bloom.tif
2025-07-13 12:16:43,323 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Flh_Bloom.tif
2025-07-13 12:16:44,197 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Mci_Bloom.tif
2025-07-13 12:16:45,069 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Cyanobacteria_Bloom.tif
2025-07-13 12:16:46,708 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Ndci_Values.tif
2025-07-13 12:16:48,465 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Flh_Values.tif
2025-07-13 12:16:50,232 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_HAB_Mci_Values.tif
2025-07-13 12:16:50,415 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_WaterTypes_Legend.txt
2025-07-13 12:16:50,415 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 12:16:50,415 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 12:16:50,423 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 12:16:50,423 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 12:16:50,423 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753
2025-07-13 12:16:50,587 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753 ===
2025-07-13 12:16:50,587 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.4%
2025-07-13 12:16:50,587 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 87.35 g/m¬≥
2025-07-13 12:16:50,587 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.70 g/m¬≥
2025-07-13 12:16:50,647 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 12:16:50,678 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 18499064 pixels (68.3%)
2025-07-13 12:16:50,698 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 7193289 pixels (26.6%)
2025-07-13 12:16:50,726 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1383488 pixels (5.1%)
2025-07-13 12:16:50,748 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 12:16:50,819 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 4606 pixels with bloom risk (107 high risk)
2025-07-13 12:16:50,819 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 12:16:50,829 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753_ProductIndex.txt
2025-07-13 12:16:50,829 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 12:16:50,829 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 12:16:50,829 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 12:16:50,829 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.4% coverage, mean=0.80
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.4% coverage, mean=0.88
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.4% coverage, mean=0.32
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.4% coverage, mean=0.01
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.4% coverage, mean=597.09
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.4% coverage, mean=0.70
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.13
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.4% coverage, mean=15.44
2025-07-13 12:16:50,921 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.4% coverage, mean=0.82
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.4% coverage, mean=41.84
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.4% coverage, mean=0.33
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.4% coverage, mean=0.33
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.4% coverage, mean=6.05
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.4% coverage, mean=-0.24
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 12:16:50,929 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 12:16:51,063 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 1/63 (1.6%), ETA: 913.6 minutes
2025-07-13 12:16:51,073 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 12:16:51,073 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 2/63: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306
2025-07-13 12:16:51,073 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 12:16:51,081 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 12:16:51,081 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306.zip
2025-07-13 12:16:51,081 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 12:16:51,083 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 12:16:51,083 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 12:16:51,083 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 12:22:14,693 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:22:14,693 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:22:14,695 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:22:14,696 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190108T113441_T29TNF_Subset_C2RCC.dim (20.7 MB)
2025-07-13 12:22:14,697 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190108T113441_T29TNF_Subset_C2RCC.data
2025-07-13 12:22:14,697 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:22:14,698 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 12:22:14,698 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 12:22:14,700 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 12:22:14,700 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 12:22:14,701 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:22:14,701 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:22:14,702 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:22:14,703 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:22:14,703 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:22:14,704 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:22:14,704 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:22:14,705 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:22:14,706 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:22:14,706 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:22:14,707 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 12:22:14,707 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:22:14,708 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306.zip
2025-07-13 12:22:14,709 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190108T113441_T29TNF_Subset_C2RCC.dim (20.7MB)
2025-07-13 12:22:14,709 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 12:22:14,710 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 12:22:14,711 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 12:22:14,711 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 12:22:14,712 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 12:22:14,712 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 12:22:14,935 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.4889
2025-07-13 12:22:15,168 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.4945
2025-07-13 12:22:15,383 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.1904
2025-07-13 12:22:15,384 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 12:22:15,856 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27118445 valid pixels out of 27118445 processed
2025-07-13 12:22:17,367 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 12:22:17,550 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.5% coverage, mean=12.265 mg/m¬≥
2025-07-13 12:22:17,551 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 12:22:18,065 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27118445 valid pixels out of 27118445 processed
2025-07-13 12:22:19,593 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 12:22:19,760 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.5% coverage, mean=2.031 g/m¬≥
2025-07-13 12:22:19,788 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 12:22:19,789 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 12:22:19,795 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:22:19,796 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:22:19,797 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:22:19,797 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190108T113441_T29TNF_Subset_C2RCC.dim (20.7 MB)
2025-07-13 12:22:19,797 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190108T113441_T29TNF_Subset_C2RCC.data
2025-07-13 12:22:19,798 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:22:19,799 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 12:22:19,799 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 12:22:19,800 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 12:22:19,801 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 12:22:19,801 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:22:19,802 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:22:19,802 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:22:19,803 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:22:19,804 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:22:19,804 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:22:19,805 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:22:19,805 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:22:19,806 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:22:19,806 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:22:19,807 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 12:22:19,808 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 12:22:19,808 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 12:22:19,809 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 12:22:19,810 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:22:19,810 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 12:22:19,811 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 12:22:19,811 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306.zip
2025-07-13 12:22:19,812 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 12:22:19,812 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 12:22:19,813 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 12:22:19,813 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 12:22:19,814 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 12:22:19,815 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 12:22:19,816 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 12:22:19,816 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 12:22:19,817 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306.zip
2025-07-13 12:22:19,819 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 12:22:20,701 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 12:22:21,235 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27118445 valid pixels with corrected Jiang algorithm
2025-07-13 12:30:35,053 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 12:30:35,054 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27118445/32874120 (82.5%)
2025-07-13 12:30:35,116 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 12:30:35,140 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 778306 pixels (2.9%)
2025-07-13 12:30:35,163 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 3496914 pixels (12.9%)
2025-07-13 12:30:35,186 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 22843223 pixels (84.2%)
2025-07-13 12:30:35,209 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 12:30:35,236 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 12:30:35,237 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 12:30:35,237 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 12:30:35,238 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 12:30:35,573 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27118445 pixels
2025-07-13 12:30:35,696 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 1.53 m
2025-07-13 12:30:35,824 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.337
2025-07-13 12:30:35,825 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 12:30:35,825 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:30:35,983 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:30:36,025 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 12:30:36,346 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27118445 pixels
2025-07-13 12:30:36,346 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 12:30:36,623 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 12:30:36,624 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 12:30:36,982 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 12:30:37,302 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 12:30:37,303 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 12:30:37,304 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 59 pixels (0.0%)
2025-07-13 12:30:37,305 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 9419 pixels (0.0%)
2025-07-13 12:30:37,306 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2292 pixels (0.0%)
2025-07-13 12:30:37,313 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 12:30:37,313 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 12:30:37,336 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 12:30:37,338 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 12:30:37,339 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 12:30:37,339 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 12:30:38,262 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_Absorption.tif
2025-07-13 12:30:39,961 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_Backscattering.tif
2025-07-13 12:30:40,854 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_ReferenceBand.tif
2025-07-13 12:30:42,602 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_TSS.tif
2025-07-13 12:30:43,579 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_WaterTypes.tif
2025-07-13 12:30:44,494 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Jiang_ValidMask.tif
2025-07-13 12:30:46,351 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Secchidepth.tif
2025-07-13 12:30:48,166 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Clarityindex.tif
2025-07-13 12:30:50,086 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Euphoticdepth.tif
2025-07-13 12:30:52,006 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Diffuseattenuation.tif
2025-07-13 12:30:53,877 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Beamattenuation.tif
2025-07-13 12:30:55,541 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_Clarity_Turbidityproxy.tif
2025-07-13 12:30:56,290 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Probability.tif
2025-07-13 12:30:57,173 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Risk_Level.tif
2025-07-13 12:30:58,038 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_High_Biomass_Alert.tif
2025-07-13 12:30:58,933 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Extreme_Biomass_Alert.tif
2025-07-13 12:30:59,832 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Ndci_Bloom.tif
2025-07-13 12:31:00,763 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Flh_Bloom.tif
2025-07-13 12:31:01,680 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Mci_Bloom.tif
2025-07-13 12:31:02,601 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Cyanobacteria_Bloom.tif
2025-07-13 12:31:04,332 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Ndci_Values.tif
2025-07-13 12:31:06,173 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Flh_Values.tif
2025-07-13 12:31:07,986 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_HAB_Mci_Values.tif
2025-07-13 12:31:08,172 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_WaterTypes_Legend.txt
2025-07-13 12:31:08,173 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 12:31:08,174 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 12:31:08,174 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 12:31:08,175 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 12:31:08,176 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306
2025-07-13 12:31:08,342 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306 ===
2025-07-13 12:31:08,343 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.5%
2025-07-13 12:31:08,344 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 88.45 g/m¬≥
2025-07-13 12:31:08,344 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.25 g/m¬≥
2025-07-13 12:31:08,405 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 12:31:08,429 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 778306 pixels (2.9%)
2025-07-13 12:31:08,452 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 3496914 pixels (12.9%)
2025-07-13 12:31:08,475 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 22843223 pixels (84.2%)
2025-07-13 12:31:08,498 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 12:31:08,569 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 11770 pixels with bloom risk (59 high risk)
2025-07-13 12:31:08,570 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 12:31:08,581 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190108T113441_N0500_R080_T29TNF_20221217T102306_ProductIndex.txt
2025-07-13 12:31:08,585 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 12:31:08,585 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 12:31:08,586 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 12:31:08,587 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 12:31:08,668 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 12:31:08,669 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.7MB, status=completed
2025-07-13 12:31:08,669 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.5% coverage, mean=12.26
2025-07-13 12:31:08,670 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.5% coverage, mean=2.03
2025-07-13 12:31:08,671 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.5% coverage, mean=2.35
2025-07-13 12:31:08,671 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.5% coverage, mean=0.02
2025-07-13 12:31:08,672 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.5% coverage, mean=725.16
2025-07-13 12:31:08,672 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.5% coverage, mean=2.25
2025-07-13 12:31:08,673 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=2.32
2025-07-13 12:31:08,674 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 12:31:08,674 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.5% coverage, mean=1.53
2025-07-13 12:31:08,675 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.5% coverage, mean=0.34
2025-07-13 12:31:08,676 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.5% coverage, mean=4.15
2025-07-13 12:31:08,677 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.5% coverage, mean=2.38
2025-07-13 12:31:08,677 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.5% coverage, mean=2.37
2025-07-13 12:31:08,678 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.5% coverage, mean=16.81
2025-07-13 12:31:08,679 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,679 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,680 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,680 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,681 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,682 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,682 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,683 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,683 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.5% coverage, mean=-0.14
2025-07-13 12:31:08,684 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,684 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 12:31:08,794 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 2/63 (3.2%), ETA: 885.4 minutes
2025-07-13 12:31:08,797 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 12:31:08,797 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 3/63: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841
2025-07-13 12:31:08,798 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 12:31:08,799 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 12:31:08,799 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841.zip
2025-07-13 12:31:08,800 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 12:31:08,801 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 12:31:08,801 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 12:31:08,803 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 12:36:37,766 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:36:37,767 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:36:37,768 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:36:37,769 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190115T112421_T29TNF_Subset_C2RCC.dim (24.2 MB)
2025-07-13 12:36:37,770 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190115T112421_T29TNF_Subset_C2RCC.data
2025-07-13 12:36:37,770 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:36:37,771 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 12:36:37,771 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 12:36:37,772 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 12:36:37,772 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 12:36:37,773 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:36:37,774 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:36:37,774 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:36:37,775 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:36:37,776 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:36:37,776 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:36:37,777 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:36:37,777 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:36:37,778 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:36:37,779 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:36:37,779 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 12:36:37,780 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:36:37,780 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841.zip
2025-07-13 12:36:37,781 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190115T112421_T29TNF_Subset_C2RCC.dim (24.2MB)
2025-07-13 12:36:37,781 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.5 minutes
2025-07-13 12:36:37,782 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 12:36:37,783 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 12:36:37,783 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 12:36:37,784 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 12:36:37,785 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 12:36:37,978 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0644
2025-07-13 12:36:38,168 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.4271
2025-07-13 12:36:38,359 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.2596
2025-07-13 12:36:38,360 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 12:36:38,787 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25820411 valid pixels out of 25820411 processed
2025-07-13 12:36:40,299 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 12:36:40,536 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 78.5% coverage, mean=1.614 mg/m¬≥
2025-07-13 12:36:40,537 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 12:36:41,098 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25820411 valid pixels out of 25820411 processed
2025-07-13 12:36:42,573 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 12:36:42,734 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 78.5% coverage, mean=0.896 g/m¬≥
2025-07-13 12:36:42,762 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 12:36:42,762 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 12:36:42,769 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:36:42,769 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:36:42,770 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:36:42,771 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190115T112421_T29TNF_Subset_C2RCC.dim (24.2 MB)
2025-07-13 12:36:42,771 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190115T112421_T29TNF_Subset_C2RCC.data
2025-07-13 12:36:42,772 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:36:42,772 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 12:36:42,773 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 12:36:42,774 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 12:36:42,774 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 12:36:42,775 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:36:42,776 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:36:42,776 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:36:42,777 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:36:42,777 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:36:42,778 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:36:42,778 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:36:42,779 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:36:42,780 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:36:42,780 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:36:42,781 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 12:36:42,781 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 12:36:42,782 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 12:36:42,783 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 12:36:42,783 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:36:42,784 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 12:36:42,784 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 12:36:42,785 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841.zip
2025-07-13 12:36:42,785 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 12:36:42,786 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 12:36:42,786 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 12:36:42,787 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 12:36:42,787 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 12:36:42,788 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 12:36:42,789 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 12:36:42,789 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 12:36:42,790 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841.zip
2025-07-13 12:36:42,792 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 12:36:43,555 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 12:36:44,097 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25820411 valid pixels with corrected Jiang algorithm
2025-07-13 12:44:44,192 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 12:44:44,193 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25820411/32874120 (78.5%)
2025-07-13 12:44:44,251 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 12:44:44,274 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 12781384 pixels (49.5%)
2025-07-13 12:44:44,297 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 6418012 pixels (24.9%)
2025-07-13 12:44:44,321 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 6621012 pixels (25.6%)
2025-07-13 12:44:44,345 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 3 pixels (0.0%)
2025-07-13 12:44:44,373 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 12:44:44,374 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 12:44:44,375 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 12:44:44,375 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 12:44:44,709 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25820411 pixels
2025-07-13 12:44:44,856 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 11.53 m
2025-07-13 12:44:44,972 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.691
2025-07-13 12:44:44,973 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 12:44:44,974 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:44:45,120 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:44:45,162 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 12:44:45,476 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25820411 pixels
2025-07-13 12:44:45,476 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 12:44:45,765 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 12:44:45,765 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 12:44:46,111 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 12:44:46,431 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 12:44:46,432 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 12:44:46,433 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 24 pixels (0.0%)
2025-07-13 12:44:46,433 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 998 pixels (0.0%)
2025-07-13 12:44:46,434 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 664 pixels (0.0%)
2025-07-13 12:44:46,441 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 12:44:46,442 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 12:44:46,464 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 12:44:46,466 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 12:44:46,467 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 12:44:46,467 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 12:44:47,890 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_Absorption.tif
2025-07-13 12:44:49,523 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_Backscattering.tif
2025-07-13 12:44:50,394 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_ReferenceBand.tif
2025-07-13 12:44:52,062 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_TSS.tif
2025-07-13 12:44:53,028 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_WaterTypes.tif
2025-07-13 12:44:53,891 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Jiang_ValidMask.tif
2025-07-13 12:44:55,648 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Secchidepth.tif
2025-07-13 12:44:57,306 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Clarityindex.tif
2025-07-13 12:44:59,052 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Euphoticdepth.tif
2025-07-13 12:45:00,841 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Diffuseattenuation.tif
2025-07-13 12:45:02,639 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Beamattenuation.tif
2025-07-13 12:45:04,270 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_Clarity_Turbidityproxy.tif
2025-07-13 12:45:04,994 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Probability.tif
2025-07-13 12:45:05,859 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Risk_Level.tif
2025-07-13 12:45:06,704 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_High_Biomass_Alert.tif
2025-07-13 12:45:07,564 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Extreme_Biomass_Alert.tif
2025-07-13 12:45:08,426 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Ndci_Bloom.tif
2025-07-13 12:45:09,324 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Flh_Bloom.tif
2025-07-13 12:45:10,190 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Mci_Bloom.tif
2025-07-13 12:45:11,035 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Cyanobacteria_Bloom.tif
2025-07-13 12:45:12,633 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Ndci_Values.tif
2025-07-13 12:45:14,377 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Flh_Values.tif
2025-07-13 12:45:16,095 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_HAB_Mci_Values.tif
2025-07-13 12:45:16,280 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_WaterTypes_Legend.txt
2025-07-13 12:45:16,280 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 12:45:16,281 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 12:45:16,282 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 12:45:16,283 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 12:45:16,283 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841
2025-07-13 12:45:16,442 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841 ===
2025-07-13 12:45:16,443 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 78.5%
2025-07-13 12:45:16,444 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 86.17 g/m¬≥
2025-07-13 12:45:16,445 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.80 g/m¬≥
2025-07-13 12:45:16,503 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 12:45:16,526 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 12781384 pixels (49.5%)
2025-07-13 12:45:16,548 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 6418012 pixels (24.9%)
2025-07-13 12:45:16,570 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 6621012 pixels (25.6%)
2025-07-13 12:45:16,592 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 3 pixels (0.0%)
2025-07-13 12:45:16,662 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 1686 pixels with bloom risk (24 high risk)
2025-07-13 12:45:16,662 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 12:45:16,667 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190115T112421_N0500_R037_T29TNF_20221216T070841_ProductIndex.txt
2025-07-13 12:45:16,670 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 12:45:16,671 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 12:45:16,672 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 12:45:16,672 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 12:45:16,768 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 12:45:16,769 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 24.2MB, status=completed
2025-07-13 12:45:16,770 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 78.5% coverage, mean=1.61
2025-07-13 12:45:16,771 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 78.5% coverage, mean=0.90
2025-07-13 12:45:16,771 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 78.5% coverage, mean=0.86
2025-07-13 12:45:16,772 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 78.5% coverage, mean=0.01
2025-07-13 12:45:16,772 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 78.5% coverage, mean=632.26
2025-07-13 12:45:16,773 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 78.5% coverage, mean=0.80
2025-07-13 12:45:16,773 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.38
2025-07-13 12:45:16,774 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.79
2025-07-13 12:45:16,775 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 78.5% coverage, mean=11.53
2025-07-13 12:45:16,775 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 78.5% coverage, mean=0.69
2025-07-13 12:45:16,776 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 78.5% coverage, mean=31.22
2025-07-13 12:45:16,777 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 78.5% coverage, mean=0.87
2025-07-13 12:45:16,777 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 78.5% coverage, mean=0.86
2025-07-13 12:45:16,778 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 78.5% coverage, mean=6.40
2025-07-13 12:45:16,778 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,779 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,780 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,780 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,781 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,781 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,782 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,782 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,783 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 78.5% coverage, mean=-0.23
2025-07-13 12:45:16,783 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,784 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 12:45:16,901 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 3/63 (4.8%), ETA: 863.3 minutes
2025-07-13 12:45:16,903 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 12:45:16,904 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 4/63: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451
2025-07-13 12:45:16,904 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 12:45:16,905 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 12:45:16,906 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451.zip
2025-07-13 12:45:16,906 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 12:45:16,907 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 12:45:16,907 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 12:45:16,909 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 12:50:37,091 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:50:37,092 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:50:37,092 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:50:37,093 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190125T112341_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 12:50:37,093 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190125T112341_T29TNF_Subset_C2RCC.data
2025-07-13 12:50:37,094 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:50:37,094 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 12:50:37,096 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 12:50:37,096 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 12:50:37,097 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 12:50:37,097 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:50:37,098 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:50:37,098 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:50:37,098 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:50:37,099 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:50:37,100 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:50:37,100 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:50:37,101 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:50:37,102 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:50:37,102 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:50:37,103 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 12:50:37,104 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:50:37,104 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451.zip
2025-07-13 12:50:37,104 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190125T112341_T29TNF_Subset_C2RCC.dim (43.2MB)
2025-07-13 12:50:37,105 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 12:50:37,106 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 12:50:37,106 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 12:50:37,107 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 12:50:37,107 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 12:50:37,107 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 12:50:37,295 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0424
2025-07-13 12:50:37,484 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.0993
2025-07-13 12:50:37,673 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.4143
2025-07-13 12:50:37,673 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 12:50:38,114 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27028821 valid pixels out of 27028821 processed
2025-07-13 12:50:39,584 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 12:50:39,832 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.2% coverage, mean=1.008 mg/m¬≥
2025-07-13 12:50:39,833 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 12:50:40,404 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27028821 valid pixels out of 27028821 processed
2025-07-13 12:50:41,818 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 12:50:41,989 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.2% coverage, mean=1.828 g/m¬≥
2025-07-13 12:50:42,017 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 12:50:42,018 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 12:50:42,024 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 12:50:42,024 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 12:50:42,025 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 12:50:42,026 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190125T112341_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 12:50:42,026 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190125T112341_T29TNF_Subset_C2RCC.data
2025-07-13 12:50:42,027 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 12:50:42,027 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 12:50:42,028 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 12:50:42,029 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 12:50:42,029 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 12:50:42,030 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 12:50:42,030 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 12:50:42,031 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 12:50:42,031 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 12:50:42,032 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 12:50:42,032 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 12:50:42,033 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 12:50:42,033 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 12:50:42,034 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 12:50:42,035 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 12:50:42,036 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 12:50:42,036 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 12:50:42,037 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 12:50:42,037 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 12:50:42,037 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 12:50:42,038 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 12:50:42,039 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 12:50:42,039 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451.zip
2025-07-13 12:50:42,040 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 12:50:42,040 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 12:50:42,041 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 12:50:42,041 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 12:50:42,042 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 12:50:42,043 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 12:50:42,043 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 12:50:42,044 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 12:50:42,045 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451.zip
2025-07-13 12:50:42,046 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 12:50:42,866 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 12:50:43,400 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27028821 valid pixels with corrected Jiang algorithm
2025-07-13 12:59:14,057 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 12:59:14,058 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27028821/32874120 (82.2%)
2025-07-13 12:59:14,120 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 12:59:14,146 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 19660658 pixels (72.7%)
2025-07-13 12:59:14,171 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 6055414 pixels (22.4%)
2025-07-13 12:59:14,195 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1312736 pixels (4.9%)
2025-07-13 12:59:14,220 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 13 pixels (0.0%)
2025-07-13 12:59:14,248 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 12:59:14,256 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 12:59:14,256 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 12:59:14,257 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 12:59:14,593 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27028821 pixels
2025-07-13 12:59:14,712 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 14.20 m
2025-07-13 12:59:14,829 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.825
2025-07-13 12:59:14,829 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 12:59:14,830 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:59:15,012 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 12:59:15,055 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 12:59:15,375 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27028821 pixels
2025-07-13 12:59:15,375 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 12:59:15,653 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 12:59:15,654 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 12:59:16,030 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 12:59:16,357 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 12:59:16,358 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 12:59:16,359 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 591 pixels (0.0%)
2025-07-13 12:59:16,359 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 13162 pixels (0.0%)
2025-07-13 12:59:16,360 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 4313 pixels (0.0%)
2025-07-13 12:59:16,367 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 12:59:16,368 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 12:59:16,391 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 12:59:16,394 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 12:59:16,394 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 12:59:16,395 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 12:59:17,855 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_Absorption.tif
2025-07-13 12:59:19,409 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_Backscattering.tif
2025-07-13 12:59:20,285 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_ReferenceBand.tif
2025-07-13 12:59:21,845 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_TSS.tif
2025-07-13 12:59:22,724 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_WaterTypes.tif
2025-07-13 12:59:23,597 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Jiang_ValidMask.tif
2025-07-13 12:59:25,345 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Secchidepth.tif
2025-07-13 12:59:27,091 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Clarityindex.tif
2025-07-13 12:59:28,799 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Euphoticdepth.tif
2025-07-13 12:59:30,514 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Diffuseattenuation.tif
2025-07-13 12:59:32,259 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Beamattenuation.tif
2025-07-13 12:59:33,848 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_Clarity_Turbidityproxy.tif
2025-07-13 12:59:34,590 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Probability.tif
2025-07-13 12:59:35,451 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Risk_Level.tif
2025-07-13 12:59:36,316 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_High_Biomass_Alert.tif
2025-07-13 12:59:37,167 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Extreme_Biomass_Alert.tif
2025-07-13 12:59:38,013 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Ndci_Bloom.tif
2025-07-13 12:59:38,865 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Flh_Bloom.tif
2025-07-13 12:59:39,725 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Mci_Bloom.tif
2025-07-13 12:59:40,574 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Cyanobacteria_Bloom.tif
2025-07-13 12:59:42,245 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Ndci_Values.tif
2025-07-13 12:59:43,916 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Flh_Values.tif
2025-07-13 12:59:45,631 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_HAB_Mci_Values.tif
2025-07-13 12:59:45,817 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_WaterTypes_Legend.txt
2025-07-13 12:59:45,817 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 12:59:45,818 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 12:59:45,819 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 12:59:45,820 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 12:59:45,820 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451
2025-07-13 12:59:45,987 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451 ===
2025-07-13 12:59:45,988 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.2%
2025-07-13 12:59:45,989 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.04 - 89.55 g/m¬≥
2025-07-13 12:59:45,990 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.83 g/m¬≥
2025-07-13 12:59:46,052 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 12:59:46,075 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 19660658 pixels (72.7%)
2025-07-13 12:59:46,101 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 6055414 pixels (22.4%)
2025-07-13 12:59:46,125 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1312736 pixels (4.9%)
2025-07-13 12:59:46,149 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 13 pixels (0.0%)
2025-07-13 12:59:46,220 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 18066 pixels with bloom risk (591 high risk)
2025-07-13 12:59:46,221 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 12:59:46,226 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190125T112341_N0500_R037_T29TNF_20221203T203451_ProductIndex.txt
2025-07-13 12:59:46,229 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 12:59:46,230 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 12:59:46,230 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 12:59:46,231 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 12:59:46,319 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 12:59:46,320 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 43.2MB, status=completed
2025-07-13 12:59:46,321 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.2% coverage, mean=1.01
2025-07-13 12:59:46,321 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.2% coverage, mean=1.83
2025-07-13 12:59:46,322 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.2% coverage, mean=0.30
2025-07-13 12:59:46,322 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.2% coverage, mean=0.02
2025-07-13 12:59:46,323 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.2% coverage, mean=592.27
2025-07-13 12:59:46,324 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.2% coverage, mean=1.83
2025-07-13 12:59:46,324 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.09
2025-07-13 12:59:46,325 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 12:59:46,325 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.2% coverage, mean=14.20
2025-07-13 12:59:46,326 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.2% coverage, mean=0.83
2025-07-13 12:59:46,327 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.2% coverage, mean=38.46
2025-07-13 12:59:46,327 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.2% coverage, mean=0.32
2025-07-13 12:59:46,328 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.2% coverage, mean=0.31
2025-07-13 12:59:46,328 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.2% coverage, mean=16.33
2025-07-13 12:59:46,329 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,330 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,330 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,331 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,331 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,332 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,332 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,333 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,333 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.2% coverage, mean=-0.24
2025-07-13 12:59:46,334 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,334 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 12:59:46,445 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 4/63 (6.3%), ETA: 850.5 minutes
2025-07-13 12:59:46,447 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 12:59:46,447 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 5/63: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106
2025-07-13 12:59:46,448 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 12:59:46,449 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 12:59:46,449 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106.zip
2025-07-13 12:59:46,450 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 12:59:46,450 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 12:59:46,451 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 12:59:46,453 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 13:04:54,841 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:04:54,842 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:04:54,843 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:04:54,843 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190204T112251_T29TNF_Subset_C2RCC.dim (38.5 MB)
2025-07-13 13:04:54,844 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190204T112251_T29TNF_Subset_C2RCC.data
2025-07-13 13:04:54,844 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:04:54,845 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 13:04:54,846 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 13:04:54,846 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 13:04:54,847 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 13:04:54,847 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:04:54,848 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:04:54,848 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:04:54,849 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:04:54,850 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:04:54,851 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:04:54,851 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:04:54,851 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:04:54,852 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:04:54,852 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:04:54,853 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 13:04:54,853 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:04:54,854 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106.zip
2025-07-13 13:04:54,855 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190204T112251_T29TNF_Subset_C2RCC.dim (38.5MB)
2025-07-13 13:04:54,855 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.1 minutes
2025-07-13 13:04:54,856 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 13:04:54,856 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 13:04:54,857 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 13:04:54,857 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 13:04:54,858 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 13:04:55,048 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0922
2025-07-13 13:04:55,239 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.5969
2025-07-13 13:04:55,427 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.3682
2025-07-13 13:04:55,428 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 13:04:55,855 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26186195 valid pixels out of 26186195 processed
2025-07-13 13:04:57,302 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 13:04:57,483 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 79.7% coverage, mean=2.285 mg/m¬≥
2025-07-13 13:04:57,484 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 13:04:57,930 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26186195 valid pixels out of 26186195 processed
2025-07-13 13:04:59,280 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 13:04:59,440 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 79.7% coverage, mean=2.447 g/m¬≥
2025-07-13 13:04:59,468 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 13:04:59,469 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 13:04:59,476 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:04:59,476 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:04:59,477 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:04:59,478 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190204T112251_T29TNF_Subset_C2RCC.dim (38.5 MB)
2025-07-13 13:04:59,478 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190204T112251_T29TNF_Subset_C2RCC.data
2025-07-13 13:04:59,479 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:04:59,480 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 13:04:59,480 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 13:04:59,481 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 13:04:59,482 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 13:04:59,482 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:04:59,483 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:04:59,484 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:04:59,484 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:04:59,485 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:04:59,485 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:04:59,486 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:04:59,487 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:04:59,487 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:04:59,488 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:04:59,489 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 13:04:59,489 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 13:04:59,490 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 13:04:59,491 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 13:04:59,491 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:04:59,492 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 13:04:59,492 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 13:04:59,493 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106.zip
2025-07-13 13:04:59,493 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 13:04:59,494 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 13:04:59,495 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 13:04:59,496 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 13:04:59,496 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 13:04:59,497 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 13:04:59,497 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 13:04:59,498 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 13:04:59,499 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106.zip
2025-07-13 13:04:59,501 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 13:05:00,311 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 13:05:00,824 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26186195 valid pixels with corrected Jiang algorithm
2025-07-13 13:13:03,780 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 13:13:03,781 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26186195/32874120 (79.7%)
2025-07-13 13:13:03,840 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 13:13:03,863 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 9842671 pixels (37.6%)
2025-07-13 13:13:03,887 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 15209450 pixels (58.1%)
2025-07-13 13:13:03,911 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1134073 pixels (4.3%)
2025-07-13 13:13:03,937 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 13:13:03,970 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 13:13:03,971 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 13:13:03,971 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 13:13:03,972 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 13:13:04,306 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26186195 pixels
2025-07-13 13:13:04,422 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 8.47 m
2025-07-13 13:13:04,537 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.738
2025-07-13 13:13:04,538 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 13:13:04,538 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:13:04,670 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:13:04,713 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 13:13:05,044 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26186195 pixels
2025-07-13 13:13:05,045 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 13:13:05,319 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 13:13:05,319 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 13:13:05,665 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 13:13:05,992 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 13:13:05,993 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 13:13:05,993 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 98 pixels (0.0%)
2025-07-13 13:13:05,994 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4664 pixels (0.0%)
2025-07-13 13:13:05,995 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1386 pixels (0.0%)
2025-07-13 13:13:06,002 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 13:13:06,003 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 13:13:06,026 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 13:13:06,028 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 13:13:06,029 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 13:13:06,029 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 13:13:07,490 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_Absorption.tif
2025-07-13 13:13:09,031 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_Backscattering.tif
2025-07-13 13:13:09,904 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_ReferenceBand.tif
2025-07-13 13:13:11,430 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_TSS.tif
2025-07-13 13:13:12,305 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_WaterTypes.tif
2025-07-13 13:13:13,165 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Jiang_ValidMask.tif
2025-07-13 13:13:14,864 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Secchidepth.tif
2025-07-13 13:13:16,593 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Clarityindex.tif
2025-07-13 13:13:18,286 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Euphoticdepth.tif
2025-07-13 13:13:19,979 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Diffuseattenuation.tif
2025-07-13 13:13:21,683 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Beamattenuation.tif
2025-07-13 13:13:23,258 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_Clarity_Turbidityproxy.tif
2025-07-13 13:13:23,999 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Probability.tif
2025-07-13 13:13:24,873 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Risk_Level.tif
2025-07-13 13:13:25,754 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_High_Biomass_Alert.tif
2025-07-13 13:13:26,617 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Extreme_Biomass_Alert.tif
2025-07-13 13:13:27,492 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Ndci_Bloom.tif
2025-07-13 13:13:28,342 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Flh_Bloom.tif
2025-07-13 13:13:29,195 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Mci_Bloom.tif
2025-07-13 13:13:30,048 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Cyanobacteria_Bloom.tif
2025-07-13 13:13:31,710 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Ndci_Values.tif
2025-07-13 13:13:33,363 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Flh_Values.tif
2025-07-13 13:13:35,086 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_HAB_Mci_Values.tif
2025-07-13 13:13:35,272 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_WaterTypes_Legend.txt
2025-07-13 13:13:35,273 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 13:13:35,274 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 13:13:35,275 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 13:13:35,275 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 13:13:35,276 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106
2025-07-13 13:13:35,436 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106 ===
2025-07-13 13:13:35,437 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 79.7%
2025-07-13 13:13:35,437 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 83.81 g/m¬≥
2025-07-13 13:13:35,438 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.40 g/m¬≥
2025-07-13 13:13:35,496 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 13:13:35,519 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 9842671 pixels (37.6%)
2025-07-13 13:13:35,543 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 15209450 pixels (58.1%)
2025-07-13 13:13:35,566 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1134073 pixels (4.3%)
2025-07-13 13:13:35,589 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 13:13:35,659 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 6148 pixels with bloom risk (98 high risk)
2025-07-13 13:13:35,659 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 13:13:35,665 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190204T112251_N0500_R037_T29TNF_20221124T011106_ProductIndex.txt
2025-07-13 13:13:35,668 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 13:13:35,669 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 13:13:35,669 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 13:13:35,670 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 13:13:35,760 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 13:13:35,760 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 38.5MB, status=completed
2025-07-13 13:13:35,761 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 79.7% coverage, mean=2.29
2025-07-13 13:13:35,762 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 79.7% coverage, mean=2.45
2025-07-13 13:13:35,762 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 79.7% coverage, mean=0.42
2025-07-13 13:13:35,763 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 79.7% coverage, mean=0.02
2025-07-13 13:13:35,763 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 79.7% coverage, mean=628.78
2025-07-13 13:13:35,764 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 79.7% coverage, mean=2.40
2025-07-13 13:13:35,765 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.33
2025-07-13 13:13:35,765 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.80
2025-07-13 13:13:35,766 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 79.7% coverage, mean=8.47
2025-07-13 13:13:35,767 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 79.7% coverage, mean=0.74
2025-07-13 13:13:35,767 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 79.7% coverage, mean=22.95
2025-07-13 13:13:35,768 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 79.7% coverage, mean=0.45
2025-07-13 13:13:35,768 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 79.7% coverage, mean=0.44
2025-07-13 13:13:35,768 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 79.7% coverage, mean=21.14
2025-07-13 13:13:35,770 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,770 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,771 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,771 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,772 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,772 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,773 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,774 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,775 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 79.7% coverage, mean=-0.23
2025-07-13 13:13:35,775 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 13:13:35,776 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 13:13:35,893 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 5/63 (7.9%), ETA: 829.2 minutes
2025-07-13 13:13:35,895 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 13:13:35,895 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 6/63: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306
2025-07-13 13:13:35,896 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 13:13:35,897 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 13:13:35,898 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306.zip
2025-07-13 13:13:35,898 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 13:13:35,899 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 13:13:35,899 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 13:13:35,901 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 13:18:53,628 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:18:53,628 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:18:53,629 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:18:53,630 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190214T112151_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 13:18:53,630 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190214T112151_T29TNF_Subset_C2RCC.data
2025-07-13 13:18:53,631 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:18:53,632 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 13:18:53,632 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 13:18:53,633 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 13:18:53,633 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 13:18:53,634 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:18:53,635 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:18:53,635 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:18:53,636 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:18:53,637 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:18:53,637 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:18:53,638 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:18:53,638 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:18:53,639 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:18:53,640 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:18:53,640 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 13:18:53,641 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:18:53,641 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306.zip
2025-07-13 13:18:53,642 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190214T112151_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 13:18:53,643 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 13:18:53,643 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 13:18:53,644 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 13:18:53,644 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 13:18:53,645 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 13:18:53,646 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 13:18:53,842 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0232
2025-07-13 13:18:54,037 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.5167
2025-07-13 13:18:54,231 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1851
2025-07-13 13:18:54,232 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 13:18:54,701 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26955699 valid pixels out of 26955699 processed
2025-07-13 13:18:56,173 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 13:18:56,340 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.0% coverage, mean=0.551 mg/m¬≥
2025-07-13 13:18:56,341 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 13:18:56,789 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26955699 valid pixels out of 26955699 processed
2025-07-13 13:18:58,170 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 13:18:58,339 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.0% coverage, mean=0.878 g/m¬≥
2025-07-13 13:18:58,371 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 13:18:58,372 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 13:18:58,378 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:18:58,378 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:18:58,380 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:18:58,380 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190214T112151_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 13:18:58,380 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190214T112151_T29TNF_Subset_C2RCC.data
2025-07-13 13:18:58,381 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:18:58,382 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 13:18:58,383 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 13:18:58,383 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 13:18:58,383 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 13:18:58,384 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:18:58,384 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:18:58,386 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:18:58,386 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:18:58,386 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:18:58,387 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:18:58,387 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:18:58,388 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:18:58,388 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:18:58,389 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:18:58,390 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 13:18:58,390 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 13:18:58,391 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 13:18:58,392 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 13:18:58,392 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:18:58,392 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 13:18:58,393 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 13:18:58,394 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306.zip
2025-07-13 13:18:58,394 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 13:18:58,395 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 13:18:58,396 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 13:18:58,396 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 13:18:58,397 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 13:18:58,397 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 13:18:58,398 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 13:18:58,399 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 13:18:58,400 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306.zip
2025-07-13 13:18:58,401 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 13:18:59,194 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 13:18:59,726 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26955699 valid pixels with corrected Jiang algorithm
2025-07-13 13:27:43,635 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 13:27:43,636 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26955699/32874120 (82.0%)
2025-07-13 13:27:43,696 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 13:27:43,719 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 24417172 pixels (90.6%)
2025-07-13 13:27:43,743 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 1791520 pixels (6.6%)
2025-07-13 13:27:43,767 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 747002 pixels (2.8%)
2025-07-13 13:27:43,790 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 5 pixels (0.0%)
2025-07-13 13:27:43,817 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 13:27:43,818 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 13:27:43,819 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 13:27:43,820 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 13:27:44,164 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26955699 pixels
2025-07-13 13:27:44,286 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 19.19 m
2025-07-13 13:27:44,410 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.887
2025-07-13 13:27:44,411 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 13:27:44,412 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:27:44,570 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:27:44,614 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 13:27:44,931 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26955699 pixels
2025-07-13 13:27:44,932 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 13:27:45,210 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 13:27:45,211 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 13:27:45,569 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 13:27:45,894 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 13:27:45,895 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 13:27:45,895 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 133 pixels (0.0%)
2025-07-13 13:27:45,896 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 3539 pixels (0.0%)
2025-07-13 13:27:45,897 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2110 pixels (0.0%)
2025-07-13 13:27:45,904 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 13:27:45,905 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 13:27:45,926 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 13:27:45,928 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 13:27:45,928 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 13:27:45,929 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 13:27:47,390 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_Absorption.tif
2025-07-13 13:27:48,939 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_Backscattering.tif
2025-07-13 13:27:49,814 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_ReferenceBand.tif
2025-07-13 13:27:51,366 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_TSS.tif
2025-07-13 13:27:52,228 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_WaterTypes.tif
2025-07-13 13:27:53,092 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Jiang_ValidMask.tif
2025-07-13 13:27:54,787 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Secchidepth.tif
2025-07-13 13:27:56,544 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Clarityindex.tif
2025-07-13 13:27:58,211 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Euphoticdepth.tif
2025-07-13 13:27:59,904 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Diffuseattenuation.tif
2025-07-13 13:28:01,627 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Beamattenuation.tif
2025-07-13 13:28:03,242 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_Clarity_Turbidityproxy.tif
2025-07-13 13:28:03,975 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Probability.tif
2025-07-13 13:28:04,831 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Risk_Level.tif
2025-07-13 13:28:05,695 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_High_Biomass_Alert.tif
2025-07-13 13:28:06,583 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Extreme_Biomass_Alert.tif
2025-07-13 13:28:07,429 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Ndci_Bloom.tif
2025-07-13 13:28:08,277 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Flh_Bloom.tif
2025-07-13 13:28:09,151 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Mci_Bloom.tif
2025-07-13 13:28:09,998 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Cyanobacteria_Bloom.tif
2025-07-13 13:28:11,665 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Ndci_Values.tif
2025-07-13 13:28:13,351 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Flh_Values.tif
2025-07-13 13:28:15,045 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_HAB_Mci_Values.tif
2025-07-13 13:28:15,229 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_WaterTypes_Legend.txt
2025-07-13 13:28:15,230 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 13:28:15,231 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 13:28:15,231 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 13:28:15,232 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 13:28:15,233 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306
2025-07-13 13:28:15,396 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306 ===
2025-07-13 13:28:15,397 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.0%
2025-07-13 13:28:15,397 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.94 g/m¬≥
2025-07-13 13:28:15,398 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.79 g/m¬≥
2025-07-13 13:28:15,458 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 13:28:15,482 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 24417172 pixels (90.6%)
2025-07-13 13:28:15,506 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 1791520 pixels (6.6%)
2025-07-13 13:28:15,529 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 747002 pixels (2.8%)
2025-07-13 13:28:15,552 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 5 pixels (0.0%)
2025-07-13 13:28:15,623 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 5782 pixels with bloom risk (133 high risk)
2025-07-13 13:28:15,623 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 13:28:15,628 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190214T112151_N0500_R037_T29TNF_20221126T200306_ProductIndex.txt
2025-07-13 13:28:15,632 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 13:28:15,633 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 13:28:15,633 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 13:28:15,634 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 13:28:15,714 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 13:28:15,715 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 13:28:15,716 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.0% coverage, mean=0.55
2025-07-13 13:28:15,717 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.0% coverage, mean=0.88
2025-07-13 13:28:15,717 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.0% coverage, mean=0.18
2025-07-13 13:28:15,718 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.0% coverage, mean=0.01
2025-07-13 13:28:15,718 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.0% coverage, mean=571.97
2025-07-13 13:28:15,719 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.0% coverage, mean=0.79
2025-07-13 13:28:15,719 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.92
2025-07-13 13:28:15,720 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 13:28:15,720 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.0% coverage, mean=19.19
2025-07-13 13:28:15,721 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.0% coverage, mean=0.89
2025-07-13 13:28:15,722 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.0% coverage, mean=51.98
2025-07-13 13:28:15,723 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.0% coverage, mean=0.19
2025-07-13 13:28:15,723 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.0% coverage, mean=0.18
2025-07-13 13:28:15,724 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.0% coverage, mean=7.22
2025-07-13 13:28:15,724 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,725 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,725 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,726 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,727 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,727 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,728 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,729 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,729 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.0% coverage, mean=-0.25
2025-07-13 13:28:15,730 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 13:28:15,730 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 13:28:15,834 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 6/63 (9.5%), ETA: 818.4 minutes
2025-07-13 13:28:15,836 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 13:28:15,837 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 7/63: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254
2025-07-13 13:28:15,837 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 13:28:15,838 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 13:28:15,839 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254.zip
2025-07-13 13:28:15,839 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 13:28:15,840 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 13:28:15,841 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 13:28:15,842 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 13:33:40,468 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:33:40,469 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:33:40,470 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:33:40,471 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190224T112111_T29TNF_Subset_C2RCC.dim (34.8 MB)
2025-07-13 13:33:40,471 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190224T112111_T29TNF_Subset_C2RCC.data
2025-07-13 13:33:40,472 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:33:40,472 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 13:33:40,472 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 13:33:40,474 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 13:33:40,474 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 13:33:40,475 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:33:40,475 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:33:40,476 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:33:40,476 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:33:40,477 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:33:40,478 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:33:40,478 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:33:40,479 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:33:40,479 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:33:40,480 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:33:40,480 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 13:33:40,481 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:33:40,482 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254.zip
2025-07-13 13:33:40,482 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190224T112111_T29TNF_Subset_C2RCC.dim (34.8MB)
2025-07-13 13:33:40,483 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 13:33:40,484 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 13:33:40,484 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 13:33:40,485 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 13:33:40,486 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 13:33:40,486 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 13:33:40,674 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1488
2025-07-13 13:33:40,860 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8774
2025-07-13 13:33:41,057 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.5303
2025-07-13 13:33:41,058 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 13:33:41,495 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26621927 valid pixels out of 26621927 processed
2025-07-13 13:33:43,020 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 13:33:43,205 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.0% coverage, mean=3.677 mg/m¬≥
2025-07-13 13:33:43,206 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 13:33:43,654 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26621927 valid pixels out of 26621927 processed
2025-07-13 13:33:45,075 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 13:33:45,237 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.0% coverage, mean=1.706 g/m¬≥
2025-07-13 13:33:45,265 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 13:33:45,265 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 13:33:45,271 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:33:45,272 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:33:45,272 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:33:45,273 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190224T112111_T29TNF_Subset_C2RCC.dim (34.8 MB)
2025-07-13 13:33:45,274 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190224T112111_T29TNF_Subset_C2RCC.data
2025-07-13 13:33:45,274 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:33:45,275 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 13:33:45,275 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 13:33:45,276 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 13:33:45,277 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 13:33:45,277 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:33:45,278 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:33:45,278 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:33:45,280 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:33:45,281 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:33:45,281 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:33:45,282 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:33:45,282 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:33:45,283 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:33:45,284 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:33:45,284 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 13:33:45,285 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 13:33:45,285 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 13:33:45,286 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 13:33:45,287 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:33:45,287 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 13:33:45,287 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 13:33:45,288 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254.zip
2025-07-13 13:33:45,289 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 13:33:45,289 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 13:33:45,290 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 13:33:45,291 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 13:33:45,291 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 13:33:45,292 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 13:33:45,292 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 13:33:45,293 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 13:33:45,294 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254.zip
2025-07-13 13:33:45,295 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 13:33:46,052 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 13:33:46,569 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26621927 valid pixels with corrected Jiang algorithm
2025-07-13 13:41:57,929 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 13:41:57,930 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26621927/32874120 (81.0%)
2025-07-13 13:41:57,989 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 13:41:58,012 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 7867601 pixels (29.6%)
2025-07-13 13:41:58,035 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 10764908 pixels (40.4%)
2025-07-13 13:41:58,059 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 7989411 pixels (30.0%)
2025-07-13 13:41:58,085 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 13:41:58,112 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 13:41:58,113 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 13:41:58,114 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 13:41:58,115 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 13:41:58,450 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26621927 pixels
2025-07-13 13:41:58,566 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 7.60 m
2025-07-13 13:41:58,682 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.618
2025-07-13 13:41:58,683 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 13:41:58,684 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:41:58,847 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:41:58,894 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 13:41:59,208 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26621927 pixels
2025-07-13 13:41:59,209 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 13:41:59,493 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 13:41:59,494 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 13:41:59,852 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 13:42:00,179 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 13:42:00,180 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 13:42:00,181 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 544 pixels (0.0%)
2025-07-13 13:42:00,182 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 7564 pixels (0.0%)
2025-07-13 13:42:00,182 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3352 pixels (0.0%)
2025-07-13 13:42:00,189 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 13:42:00,190 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 13:42:00,211 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 13:42:00,214 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 13:42:00,214 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 13:42:00,215 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 13:42:01,630 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_Absorption.tif
2025-07-13 13:42:03,314 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_Backscattering.tif
2025-07-13 13:42:04,176 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_ReferenceBand.tif
2025-07-13 13:42:05,786 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_TSS.tif
2025-07-13 13:42:06,725 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_WaterTypes.tif
2025-07-13 13:42:07,597 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Jiang_ValidMask.tif
2025-07-13 13:42:09,381 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Secchidepth.tif
2025-07-13 13:42:11,074 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Clarityindex.tif
2025-07-13 13:42:12,852 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Euphoticdepth.tif
2025-07-13 13:42:14,634 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Diffuseattenuation.tif
2025-07-13 13:42:16,383 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Beamattenuation.tif
2025-07-13 13:42:17,995 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_Clarity_Turbidityproxy.tif
2025-07-13 13:42:18,717 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Probability.tif
2025-07-13 13:42:19,566 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Risk_Level.tif
2025-07-13 13:42:20,408 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_High_Biomass_Alert.tif
2025-07-13 13:42:21,269 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Extreme_Biomass_Alert.tif
2025-07-13 13:42:22,149 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Ndci_Bloom.tif
2025-07-13 13:42:22,992 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Flh_Bloom.tif
2025-07-13 13:42:23,837 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Mci_Bloom.tif
2025-07-13 13:42:24,681 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Cyanobacteria_Bloom.tif
2025-07-13 13:42:26,277 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Ndci_Values.tif
2025-07-13 13:42:28,005 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Flh_Values.tif
2025-07-13 13:42:29,787 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_HAB_Mci_Values.tif
2025-07-13 13:42:29,974 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_WaterTypes_Legend.txt
2025-07-13 13:42:29,975 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 13:42:29,975 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 13:42:29,976 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 13:42:29,977 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 13:42:29,977 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254
2025-07-13 13:42:30,136 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254 ===
2025-07-13 13:42:30,136 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.0%
2025-07-13 13:42:30,137 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.19 g/m¬≥
2025-07-13 13:42:30,137 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.82 g/m¬≥
2025-07-13 13:42:30,195 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 13:42:30,217 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 7867601 pixels (29.6%)
2025-07-13 13:42:30,240 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 10764908 pixels (40.4%)
2025-07-13 13:42:30,262 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 7989411 pixels (30.0%)
2025-07-13 13:42:30,286 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 13:42:30,356 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 11460 pixels with bloom risk (544 high risk)
2025-07-13 13:42:30,356 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 13:42:30,369 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190224T112111_N0500_R037_T29TNF_20221201T091254_ProductIndex.txt
2025-07-13 13:42:30,373 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 13:42:30,373 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 13:42:30,373 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 13:42:30,374 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 13:42:30,455 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 13:42:30,455 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 34.8MB, status=completed
2025-07-13 13:42:30,457 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.0% coverage, mean=3.68
2025-07-13 13:42:30,457 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.0% coverage, mean=1.71
2025-07-13 13:42:30,458 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.0% coverage, mean=1.04
2025-07-13 13:42:30,458 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.0% coverage, mean=0.01
2025-07-13 13:42:30,458 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.0% coverage, mean=656.48
2025-07-13 13:42:30,459 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.0% coverage, mean=1.82
2025-07-13 13:42:30,460 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.62
2025-07-13 13:42:30,460 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.81
2025-07-13 13:42:30,461 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.0% coverage, mean=7.60
2025-07-13 13:42:30,461 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.0% coverage, mean=0.62
2025-07-13 13:42:30,462 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.0% coverage, mean=20.60
2025-07-13 13:42:30,462 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.0% coverage, mean=1.06
2025-07-13 13:42:30,463 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.0% coverage, mean=1.05
2025-07-13 13:42:30,463 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.0% coverage, mean=14.55
2025-07-13 13:42:30,464 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,464 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,465 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,466 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,466 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,467 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,467 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,468 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,469 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.0% coverage, mean=-0.22
2025-07-13 13:42:30,469 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,470 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 13:42:30,576 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 7/63 (11.1%), ETA: 803.1 minutes
2025-07-13 13:42:30,578 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 13:42:30,579 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 8/63: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009
2025-07-13 13:42:30,579 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 13:42:30,580 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 13:42:30,581 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009.zip
2025-07-13 13:42:30,581 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 13:42:30,582 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 13:42:30,582 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 13:42:30,585 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 13:47:46,692 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:47:46,693 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:47:46,693 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:47:46,694 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190309T113311_T29TNF_Subset_C2RCC.dim (24.0 MB)
2025-07-13 13:47:46,694 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190309T113311_T29TNF_Subset_C2RCC.data
2025-07-13 13:47:46,695 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:47:46,696 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 13:47:46,696 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 13:47:46,697 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 13:47:46,697 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 13:47:46,698 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:47:46,698 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:47:46,699 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:47:46,700 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:47:46,700 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:47:46,700 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:47:46,701 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:47:46,701 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:47:46,702 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:47:46,702 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:47:46,703 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 13:47:46,703 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:47:46,703 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009.zip
2025-07-13 13:47:46,704 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190309T113311_T29TNF_Subset_C2RCC.dim (24.0MB)
2025-07-13 13:47:46,704 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 13:47:46,705 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 13:47:46,705 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 13:47:46,706 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 13:47:46,707 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 13:47:46,708 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 13:47:46,899 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1644
2025-07-13 13:47:47,092 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.3604
2025-07-13 13:47:47,292 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.4030
2025-07-13 13:47:47,293 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 13:47:47,747 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26952666 valid pixels out of 26952666 processed
2025-07-13 13:47:49,239 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 13:47:49,425 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.0% coverage, mean=3.999 mg/m¬≥
2025-07-13 13:47:49,426 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 13:47:49,903 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26952666 valid pixels out of 26952666 processed
2025-07-13 13:47:51,292 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 13:47:51,456 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.0% coverage, mean=2.129 g/m¬≥
2025-07-13 13:47:51,485 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 13:47:51,486 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 13:47:51,492 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 13:47:51,492 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 13:47:51,493 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 13:47:51,493 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190309T113311_T29TNF_Subset_C2RCC.dim (24.0 MB)
2025-07-13 13:47:51,494 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190309T113311_T29TNF_Subset_C2RCC.data
2025-07-13 13:47:51,494 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 13:47:51,495 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 13:47:51,495 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 13:47:51,496 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 13:47:51,496 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 13:47:51,497 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 13:47:51,498 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 13:47:51,498 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 13:47:51,499 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 13:47:51,499 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 13:47:51,500 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 13:47:51,500 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 13:47:51,501 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 13:47:51,502 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 13:47:51,502 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 13:47:51,502 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 13:47:51,503 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 13:47:51,504 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 13:47:51,504 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 13:47:51,505 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 13:47:51,505 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 13:47:51,506 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 13:47:51,506 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009.zip
2025-07-13 13:47:51,507 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 13:47:51,507 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 13:47:51,508 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 13:47:51,508 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 13:47:51,509 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 13:47:51,509 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 13:47:51,510 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 13:47:51,510 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 13:47:51,511 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009.zip
2025-07-13 13:47:51,513 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 13:47:52,280 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 13:47:52,814 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26952666 valid pixels with corrected Jiang algorithm
2025-07-13 13:56:03,351 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 13:56:03,352 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26952666/32874120 (82.0%)
2025-07-13 13:56:03,412 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 13:56:03,436 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 1871904 pixels (6.9%)
2025-07-13 13:56:03,461 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 22744709 pixels (84.4%)
2025-07-13 13:56:03,486 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 2336014 pixels (8.7%)
2025-07-13 13:56:03,513 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 39 pixels (0.0%)
2025-07-13 13:56:03,548 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 13:56:03,549 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 13:56:03,550 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 13:56:03,550 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 13:56:03,886 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26952666 pixels
2025-07-13 13:56:04,002 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 4.11 m
2025-07-13 13:56:04,120 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.643
2025-07-13 13:56:04,121 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 13:56:04,122 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:56:04,256 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 13:56:04,299 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 13:56:04,632 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26952666 pixels
2025-07-13 13:56:04,633 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 13:56:04,910 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 13:56:04,911 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 13:56:05,274 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 13:56:05,603 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 13:56:05,604 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 13:56:05,604 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 622 pixels (0.0%)
2025-07-13 13:56:05,605 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 29717 pixels (0.1%)
2025-07-13 13:56:05,606 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 6406 pixels (0.0%)
2025-07-13 13:56:05,612 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 13:56:05,613 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 13:56:05,636 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 13:56:05,638 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 13:56:05,639 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 13:56:05,639 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 13:56:07,095 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_Absorption.tif
2025-07-13 13:56:08,692 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_Backscattering.tif
2025-07-13 13:56:09,564 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_ReferenceBand.tif
2025-07-13 13:56:11,119 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_TSS.tif
2025-07-13 13:56:12,019 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_WaterTypes.tif
2025-07-13 13:56:12,877 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Jiang_ValidMask.tif
2025-07-13 13:56:14,611 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Secchidepth.tif
2025-07-13 13:56:16,338 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Clarityindex.tif
2025-07-13 13:56:18,065 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Euphoticdepth.tif
2025-07-13 13:56:19,821 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Diffuseattenuation.tif
2025-07-13 13:56:21,586 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Beamattenuation.tif
2025-07-13 13:56:23,150 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_Clarity_Turbidityproxy.tif
2025-07-13 13:56:23,871 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Probability.tif
2025-07-13 13:56:24,720 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Risk_Level.tif
2025-07-13 13:56:25,560 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_High_Biomass_Alert.tif
2025-07-13 13:56:26,404 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Extreme_Biomass_Alert.tif
2025-07-13 13:56:27,254 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Ndci_Bloom.tif
2025-07-13 13:56:28,104 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Flh_Bloom.tif
2025-07-13 13:56:28,956 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Mci_Bloom.tif
2025-07-13 13:56:29,807 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Cyanobacteria_Bloom.tif
2025-07-13 13:56:31,420 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Ndci_Values.tif
2025-07-13 13:56:33,079 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Flh_Values.tif
2025-07-13 13:56:34,849 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_HAB_Mci_Values.tif
2025-07-13 13:56:35,038 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_WaterTypes_Legend.txt
2025-07-13 13:56:35,039 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 13:56:35,039 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 13:56:35,040 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 13:56:35,040 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 13:56:35,041 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009
2025-07-13 13:56:35,205 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009 ===
2025-07-13 13:56:35,206 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.0%
2025-07-13 13:56:35,207 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 86.57 g/m¬≥
2025-07-13 13:56:35,208 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.09 g/m¬≥
2025-07-13 13:56:35,268 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 13:56:35,292 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 1871904 pixels (6.9%)
2025-07-13 13:56:35,316 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 22744709 pixels (84.4%)
2025-07-13 13:56:35,339 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 2336014 pixels (8.7%)
2025-07-13 13:56:35,363 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 39 pixels (0.0%)
2025-07-13 13:56:35,434 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 36745 pixels with bloom risk (622 high risk)
2025-07-13 13:56:35,434 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 13:56:35,439 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190309T113311_N0500_R080_T29TNF_20221120T052009_ProductIndex.txt
2025-07-13 13:56:35,442 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 13:56:35,443 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 13:56:35,443 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 13:56:35,444 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 13:56:35,554 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 13:56:35,555 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 24.0MB, status=completed
2025-07-13 13:56:35,556 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.0% coverage, mean=4.00
2025-07-13 13:56:35,556 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.0% coverage, mean=2.13
2025-07-13 13:56:35,557 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.0% coverage, mean=0.66
2025-07-13 13:56:35,558 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.0% coverage, mean=0.02
2025-07-13 13:56:35,559 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.0% coverage, mean=664.21
2025-07-13 13:56:35,559 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.0% coverage, mean=2.09
2025-07-13 13:56:35,560 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.65
2025-07-13 13:56:35,561 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 13:56:35,561 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.0% coverage, mean=4.11
2025-07-13 13:56:35,562 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.0% coverage, mean=0.64
2025-07-13 13:56:35,563 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.0% coverage, mean=11.12
2025-07-13 13:56:35,563 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.0% coverage, mean=0.68
2025-07-13 13:56:35,564 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.0% coverage, mean=0.67
2025-07-13 13:56:35,565 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.0% coverage, mean=17.46
2025-07-13 13:56:35,565 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,566 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,566 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,567 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,568 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,568 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,569 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,569 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,570 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.0% coverage, mean=-0.22
2025-07-13 13:56:35,570 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,571 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 13:56:35,707 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 8/63 (12.7%), ETA: 787.0 minutes
2025-07-13 13:56:35,708 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 13:56:35,709 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 9/63: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716
2025-07-13 13:56:35,709 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 13:56:35,710 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 13:56:35,711 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716.zip
2025-07-13 13:56:35,711 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 13:56:35,712 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 13:56:35,713 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 13:56:35,714 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 14:01:47,473 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:01:47,474 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:01:47,475 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:01:47,476 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190316T112111_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 14:01:47,476 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190316T112111_T29TNF_Subset_C2RCC.data
2025-07-13 14:01:47,477 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:01:47,478 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 14:01:47,478 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 14:01:47,478 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 14:01:47,479 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 14:01:47,480 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:01:47,481 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:01:47,481 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:01:47,482 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:01:47,483 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:01:47,483 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:01:47,484 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:01:47,485 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:01:47,485 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:01:47,486 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:01:47,486 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 14:01:47,487 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:01:47,487 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716.zip
2025-07-13 14:01:47,488 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190316T112111_T29TNF_Subset_C2RCC.dim (43.2MB)
2025-07-13 14:01:47,488 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 14:01:47,489 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 14:01:47,490 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 14:01:47,490 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 14:01:47,491 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 14:01:47,491 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 14:01:47,691 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0373
2025-07-13 14:01:47,879 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8169
2025-07-13 14:01:48,069 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.2699
2025-07-13 14:01:48,070 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 14:01:48,477 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 24491725 valid pixels out of 24491725 processed
2025-07-13 14:01:49,847 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 14:01:50,016 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 74.5% coverage, mean=0.987 mg/m¬≥
2025-07-13 14:01:50,017 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 14:01:50,445 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 24491725 valid pixels out of 24491725 processed
2025-07-13 14:01:51,798 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 14:01:51,956 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 74.5% coverage, mean=1.467 g/m¬≥
2025-07-13 14:01:51,986 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 14:01:51,986 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 14:01:51,992 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:01:51,993 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:01:51,993 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:01:51,994 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190316T112111_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 14:01:51,994 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190316T112111_T29TNF_Subset_C2RCC.data
2025-07-13 14:01:51,995 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:01:51,996 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 14:01:51,996 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 14:01:51,997 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 14:01:51,998 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 14:01:51,998 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:01:51,999 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:01:51,999 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:01:52,000 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:01:52,001 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:01:52,001 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:01:52,002 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:01:52,002 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:01:52,003 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:01:52,003 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:01:52,004 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 14:01:52,005 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 14:01:52,005 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 14:01:52,006 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 14:01:52,006 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:01:52,007 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 14:01:52,008 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 14:01:52,008 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716.zip
2025-07-13 14:01:52,009 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 14:01:52,010 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 14:01:52,010 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 14:01:52,011 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 14:01:52,011 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 14:01:52,012 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 14:01:52,012 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 14:01:52,013 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 14:01:52,014 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716.zip
2025-07-13 14:01:52,016 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 14:01:52,791 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 14:01:53,297 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 24491725 valid pixels with corrected Jiang algorithm
2025-07-13 14:09:41,076 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 14:09:41,077 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 24491725/32874120 (74.5%)
2025-07-13 14:09:41,133 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 14:09:41,155 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 19431248 pixels (79.3%)
2025-07-13 14:09:41,178 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 4007492 pixels (16.4%)
2025-07-13 14:09:41,200 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1052978 pixels (4.3%)
2025-07-13 14:09:41,223 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 14:09:41,255 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 14:09:41,256 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 14:09:41,256 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 14:09:41,257 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 14:09:41,590 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 24491725 pixels
2025-07-13 14:09:41,707 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 16.09 m
2025-07-13 14:09:41,826 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.847
2025-07-13 14:09:41,826 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 14:09:41,827 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:09:41,966 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:09:42,016 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 14:09:42,324 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 24491725 pixels
2025-07-13 14:09:42,325 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 14:09:42,601 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 14:09:42,602 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 14:09:42,947 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 14:09:43,287 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 14:09:43,288 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 14:09:43,288 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 127 pixels (0.0%)
2025-07-13 14:09:43,289 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 3350 pixels (0.0%)
2025-07-13 14:09:43,290 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1339 pixels (0.0%)
2025-07-13 14:09:43,297 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 14:09:43,297 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 14:09:43,320 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 14:09:43,328 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 14:09:43,329 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 14:09:43,330 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 14:09:44,718 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_Absorption.tif
2025-07-13 14:09:46,216 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_Backscattering.tif
2025-07-13 14:09:47,074 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_ReferenceBand.tif
2025-07-13 14:09:48,551 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_TSS.tif
2025-07-13 14:09:49,410 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_WaterTypes.tif
2025-07-13 14:09:50,273 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Jiang_ValidMask.tif
2025-07-13 14:09:51,903 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Secchidepth.tif
2025-07-13 14:09:53,545 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Clarityindex.tif
2025-07-13 14:09:55,185 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Euphoticdepth.tif
2025-07-13 14:09:56,813 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Diffuseattenuation.tif
2025-07-13 14:09:58,437 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Beamattenuation.tif
2025-07-13 14:09:59,935 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_Clarity_Turbidityproxy.tif
2025-07-13 14:10:00,683 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Probability.tif
2025-07-13 14:10:01,542 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Risk_Level.tif
2025-07-13 14:10:02,421 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_High_Biomass_Alert.tif
2025-07-13 14:10:03,282 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Extreme_Biomass_Alert.tif
2025-07-13 14:10:04,124 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Ndci_Bloom.tif
2025-07-13 14:10:04,979 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Flh_Bloom.tif
2025-07-13 14:10:05,826 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Mci_Bloom.tif
2025-07-13 14:10:06,691 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Cyanobacteria_Bloom.tif
2025-07-13 14:10:08,274 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Ndci_Values.tif
2025-07-13 14:10:09,881 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Flh_Values.tif
2025-07-13 14:10:11,554 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_HAB_Mci_Values.tif
2025-07-13 14:10:11,739 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_WaterTypes_Legend.txt
2025-07-13 14:10:11,740 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 14:10:11,740 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 14:10:11,741 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 14:10:11,742 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 14:10:11,743 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716
2025-07-13 14:10:11,894 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716 ===
2025-07-13 14:10:11,894 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 74.5%
2025-07-13 14:10:11,895 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.48 g/m¬≥
2025-07-13 14:10:11,896 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.41 g/m¬≥
2025-07-13 14:10:11,954 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 14:10:11,976 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 19431248 pixels (79.3%)
2025-07-13 14:10:12,000 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 4007492 pixels (16.4%)
2025-07-13 14:10:12,023 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1052978 pixels (4.3%)
2025-07-13 14:10:12,047 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 14:10:12,120 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 4816 pixels with bloom risk (127 high risk)
2025-07-13 14:10:12,121 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 14:10:12,125 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190316T112111_N0500_R037_T29TNF_20221114T081716_ProductIndex.txt
2025-07-13 14:10:12,129 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 14:10:12,129 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 14:10:12,130 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 14:10:12,131 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 14:10:12,231 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 14:10:12,232 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 43.2MB, status=completed
2025-07-13 14:10:12,233 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 74.5% coverage, mean=0.99
2025-07-13 14:10:12,233 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 74.5% coverage, mean=1.47
2025-07-13 14:10:12,234 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 74.5% coverage, mean=0.26
2025-07-13 14:10:12,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 74.5% coverage, mean=0.01
2025-07-13 14:10:12,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 74.5% coverage, mean=584.92
2025-07-13 14:10:12,236 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 74.5% coverage, mean=1.41
2025-07-13 14:10:12,237 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.93
2025-07-13 14:10:12,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.75
2025-07-13 14:10:12,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 74.5% coverage, mean=16.09
2025-07-13 14:10:12,239 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 74.5% coverage, mean=0.85
2025-07-13 14:10:12,239 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 74.5% coverage, mean=43.59
2025-07-13 14:10:12,240 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 74.5% coverage, mean=0.28
2025-07-13 14:10:12,241 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 74.5% coverage, mean=0.27
2025-07-13 14:10:12,241 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 74.5% coverage, mean=12.86
2025-07-13 14:10:12,242 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,242 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,243 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,244 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,244 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,245 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,246 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,246 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,247 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 74.5% coverage, mean=-0.24
2025-07-13 14:10:12,247 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 14:10:12,248 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 14:10:12,363 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 9/63 (14.3%), ETA: 768.5 minutes
2025-07-13 14:10:12,365 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 14:10:12,365 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 10/63: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834
2025-07-13 14:10:12,366 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 14:10:12,366 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 14:10:12,367 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834.zip
2025-07-13 14:10:12,368 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 14:10:12,368 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 14:10:12,369 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 14:10:12,371 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 14:15:35,606 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:15:35,606 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:15:35,607 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:15:35,608 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190319T113321_T29TNF_Subset_C2RCC.dim (36.7 MB)
2025-07-13 14:15:35,609 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190319T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:15:35,609 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:15:35,610 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 14:15:35,610 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 14:15:35,611 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 14:15:35,611 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 14:15:35,612 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:15:35,613 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:15:35,613 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:15:35,614 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:15:35,615 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:15:35,615 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:15:35,616 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:15:35,616 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:15:35,617 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:15:35,618 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:15:35,618 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 14:15:35,619 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:15:35,619 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834.zip
2025-07-13 14:15:35,620 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190319T113321_T29TNF_Subset_C2RCC.dim (36.7MB)
2025-07-13 14:15:35,621 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 14:15:35,621 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 14:15:35,622 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 14:15:35,622 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 14:15:35,623 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 14:15:35,624 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 14:15:35,814 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1786
2025-07-13 14:15:35,999 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.2693
2025-07-13 14:15:36,183 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.5342
2025-07-13 14:15:36,184 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 14:15:36,601 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26904906 valid pixels out of 26904906 processed
2025-07-13 14:15:38,039 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 14:15:38,220 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.8% coverage, mean=4.383 mg/m¬≥
2025-07-13 14:15:38,220 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 14:15:38,711 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26904906 valid pixels out of 26904906 processed
2025-07-13 14:15:40,101 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 14:15:40,263 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.8% coverage, mean=2.180 g/m¬≥
2025-07-13 14:15:40,293 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 14:15:40,293 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 14:15:40,299 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:15:40,300 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:15:40,300 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:15:40,301 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190319T113321_T29TNF_Subset_C2RCC.dim (36.7 MB)
2025-07-13 14:15:40,302 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190319T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:15:40,302 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:15:40,303 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 14:15:40,304 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 14:15:40,304 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 14:15:40,305 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 14:15:40,306 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:15:40,306 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:15:40,307 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:15:40,308 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:15:40,308 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:15:40,309 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:15:40,309 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:15:40,310 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:15:40,311 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:15:40,311 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:15:40,312 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 14:15:40,312 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 14:15:40,313 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 14:15:40,314 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 14:15:40,314 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:15:40,315 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 14:15:40,316 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 14:15:40,316 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834.zip
2025-07-13 14:15:40,317 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 14:15:40,317 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 14:15:40,318 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 14:15:40,319 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 14:15:40,319 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 14:15:40,320 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 14:15:40,320 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 14:15:40,321 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 14:15:40,322 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834.zip
2025-07-13 14:15:40,324 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 14:15:41,075 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 14:15:41,589 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26904906 valid pixels with corrected Jiang algorithm
2025-07-13 14:23:52,754 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 14:23:52,754 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26904906/32874120 (81.8%)
2025-07-13 14:23:52,813 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 14:23:52,836 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 3253688 pixels (12.1%)
2025-07-13 14:23:52,864 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 19479651 pixels (72.4%)
2025-07-13 14:23:52,887 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 4171553 pixels (15.5%)
2025-07-13 14:23:52,912 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 14 pixels (0.0%)
2025-07-13 14:23:52,945 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 14:23:52,946 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 14:23:52,946 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 14:23:52,947 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 14:23:53,288 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26904906 pixels
2025-07-13 14:23:53,402 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 4.65 m
2025-07-13 14:23:53,518 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.632
2025-07-13 14:23:53,519 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 14:23:53,520 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:23:53,654 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:23:53,698 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 14:23:54,021 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26904906 pixels
2025-07-13 14:23:54,021 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 14:23:54,297 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 14:23:54,298 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 14:23:54,645 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 14:23:54,981 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 14:23:54,982 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 14:23:54,983 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 300 pixels (0.0%)
2025-07-13 14:23:54,984 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 10027 pixels (0.0%)
2025-07-13 14:23:54,984 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3138 pixels (0.0%)
2025-07-13 14:23:54,991 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 14:23:54,991 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 14:23:55,013 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 14:23:55,016 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 14:23:55,017 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 14:23:55,017 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 14:23:56,454 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_Absorption.tif
2025-07-13 14:23:58,024 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_Backscattering.tif
2025-07-13 14:23:58,885 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_ReferenceBand.tif
2025-07-13 14:24:00,495 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_TSS.tif
2025-07-13 14:24:01,448 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_WaterTypes.tif
2025-07-13 14:24:02,345 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Jiang_ValidMask.tif
2025-07-13 14:24:04,133 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Secchidepth.tif
2025-07-13 14:24:05,862 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Clarityindex.tif
2025-07-13 14:24:07,607 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Euphoticdepth.tif
2025-07-13 14:24:09,340 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Diffuseattenuation.tif
2025-07-13 14:24:11,063 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Beamattenuation.tif
2025-07-13 14:24:12,638 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_Clarity_Turbidityproxy.tif
2025-07-13 14:24:13,354 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Probability.tif
2025-07-13 14:24:14,202 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Risk_Level.tif
2025-07-13 14:24:15,056 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_High_Biomass_Alert.tif
2025-07-13 14:24:15,907 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Extreme_Biomass_Alert.tif
2025-07-13 14:24:16,753 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Ndci_Bloom.tif
2025-07-13 14:24:17,616 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Flh_Bloom.tif
2025-07-13 14:24:18,463 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Mci_Bloom.tif
2025-07-13 14:24:19,323 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Cyanobacteria_Bloom.tif
2025-07-13 14:24:20,955 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Ndci_Values.tif
2025-07-13 14:24:22,646 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Flh_Values.tif
2025-07-13 14:24:24,407 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_HAB_Mci_Values.tif
2025-07-13 14:24:24,595 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_WaterTypes_Legend.txt
2025-07-13 14:24:24,596 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 14:24:24,597 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 14:24:24,597 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 14:24:24,598 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 14:24:24,598 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834
2025-07-13 14:24:24,760 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834 ===
2025-07-13 14:24:24,761 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.8%
2025-07-13 14:24:24,762 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.92 g/m¬≥
2025-07-13 14:24:24,762 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.22 g/m¬≥
2025-07-13 14:24:24,821 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 14:24:24,843 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 3253688 pixels (12.1%)
2025-07-13 14:24:24,866 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 19479651 pixels (72.4%)
2025-07-13 14:24:24,889 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 4171553 pixels (15.5%)
2025-07-13 14:24:24,912 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 14 pixels (0.0%)
2025-07-13 14:24:24,982 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 13465 pixels with bloom risk (300 high risk)
2025-07-13 14:24:24,983 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 14:24:24,987 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190319T113321_N0500_R080_T29TNF_20221116T094834_ProductIndex.txt
2025-07-13 14:24:24,991 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 14:24:24,991 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 14:24:24,992 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 14:24:24,993 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 14:24:25,080 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 14:24:25,081 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 36.7MB, status=completed
2025-07-13 14:24:25,082 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.8% coverage, mean=4.38
2025-07-13 14:24:25,083 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.8% coverage, mean=2.18
2025-07-13 14:24:25,084 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.8% coverage, mean=0.78
2025-07-13 14:24:25,085 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.8% coverage, mean=0.02
2025-07-13 14:24:25,085 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.8% coverage, mean=663.93
2025-07-13 14:24:25,086 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.8% coverage, mean=2.22
2025-07-13 14:24:25,087 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.66
2025-07-13 14:24:25,088 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 14:24:25,088 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.8% coverage, mean=4.65
2025-07-13 14:24:25,089 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.8% coverage, mean=0.63
2025-07-13 14:24:25,089 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.8% coverage, mean=12.61
2025-07-13 14:24:25,090 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.8% coverage, mean=0.81
2025-07-13 14:24:25,091 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.8% coverage, mean=0.80
2025-07-13 14:24:25,091 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.8% coverage, mean=18.30
2025-07-13 14:24:25,092 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,093 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,093 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,094 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,094 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,095 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,096 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,096 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,097 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.8% coverage, mean=-0.22
2025-07-13 14:24:25,098 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,098 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 14:24:25,203 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 10/63 (15.9%), ETA: 754.2 minutes
2025-07-13 14:24:25,205 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 14:24:25,205 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 11/63: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130
2025-07-13 14:24:25,206 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 14:24:25,206 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 14:24:25,208 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130.zip
2025-07-13 14:24:25,208 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 14:24:25,209 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 14:24:25,209 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 14:24:25,211 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 14:29:45,269 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:29:45,270 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:29:45,270 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:29:45,271 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190326T112111_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 14:29:45,272 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190326T112111_T29TNF_Subset_C2RCC.data
2025-07-13 14:29:45,273 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:29:45,273 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 14:29:45,274 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 14:29:45,274 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 14:29:45,275 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 14:29:45,276 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:29:45,277 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:29:45,277 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:29:45,278 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:29:45,278 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:29:45,279 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:29:45,280 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:29:45,280 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:29:45,281 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:29:45,281 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:29:45,282 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 14:29:45,283 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:29:45,283 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130.zip
2025-07-13 14:29:45,284 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190326T112111_T29TNF_Subset_C2RCC.dim (43.2MB)
2025-07-13 14:29:45,285 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 14:29:45,285 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 14:29:45,286 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 14:29:45,286 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 14:29:45,287 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 14:29:45,288 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 14:29:45,483 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0386
2025-07-13 14:29:45,675 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.9472
2025-07-13 14:29:45,868 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.2469
2025-07-13 14:29:45,868 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 14:29:46,302 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26832755 valid pixels out of 26832755 processed
2025-07-13 14:29:47,738 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 14:29:47,923 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.6% coverage, mean=0.924 mg/m¬≥
2025-07-13 14:29:47,924 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 14:29:48,390 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26832755 valid pixels out of 26832755 processed
2025-07-13 14:29:49,806 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 14:29:49,977 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.6% coverage, mean=1.470 g/m¬≥
2025-07-13 14:29:50,010 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 14:29:50,011 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 14:29:50,019 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:29:50,019 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:29:50,020 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:29:50,021 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190326T112111_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 14:29:50,021 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190326T112111_T29TNF_Subset_C2RCC.data
2025-07-13 14:29:50,022 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:29:50,023 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 14:29:50,024 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 14:29:50,024 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 14:29:50,025 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 14:29:50,026 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:29:50,027 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:29:50,027 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:29:50,028 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:29:50,028 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:29:50,029 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:29:50,030 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:29:50,030 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:29:50,031 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:29:50,032 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:29:50,033 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 14:29:50,033 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 14:29:50,034 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 14:29:50,035 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 14:29:50,035 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:29:50,036 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 14:29:50,036 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 14:29:50,037 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130.zip
2025-07-13 14:29:50,038 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 14:29:50,038 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 14:29:50,039 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 14:29:50,039 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 14:29:50,040 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 14:29:50,041 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 14:29:50,042 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 14:29:50,042 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 14:29:50,043 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130.zip
2025-07-13 14:29:50,045 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 14:29:50,854 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 14:29:51,371 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26832755 valid pixels with corrected Jiang algorithm
2025-07-13 14:38:23,539 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 14:38:23,539 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26832755/32874120 (81.6%)
2025-07-13 14:38:23,599 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 14:38:23,623 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 19687494 pixels (73.4%)
2025-07-13 14:38:23,647 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 6098835 pixels (22.7%)
2025-07-13 14:38:23,672 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1046416 pixels (3.9%)
2025-07-13 14:38:23,696 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 10 pixels (0.0%)
2025-07-13 14:38:23,729 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 14:38:23,730 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 14:38:23,731 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 14:38:23,732 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 14:38:24,071 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26832755 pixels
2025-07-13 14:38:24,187 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 14.09 m
2025-07-13 14:38:24,301 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.830
2025-07-13 14:38:24,302 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 14:38:24,303 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:38:24,434 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:38:24,477 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 14:38:24,801 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26832755 pixels
2025-07-13 14:38:24,802 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 14:38:25,085 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 14:38:25,086 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 14:38:25,439 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 14:38:25,788 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 14:38:25,789 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 14:38:25,790 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 282 pixels (0.0%)
2025-07-13 14:38:25,791 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 9175 pixels (0.0%)
2025-07-13 14:38:25,791 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2484 pixels (0.0%)
2025-07-13 14:38:25,799 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 14:38:25,799 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 14:38:25,822 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 14:38:25,830 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 14:38:25,831 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 14:38:25,831 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 14:38:27,316 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_Absorption.tif
2025-07-13 14:38:28,955 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_Backscattering.tif
2025-07-13 14:38:29,848 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_ReferenceBand.tif
2025-07-13 14:38:31,475 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_TSS.tif
2025-07-13 14:38:32,405 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_WaterTypes.tif
2025-07-13 14:38:33,274 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Jiang_ValidMask.tif
2025-07-13 14:38:34,978 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Secchidepth.tif
2025-07-13 14:38:36,690 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Clarityindex.tif
2025-07-13 14:38:38,386 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Euphoticdepth.tif
2025-07-13 14:38:40,079 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Diffuseattenuation.tif
2025-07-13 14:38:41,759 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Beamattenuation.tif
2025-07-13 14:38:43,316 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_Clarity_Turbidityproxy.tif
2025-07-13 14:38:44,058 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Probability.tif
2025-07-13 14:38:44,908 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Risk_Level.tif
2025-07-13 14:38:45,755 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_High_Biomass_Alert.tif
2025-07-13 14:38:46,601 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Extreme_Biomass_Alert.tif
2025-07-13 14:38:47,457 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Ndci_Bloom.tif
2025-07-13 14:38:48,307 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Flh_Bloom.tif
2025-07-13 14:38:49,160 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Mci_Bloom.tif
2025-07-13 14:38:50,028 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Cyanobacteria_Bloom.tif
2025-07-13 14:38:51,663 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Ndci_Values.tif
2025-07-13 14:38:53,339 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Flh_Values.tif
2025-07-13 14:38:55,053 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_HAB_Mci_Values.tif
2025-07-13 14:38:55,241 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_WaterTypes_Legend.txt
2025-07-13 14:38:55,242 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 14:38:55,242 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 14:38:55,243 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 14:38:55,244 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 14:38:55,245 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130
2025-07-13 14:38:55,405 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130 ===
2025-07-13 14:38:55,405 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.6%
2025-07-13 14:38:55,406 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 88.75 g/m¬≥
2025-07-13 14:38:55,407 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.33 g/m¬≥
2025-07-13 14:38:55,465 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 14:38:55,489 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 19687494 pixels (73.4%)
2025-07-13 14:38:55,512 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 6098835 pixels (22.7%)
2025-07-13 14:38:55,537 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1046416 pixels (3.9%)
2025-07-13 14:38:55,561 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 10 pixels (0.0%)
2025-07-13 14:38:55,631 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 11941 pixels with bloom risk (282 high risk)
2025-07-13 14:38:55,632 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 14:38:55,643 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190326T112111_N0500_R037_T29TNF_20221114T211130_ProductIndex.txt
2025-07-13 14:38:55,647 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 14:38:55,647 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 14:38:55,648 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 14:38:55,649 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 14:38:55,736 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 14:38:55,737 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 43.2MB, status=completed
2025-07-13 14:38:55,738 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.6% coverage, mean=0.92
2025-07-13 14:38:55,739 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.6% coverage, mean=1.47
2025-07-13 14:38:55,739 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.6% coverage, mean=0.28
2025-07-13 14:38:55,740 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.6% coverage, mean=0.01
2025-07-13 14:38:55,740 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.6% coverage, mean=590.89
2025-07-13 14:38:55,741 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.6% coverage, mean=1.33
2025-07-13 14:38:55,742 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.07
2025-07-13 14:38:55,742 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 14:38:55,743 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.6% coverage, mean=14.09
2025-07-13 14:38:55,744 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.6% coverage, mean=0.83
2025-07-13 14:38:55,744 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.6% coverage, mean=38.17
2025-07-13 14:38:55,745 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.6% coverage, mean=0.30
2025-07-13 14:38:55,746 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.6% coverage, mean=0.29
2025-07-13 14:38:55,746 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.6% coverage, mean=11.74
2025-07-13 14:38:55,747 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,748 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,748 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,749 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,749 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,750 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,751 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,751 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,752 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.6% coverage, mean=-0.24
2025-07-13 14:38:55,753 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,753 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 14:38:55,860 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 11/63 (17.5%), ETA: 741.3 minutes
2025-07-13 14:38:55,862 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 14:38:55,862 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 12/63: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702
2025-07-13 14:38:55,863 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 14:38:55,864 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 14:38:55,865 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702.zip
2025-07-13 14:38:55,865 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 14:38:55,866 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 14:38:55,866 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 14:38:55,868 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 14:44:22,726 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:44:22,727 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:44:22,728 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:44:22,729 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190329T113321_T29TNF_Subset_C2RCC.dim (42.7 MB)
2025-07-13 14:44:22,729 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190329T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:44:22,730 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:44:22,731 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 14:44:22,731 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 14:44:22,732 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 14:44:22,733 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 14:44:22,733 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:44:22,734 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:44:22,735 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:44:22,735 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:44:22,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:44:22,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:44:22,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:44:22,738 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:44:22,739 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:44:22,739 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:44:22,740 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 14:44:22,740 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:44:22,741 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702.zip
2025-07-13 14:44:22,742 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190329T113321_T29TNF_Subset_C2RCC.dim (42.7MB)
2025-07-13 14:44:22,742 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 14:44:22,743 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 14:44:22,743 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 14:44:22,744 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 14:44:22,745 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 14:44:22,745 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 14:44:22,931 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1578
2025-07-13 14:44:23,124 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.6254
2025-07-13 14:44:23,323 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.2254
2025-07-13 14:44:23,324 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 14:44:23,761 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26964995 valid pixels out of 26964995 processed
2025-07-13 14:44:25,208 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 14:44:25,386 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.0% coverage, mean=3.853 mg/m¬≥
2025-07-13 14:44:25,387 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 14:44:25,872 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26964995 valid pixels out of 26964995 processed
2025-07-13 14:44:27,279 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 14:44:27,443 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.0% coverage, mean=1.066 g/m¬≥
2025-07-13 14:44:27,470 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 14:44:27,471 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 14:44:27,477 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:44:27,477 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:44:27,478 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:44:27,479 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190329T113321_T29TNF_Subset_C2RCC.dim (42.7 MB)
2025-07-13 14:44:27,480 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190329T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:44:27,480 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:44:27,481 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 14:44:27,482 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 14:44:27,483 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 14:44:27,483 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 14:44:27,484 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:44:27,484 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:44:27,485 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:44:27,486 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:44:27,486 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:44:27,487 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:44:27,488 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:44:27,488 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:44:27,489 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:44:27,490 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:44:27,490 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 14:44:27,491 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 14:44:27,491 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 14:44:27,492 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 14:44:27,493 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:44:27,493 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 14:44:27,494 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 14:44:27,494 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702.zip
2025-07-13 14:44:27,495 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 14:44:27,496 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 14:44:27,496 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 14:44:27,497 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 14:44:27,498 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 14:44:27,498 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 14:44:27,499 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 14:44:27,499 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 14:44:27,501 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702.zip
2025-07-13 14:44:27,502 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 14:44:28,272 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 14:44:28,806 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26964995 valid pixels with corrected Jiang algorithm
2025-07-13 14:52:42,914 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 14:52:42,915 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26964995/32874120 (82.0%)
2025-07-13 14:52:42,973 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 14:52:42,997 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 4155093 pixels (15.4%)
2025-07-13 14:52:43,020 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 18015769 pixels (66.8%)
2025-07-13 14:52:43,043 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 4794106 pixels (17.8%)
2025-07-13 14:52:43,066 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 14:52:43,099 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 14:52:43,099 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 14:52:43,100 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 14:52:43,101 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 14:52:43,448 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26964995 pixels
2025-07-13 14:52:43,563 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 5.16 m
2025-07-13 14:52:43,678 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.636
2025-07-13 14:52:43,679 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 14:52:43,680 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:52:43,815 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 14:52:43,857 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 14:52:44,172 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26964995 pixels
2025-07-13 14:52:44,173 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 14:52:44,452 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 14:52:44,453 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 14:52:44,802 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 14:52:45,124 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 14:52:45,125 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 14:52:45,126 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 55 pixels (0.0%)
2025-07-13 14:52:45,126 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 5213 pixels (0.0%)
2025-07-13 14:52:45,127 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1685 pixels (0.0%)
2025-07-13 14:52:45,136 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 14:52:45,137 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 14:52:45,169 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 14:52:45,171 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 14:52:45,171 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 14:52:45,172 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 14:52:46,647 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_Absorption.tif
2025-07-13 14:52:48,215 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_Backscattering.tif
2025-07-13 14:52:49,085 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_ReferenceBand.tif
2025-07-13 14:52:50,664 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_TSS.tif
2025-07-13 14:52:51,638 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_WaterTypes.tif
2025-07-13 14:52:52,525 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Jiang_ValidMask.tif
2025-07-13 14:52:54,304 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Secchidepth.tif
2025-07-13 14:52:55,993 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Clarityindex.tif
2025-07-13 14:52:57,737 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Euphoticdepth.tif
2025-07-13 14:52:59,512 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Diffuseattenuation.tif
2025-07-13 14:53:01,319 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Beamattenuation.tif
2025-07-13 14:53:02,946 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_Clarity_Turbidityproxy.tif
2025-07-13 14:53:03,665 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Probability.tif
2025-07-13 14:53:04,509 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Risk_Level.tif
2025-07-13 14:53:05,356 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_High_Biomass_Alert.tif
2025-07-13 14:53:06,207 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Extreme_Biomass_Alert.tif
2025-07-13 14:53:07,076 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Ndci_Bloom.tif
2025-07-13 14:53:07,931 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Flh_Bloom.tif
2025-07-13 14:53:08,791 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Mci_Bloom.tif
2025-07-13 14:53:09,655 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Cyanobacteria_Bloom.tif
2025-07-13 14:53:11,251 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Ndci_Values.tif
2025-07-13 14:53:12,941 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Flh_Values.tif
2025-07-13 14:53:14,698 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_HAB_Mci_Values.tif
2025-07-13 14:53:14,891 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_WaterTypes_Legend.txt
2025-07-13 14:53:14,892 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 14:53:14,893 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 14:53:14,894 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 14:53:14,894 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 14:53:14,895 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702
2025-07-13 14:53:15,066 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702 ===
2025-07-13 14:53:15,067 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.0%
2025-07-13 14:53:15,067 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.46 g/m¬≥
2025-07-13 14:53:15,069 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.95 g/m¬≥
2025-07-13 14:53:15,130 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 14:53:15,154 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 4155093 pixels (15.4%)
2025-07-13 14:53:15,177 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 18015769 pixels (66.8%)
2025-07-13 14:53:15,200 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 4794106 pixels (17.8%)
2025-07-13 14:53:15,226 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 14:53:15,296 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 6953 pixels with bloom risk (55 high risk)
2025-07-13 14:53:15,297 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 14:53:15,308 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190329T113321_N0500_R080_T29TNF_20221116T085702_ProductIndex.txt
2025-07-13 14:53:15,312 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 14:53:15,312 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 14:53:15,313 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 14:53:15,314 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 14:53:15,400 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 14:53:15,401 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 42.7MB, status=completed
2025-07-13 14:53:15,402 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.0% coverage, mean=3.85
2025-07-13 14:53:15,402 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.0% coverage, mean=1.07
2025-07-13 14:53:15,404 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.0% coverage, mean=0.82
2025-07-13 14:53:15,404 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.0% coverage, mean=0.01
2025-07-13 14:53:15,405 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.0% coverage, mean=662.15
2025-07-13 14:53:15,406 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.0% coverage, mean=0.95
2025-07-13 14:53:15,406 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.66
2025-07-13 14:53:15,407 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 14:53:15,407 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.0% coverage, mean=5.16
2025-07-13 14:53:15,408 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.0% coverage, mean=0.64
2025-07-13 14:53:15,409 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.0% coverage, mean=13.98
2025-07-13 14:53:15,409 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.0% coverage, mean=0.83
2025-07-13 14:53:15,410 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.0% coverage, mean=0.83
2025-07-13 14:53:15,410 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.0% coverage, mean=7.81
2025-07-13 14:53:15,411 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,412 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,412 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,413 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,413 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,414 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,415 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,415 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,416 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.0% coverage, mean=-0.23
2025-07-13 14:53:15,416 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,417 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 14:53:15,556 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 12/63 (19.0%), ETA: 727.4 minutes
2025-07-13 14:53:15,558 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 14:53:15,559 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 13/63: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950
2025-07-13 14:53:15,559 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 14:53:15,560 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 14:53:15,561 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950.zip
2025-07-13 14:53:15,562 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 14:53:15,562 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 14:53:15,563 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 14:53:15,565 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 14:58:23,739 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:58:23,740 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:58:23,740 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:58:23,741 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190428T113321_T29TNF_Subset_C2RCC.dim (36.1 MB)
2025-07-13 14:58:23,742 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190428T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:58:23,742 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:58:23,743 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 14:58:23,743 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 14:58:23,744 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 14:58:23,744 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 14:58:23,745 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:58:23,746 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:58:23,747 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:58:23,747 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:58:23,748 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:58:23,748 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:58:23,749 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:58:23,749 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:58:23,750 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:58:23,751 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:58:23,752 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 14:58:23,752 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:58:23,752 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950.zip
2025-07-13 14:58:23,753 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190428T113321_T29TNF_Subset_C2RCC.dim (36.1MB)
2025-07-13 14:58:23,754 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.1 minutes
2025-07-13 14:58:23,754 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 14:58:23,755 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 14:58:23,755 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 14:58:23,756 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 14:58:23,756 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 14:58:23,949 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.2765
2025-07-13 14:58:24,143 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8848
2025-07-13 14:58:24,335 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.6109
2025-07-13 14:58:24,335 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 14:58:24,764 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25571258 valid pixels out of 25571258 processed
2025-07-13 14:58:26,240 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 14:58:26,403 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 77.8% coverage, mean=7.273 mg/m¬≥
2025-07-13 14:58:26,404 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 14:58:26,864 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25571258 valid pixels out of 25571258 processed
2025-07-13 14:58:28,348 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 14:58:28,510 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 77.8% coverage, mean=3.105 g/m¬≥
2025-07-13 14:58:28,541 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 14:58:28,542 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 14:58:28,548 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 14:58:28,549 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 14:58:28,549 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 14:58:28,550 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190428T113321_T29TNF_Subset_C2RCC.dim (36.1 MB)
2025-07-13 14:58:28,551 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190428T113321_T29TNF_Subset_C2RCC.data
2025-07-13 14:58:28,552 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 14:58:28,552 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 14:58:28,553 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 14:58:28,553 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 14:58:28,554 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 14:58:28,555 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 14:58:28,555 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 14:58:28,556 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 14:58:28,556 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 14:58:28,557 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 14:58:28,557 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 14:58:28,558 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 14:58:28,559 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 14:58:28,559 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 14:58:28,560 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 14:58:28,560 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 14:58:28,561 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 14:58:28,562 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 14:58:28,563 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 14:58:28,563 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 14:58:28,564 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 14:58:28,564 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 14:58:28,565 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950.zip
2025-07-13 14:58:28,566 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 14:58:28,567 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 14:58:28,567 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 14:58:28,568 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 14:58:28,568 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 14:58:28,569 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 14:58:28,569 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 14:58:28,570 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 14:58:28,571 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950.zip
2025-07-13 14:58:28,573 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 14:58:29,373 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 14:58:29,883 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25571258 valid pixels with corrected Jiang algorithm
2025-07-13 15:06:14,073 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 15:06:14,074 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25571258/32874120 (77.8%)
2025-07-13 15:06:14,131 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 15:06:14,154 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 1718088 pixels (6.7%)
2025-07-13 15:06:14,175 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 8550977 pixels (33.4%)
2025-07-13 15:06:14,197 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 15302151 pixels (59.8%)
2025-07-13 15:06:14,219 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 42 pixels (0.0%)
2025-07-13 15:06:14,246 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 15:06:14,247 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 15:06:14,247 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 15:06:14,248 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 15:06:14,582 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25571258 pixels
2025-07-13 15:06:14,704 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 2.78 m
2025-07-13 15:06:14,822 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.440
2025-07-13 15:06:14,822 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 15:06:14,823 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:06:14,980 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:06:15,023 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 15:06:15,330 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25571258 pixels
2025-07-13 15:06:15,331 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 15:06:15,604 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 15:06:15,605 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 15:06:15,973 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 15:06:16,297 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 15:06:16,298 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 15:06:16,298 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 979 pixels (0.0%)
2025-07-13 15:06:16,300 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 16888 pixels (0.1%)
2025-07-13 15:06:16,300 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2857 pixels (0.0%)
2025-07-13 15:06:16,307 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 15:06:16,308 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 15:06:16,330 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 15:06:16,332 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 15:06:16,333 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 15:06:16,333 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 15:06:17,471 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_Absorption.tif
2025-07-13 15:06:19,095 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_Backscattering.tif
2025-07-13 15:06:19,980 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_ReferenceBand.tif
2025-07-13 15:06:21,610 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_TSS.tif
2025-07-13 15:06:22,611 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_WaterTypes.tif
2025-07-13 15:06:23,495 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Jiang_ValidMask.tif
2025-07-13 15:06:25,289 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Secchidepth.tif
2025-07-13 15:06:26,989 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Clarityindex.tif
2025-07-13 15:06:28,752 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Euphoticdepth.tif
2025-07-13 15:06:30,522 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Diffuseattenuation.tif
2025-07-13 15:06:32,279 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Beamattenuation.tif
2025-07-13 15:06:33,911 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_Clarity_Turbidityproxy.tif
2025-07-13 15:06:34,648 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Probability.tif
2025-07-13 15:06:35,513 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Risk_Level.tif
2025-07-13 15:06:36,383 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_High_Biomass_Alert.tif
2025-07-13 15:06:37,248 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Extreme_Biomass_Alert.tif
2025-07-13 15:06:38,113 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Ndci_Bloom.tif
2025-07-13 15:06:38,997 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Flh_Bloom.tif
2025-07-13 15:06:39,866 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Mci_Bloom.tif
2025-07-13 15:06:40,749 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Cyanobacteria_Bloom.tif
2025-07-13 15:06:42,391 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Ndci_Values.tif
2025-07-13 15:06:44,147 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Flh_Values.tif
2025-07-13 15:06:45,951 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_HAB_Mci_Values.tif
2025-07-13 15:06:46,139 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_WaterTypes_Legend.txt
2025-07-13 15:06:46,140 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 15:06:46,140 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 15:06:46,141 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 15:06:46,142 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 15:06:46,142 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950
2025-07-13 15:06:46,299 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950 ===
2025-07-13 15:06:46,299 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 77.8%
2025-07-13 15:06:46,300 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.14 g/m¬≥
2025-07-13 15:06:46,301 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 3.49 g/m¬≥
2025-07-13 15:06:46,358 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 15:06:46,382 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 1718088 pixels (6.7%)
2025-07-13 15:06:46,405 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 8550977 pixels (33.4%)
2025-07-13 15:06:46,429 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 15302151 pixels (59.8%)
2025-07-13 15:06:46,452 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 42 pixels (0.0%)
2025-07-13 15:06:46,526 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 20724 pixels with bloom risk (979 high risk)
2025-07-13 15:06:46,527 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 15:06:46,532 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190428T113321_N0500_R080_T29TNF_20221026T054950_ProductIndex.txt
2025-07-13 15:06:46,535 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 15:06:46,536 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 15:06:46,536 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 15:06:46,537 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 15:06:46,624 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 15:06:46,625 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 36.1MB, status=completed
2025-07-13 15:06:46,625 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 77.8% coverage, mean=7.27
2025-07-13 15:06:46,626 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 77.8% coverage, mean=3.10
2025-07-13 15:06:46,626 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 77.8% coverage, mean=1.80
2025-07-13 15:06:46,627 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 77.8% coverage, mean=0.03
2025-07-13 15:06:46,628 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 77.8% coverage, mean=702.83
2025-07-13 15:06:46,628 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 77.8% coverage, mean=3.49
2025-07-13 15:06:46,629 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.97
2025-07-13 15:06:46,629 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.78
2025-07-13 15:06:46,630 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 77.8% coverage, mean=2.78
2025-07-13 15:06:46,630 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 77.8% coverage, mean=0.44
2025-07-13 15:06:46,631 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 77.8% coverage, mean=7.53
2025-07-13 15:06:46,631 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 77.8% coverage, mean=1.84
2025-07-13 15:06:46,632 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 77.8% coverage, mean=1.82
2025-07-13 15:06:46,633 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 77.8% coverage, mean=26.67
2025-07-13 15:06:46,633 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,633 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,634 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,635 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,635 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,636 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,637 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,637 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,638 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 77.8% coverage, mean=-0.15
2025-07-13 15:06:46,638 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,639 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 15:06:46,789 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 13/63 (20.6%), ETA: 710.2 minutes
2025-07-13 15:06:46,791 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 15:06:46,791 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 14/63: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712
2025-07-13 15:06:46,792 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 15:06:46,792 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 15:06:46,793 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712.zip
2025-07-13 15:06:46,794 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 15:06:46,794 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 15:06:46,795 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 15:06:46,797 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 15:12:00,035 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:12:00,036 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:12:00,036 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:12:00,037 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190505T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 15:12:00,038 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190505T112121_T29TNF_Subset_C2RCC.data
2025-07-13 15:12:00,038 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:12:00,039 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 15:12:00,040 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 15:12:00,040 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 15:12:00,041 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 15:12:00,041 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:12:00,042 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:12:00,042 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:12:00,043 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:12:00,043 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:12:00,044 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:12:00,045 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:12:00,045 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:12:00,045 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:12:00,046 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:12:00,046 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 15:12:00,047 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:12:00,048 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712.zip
2025-07-13 15:12:00,049 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190505T112121_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 15:12:00,049 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 15:12:00,050 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 15:12:00,050 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 15:12:00,051 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 15:12:00,052 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 15:12:00,052 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 15:12:00,249 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0454
2025-07-13 15:12:00,450 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.5975
2025-07-13 15:12:00,644 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1052
2025-07-13 15:12:00,645 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 15:12:01,036 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 21438436 valid pixels out of 21438436 processed
2025-07-13 15:12:02,379 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 15:12:02,533 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 65.2% coverage, mean=1.348 mg/m¬≥
2025-07-13 15:12:02,534 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 15:12:02,951 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 21438436 valid pixels out of 21438436 processed
2025-07-13 15:12:04,275 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 15:12:04,416 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 65.2% coverage, mean=1.104 g/m¬≥
2025-07-13 15:12:04,446 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 15:12:04,447 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 15:12:04,453 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:12:04,453 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:12:04,454 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:12:04,455 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190505T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 15:12:04,455 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190505T112121_T29TNF_Subset_C2RCC.data
2025-07-13 15:12:04,456 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:12:04,457 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 15:12:04,457 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 15:12:04,458 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 15:12:04,458 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 15:12:04,459 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:12:04,460 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:12:04,460 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:12:04,461 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:12:04,462 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:12:04,462 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:12:04,463 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:12:04,463 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:12:04,464 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:12:04,464 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:12:04,466 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 15:12:04,466 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 15:12:04,467 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 15:12:04,467 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 15:12:04,468 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:12:04,469 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 15:12:04,469 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 15:12:04,470 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712.zip
2025-07-13 15:12:04,471 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 15:12:04,471 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 15:12:04,472 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 15:12:04,472 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 15:12:04,473 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 15:12:04,473 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 15:12:04,474 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 15:12:04,475 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 15:12:04,476 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712.zip
2025-07-13 15:12:04,477 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 15:12:05,287 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 15:12:05,789 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 21438436 valid pixels with corrected Jiang algorithm
2025-07-13 15:18:48,063 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 15:18:48,064 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 21438436/32874120 (65.2%)
2025-07-13 15:18:48,111 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 15:18:48,131 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 10731569 pixels (50.1%)
2025-07-13 15:18:48,150 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 9278594 pixels (43.3%)
2025-07-13 15:18:48,169 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1428267 pixels (6.7%)
2025-07-13 15:18:48,188 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 6 pixels (0.0%)
2025-07-13 15:18:48,218 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 15:18:48,219 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 15:18:48,220 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 15:18:48,220 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 15:18:48,568 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 21438436 pixels
2025-07-13 15:18:48,685 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 10.93 m
2025-07-13 15:18:48,805 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.765
2025-07-13 15:18:48,806 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 15:18:48,806 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:18:48,939 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:18:48,982 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 15:18:49,269 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 21438436 pixels
2025-07-13 15:18:49,270 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 15:18:49,564 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 15:18:49,565 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 15:18:49,912 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 15:18:50,232 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 15:18:50,233 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 15:18:50,233 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 41 pixels (0.0%)
2025-07-13 15:18:50,234 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4244 pixels (0.0%)
2025-07-13 15:18:50,235 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1193 pixels (0.0%)
2025-07-13 15:18:50,241 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 15:18:50,242 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 15:18:50,279 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 15:18:50,282 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 15:18:50,282 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 15:18:50,283 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 15:18:51,605 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_Absorption.tif
2025-07-13 15:18:53,011 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_Backscattering.tif
2025-07-13 15:18:53,870 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_ReferenceBand.tif
2025-07-13 15:18:55,265 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_TSS.tif
2025-07-13 15:18:56,192 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_WaterTypes.tif
2025-07-13 15:18:57,075 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Jiang_ValidMask.tif
2025-07-13 15:18:58,643 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Secchidepth.tif
2025-07-13 15:19:00,187 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Clarityindex.tif
2025-07-13 15:19:01,760 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Euphoticdepth.tif
2025-07-13 15:19:03,326 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Diffuseattenuation.tif
2025-07-13 15:19:04,817 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Beamattenuation.tif
2025-07-13 15:19:06,198 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_Clarity_Turbidityproxy.tif
2025-07-13 15:19:06,891 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Probability.tif
2025-07-13 15:19:07,749 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Risk_Level.tif
2025-07-13 15:19:08,595 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_High_Biomass_Alert.tif
2025-07-13 15:19:09,445 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Extreme_Biomass_Alert.tif
2025-07-13 15:19:10,296 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Ndci_Bloom.tif
2025-07-13 15:19:11,154 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Flh_Bloom.tif
2025-07-13 15:19:12,008 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Mci_Bloom.tif
2025-07-13 15:19:12,862 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Cyanobacteria_Bloom.tif
2025-07-13 15:19:14,352 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Ndci_Values.tif
2025-07-13 15:19:15,844 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Flh_Values.tif
2025-07-13 15:19:17,409 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_HAB_Mci_Values.tif
2025-07-13 15:19:17,594 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_WaterTypes_Legend.txt
2025-07-13 15:19:17,595 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 15:19:17,595 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 15:19:17,596 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 15:19:17,597 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 15:19:17,598 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712
2025-07-13 15:19:17,731 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712 ===
2025-07-13 15:19:17,731 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 65.2%
2025-07-13 15:19:17,732 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 84.00 g/m¬≥
2025-07-13 15:19:17,733 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.87 g/m¬≥
2025-07-13 15:19:17,780 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 15:19:17,799 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 10731569 pixels (50.1%)
2025-07-13 15:19:17,818 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 9278594 pixels (43.3%)
2025-07-13 15:19:17,836 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1428267 pixels (6.7%)
2025-07-13 15:19:17,855 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 6 pixels (0.0%)
2025-07-13 15:19:17,925 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 5478 pixels with bloom risk (41 high risk)
2025-07-13 15:19:17,926 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 15:19:17,930 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190505T112121_N0500_R037_T29TNF_20221221T233712_ProductIndex.txt
2025-07-13 15:19:17,933 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 15:19:17,934 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 15:19:17,935 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 15:19:17,936 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 15:19:18,023 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 15:19:18,024 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 15:19:18,024 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 65.2% coverage, mean=1.35
2025-07-13 15:19:18,025 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 65.2% coverage, mean=1.10
2025-07-13 15:19:18,025 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 65.2% coverage, mean=0.43
2025-07-13 15:19:18,026 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 65.2% coverage, mean=0.01
2025-07-13 15:19:18,027 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 65.2% coverage, mean=617.44
2025-07-13 15:19:18,028 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 65.2% coverage, mean=0.87
2025-07-13 15:19:18,028 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.02
2025-07-13 15:19:18,029 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.65
2025-07-13 15:19:18,030 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 65.2% coverage, mean=10.93
2025-07-13 15:19:18,030 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 65.2% coverage, mean=0.77
2025-07-13 15:19:18,031 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 65.2% coverage, mean=29.61
2025-07-13 15:19:18,032 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 65.2% coverage, mean=0.45
2025-07-13 15:19:18,032 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 65.2% coverage, mean=0.44
2025-07-13 15:19:18,033 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 65.2% coverage, mean=7.53
2025-07-13 15:19:18,034 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,034 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,035 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,035 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,036 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,036 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,037 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,038 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,038 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 65.2% coverage, mean=-0.24
2025-07-13 15:19:18,039 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,040 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 15:19:18,147 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 14/63 (22.2%), ETA: 690.2 minutes
2025-07-13 15:19:18,149 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 15:19:18,150 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 15/63: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440
2025-07-13 15:19:18,150 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 15:19:18,151 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 15:19:18,152 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440.zip
2025-07-13 15:19:18,153 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 15:19:18,153 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 15:19:18,154 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 15:19:18,156 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 15:24:41,837 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:24:41,837 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:24:41,838 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:24:41,839 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190525T112121_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 15:24:41,839 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190525T112121_T29TNF_Subset_C2RCC.data
2025-07-13 15:24:41,840 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:24:41,840 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 15:24:41,841 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 15:24:41,842 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 15:24:41,843 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 15:24:41,843 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:24:41,844 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:24:41,845 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:24:41,845 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:24:41,846 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:24:41,846 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:24:41,847 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:24:41,848 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:24:41,848 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:24:41,849 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:24:41,849 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 15:24:41,850 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:24:41,851 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440.zip
2025-07-13 15:24:41,851 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190525T112121_T29TNF_Subset_C2RCC.dim (43.2MB)
2025-07-13 15:24:41,852 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 15:24:41,852 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 15:24:41,853 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 15:24:41,854 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 15:24:41,854 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 15:24:41,855 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 15:24:42,039 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0896
2025-07-13 15:24:42,218 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8002
2025-07-13 15:24:42,403 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.3150
2025-07-13 15:24:42,404 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 15:24:42,838 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26795553 valid pixels out of 26795553 processed
2025-07-13 15:24:44,392 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 15:24:44,558 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.5% coverage, mean=2.178 mg/m¬≥
2025-07-13 15:24:44,559 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 15:24:45,031 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26795553 valid pixels out of 26795553 processed
2025-07-13 15:24:46,560 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 15:24:46,726 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.5% coverage, mean=1.366 g/m¬≥
2025-07-13 15:24:46,756 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 15:24:46,756 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 15:24:46,762 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:24:46,763 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:24:46,763 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:24:46,764 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190525T112121_T29TNF_Subset_C2RCC.dim (43.2 MB)
2025-07-13 15:24:46,764 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190525T112121_T29TNF_Subset_C2RCC.data
2025-07-13 15:24:46,765 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:24:46,766 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 15:24:46,767 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 15:24:46,767 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 15:24:46,768 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 15:24:46,768 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:24:46,769 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:24:46,770 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:24:46,770 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:24:46,771 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:24:46,771 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:24:46,772 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:24:46,773 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:24:46,773 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:24:46,774 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:24:46,775 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 15:24:46,775 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 15:24:46,776 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 15:24:46,776 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 15:24:46,777 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:24:46,777 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 15:24:46,778 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 15:24:46,779 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440.zip
2025-07-13 15:24:46,780 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 15:24:46,780 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 15:24:46,781 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 15:24:46,782 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 15:24:46,782 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 15:24:46,783 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 15:24:46,783 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 15:24:46,784 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 15:24:46,785 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440.zip
2025-07-13 15:24:46,786 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 15:24:47,561 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 15:24:48,076 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26795553 valid pixels with corrected Jiang algorithm
2025-07-13 15:33:10,248 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 15:33:10,249 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26795553/32874120 (81.5%)
2025-07-13 15:33:10,308 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 15:33:10,331 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 13667446 pixels (51.0%)
2025-07-13 15:33:10,353 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 6278283 pixels (23.4%)
2025-07-13 15:33:10,376 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 6849823 pixels (25.6%)
2025-07-13 15:33:10,399 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 15:33:10,432 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 15:33:10,432 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 15:33:10,433 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 15:33:10,434 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 15:33:10,769 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26795553 pixels
2025-07-13 15:33:10,887 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 12.05 m
2025-07-13 15:33:11,005 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.695
2025-07-13 15:33:11,006 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 15:33:11,007 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:33:11,141 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:33:11,184 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 15:33:11,494 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26795553 pixels
2025-07-13 15:33:11,494 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 15:33:11,774 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 15:33:11,775 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 15:33:12,134 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 15:33:12,467 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 15:33:12,468 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 15:33:12,469 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 183 pixels (0.0%)
2025-07-13 15:33:12,469 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 9656 pixels (0.0%)
2025-07-13 15:33:12,470 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3350 pixels (0.0%)
2025-07-13 15:33:12,476 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 15:33:12,477 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 15:33:12,498 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 15:33:12,501 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 15:33:12,501 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 15:33:12,502 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 15:33:14,009 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_Absorption.tif
2025-07-13 15:33:15,694 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_Backscattering.tif
2025-07-13 15:33:16,557 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_ReferenceBand.tif
2025-07-13 15:33:18,285 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_TSS.tif
2025-07-13 15:33:19,282 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_WaterTypes.tif
2025-07-13 15:33:20,145 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Jiang_ValidMask.tif
2025-07-13 15:33:21,929 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Secchidepth.tif
2025-07-13 15:33:23,594 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Clarityindex.tif
2025-07-13 15:33:25,412 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Euphoticdepth.tif
2025-07-13 15:33:27,191 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Diffuseattenuation.tif
2025-07-13 15:33:28,997 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Beamattenuation.tif
2025-07-13 15:33:30,681 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_Clarity_Turbidityproxy.tif
2025-07-13 15:33:31,403 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Probability.tif
2025-07-13 15:33:32,252 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Risk_Level.tif
2025-07-13 15:33:33,104 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_High_Biomass_Alert.tif
2025-07-13 15:33:33,960 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Extreme_Biomass_Alert.tif
2025-07-13 15:33:34,805 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Ndci_Bloom.tif
2025-07-13 15:33:35,656 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Flh_Bloom.tif
2025-07-13 15:33:36,505 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Mci_Bloom.tif
2025-07-13 15:33:37,358 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Cyanobacteria_Bloom.tif
2025-07-13 15:33:39,003 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Ndci_Values.tif
2025-07-13 15:33:40,789 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Flh_Values.tif
2025-07-13 15:33:42,558 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_HAB_Mci_Values.tif
2025-07-13 15:33:42,743 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_WaterTypes_Legend.txt
2025-07-13 15:33:42,744 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 15:33:42,745 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 15:33:42,745 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 15:33:42,746 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 15:33:42,746 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440
2025-07-13 15:33:42,906 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440 ===
2025-07-13 15:33:42,906 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.5%
2025-07-13 15:33:42,907 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.03 g/m¬≥
2025-07-13 15:33:42,908 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.40 g/m¬≥
2025-07-13 15:33:42,966 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 15:33:42,989 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 13667446 pixels (51.0%)
2025-07-13 15:33:43,013 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 6278283 pixels (23.4%)
2025-07-13 15:33:43,035 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 6849823 pixels (25.6%)
2025-07-13 15:33:43,058 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 15:33:43,128 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 13189 pixels with bloom risk (183 high risk)
2025-07-13 15:33:43,129 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 15:33:43,134 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190525T112121_N0500_R037_T29TNF_20221205T045440_ProductIndex.txt
2025-07-13 15:33:43,137 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 15:33:43,138 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 15:33:43,138 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 15:33:43,139 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 15:33:43,227 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 15:33:43,228 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 43.2MB, status=completed
2025-07-13 15:33:43,229 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.5% coverage, mean=2.18
2025-07-13 15:33:43,229 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.5% coverage, mean=1.37
2025-07-13 15:33:43,230 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.5% coverage, mean=0.85
2025-07-13 15:33:43,231 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.5% coverage, mean=0.01
2025-07-13 15:33:43,231 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.5% coverage, mean=630.62
2025-07-13 15:33:43,232 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.5% coverage, mean=1.40
2025-07-13 15:33:43,233 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.42
2025-07-13 15:33:43,234 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 15:33:43,234 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.5% coverage, mean=12.05
2025-07-13 15:33:43,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.5% coverage, mean=0.69
2025-07-13 15:33:43,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.5% coverage, mean=32.64
2025-07-13 15:33:43,236 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.5% coverage, mean=0.87
2025-07-13 15:33:43,236 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.5% coverage, mean=0.86
2025-07-13 15:33:43,237 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.5% coverage, mean=11.26
2025-07-13 15:33:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,239 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,240 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,240 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,241 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,241 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,242 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,243 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.5% coverage, mean=-0.23
2025-07-13 15:33:43,243 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,244 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 15:33:43,349 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 15/63 (23.8%), ETA: 677.1 minutes
2025-07-13 15:33:43,350 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 15:33:43,351 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 16/63: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159
2025-07-13 15:33:43,351 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 15:33:43,352 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 15:33:43,353 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159.zip
2025-07-13 15:33:43,353 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 15:33:43,354 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 15:33:43,355 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 15:33:43,357 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 15:39:10,834 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:39:10,835 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:39:10,836 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:39:10,836 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190528T113321_T29TNF_Subset_C2RCC.dim (24.0 MB)
2025-07-13 15:39:10,837 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190528T113321_T29TNF_Subset_C2RCC.data
2025-07-13 15:39:10,838 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:39:10,838 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 15:39:10,839 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 15:39:10,840 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 15:39:10,840 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 15:39:10,841 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:39:10,841 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:39:10,842 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:39:10,842 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:39:10,843 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:39:10,844 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:39:10,844 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:39:10,845 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:39:10,845 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:39:10,846 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:39:10,847 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 15:39:10,847 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:39:10,848 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159.zip
2025-07-13 15:39:10,848 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190528T113321_T29TNF_Subset_C2RCC.dim (24.0MB)
2025-07-13 15:39:10,849 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.5 minutes
2025-07-13 15:39:10,849 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 15:39:10,850 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 15:39:10,851 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 15:39:10,851 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 15:39:10,852 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 15:39:11,035 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.2640
2025-07-13 15:39:11,215 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.9753
2025-07-13 15:39:11,393 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.8876
2025-07-13 15:39:11,394 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 15:39:11,813 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26626373 valid pixels out of 26626373 processed
2025-07-13 15:39:13,347 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 15:39:13,524 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.0% coverage, mean=6.692 mg/m¬≥
2025-07-13 15:39:13,525 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 15:39:13,988 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26626373 valid pixels out of 26626373 processed
2025-07-13 15:39:15,523 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 15:39:15,689 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.0% coverage, mean=3.366 g/m¬≥
2025-07-13 15:39:15,721 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 15:39:15,722 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 15:39:15,727 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:39:15,728 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:39:15,728 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:39:15,729 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190528T113321_T29TNF_Subset_C2RCC.dim (24.0 MB)
2025-07-13 15:39:15,730 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190528T113321_T29TNF_Subset_C2RCC.data
2025-07-13 15:39:15,731 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:39:15,731 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 15:39:15,732 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 15:39:15,733 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 15:39:15,733 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 15:39:15,734 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:39:15,734 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:39:15,735 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:39:15,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:39:15,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:39:15,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:39:15,738 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:39:15,738 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:39:15,739 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:39:15,739 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:39:15,740 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 15:39:15,740 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 15:39:15,741 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 15:39:15,742 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 15:39:15,742 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:39:15,743 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 15:39:15,744 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 15:39:15,744 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159.zip
2025-07-13 15:39:15,745 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 15:39:15,745 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 15:39:15,746 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 15:39:15,747 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 15:39:15,747 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 15:39:15,748 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 15:39:15,748 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 15:39:15,749 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 15:39:15,750 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159.zip
2025-07-13 15:39:15,752 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 15:39:16,524 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 15:39:17,039 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26626373 valid pixels with corrected Jiang algorithm
2025-07-13 15:47:23,658 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 15:47:23,659 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26626373/32874120 (81.0%)
2025-07-13 15:47:23,718 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 15:47:23,741 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 5149915 pixels (19.3%)
2025-07-13 15:47:23,765 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5409888 pixels (20.3%)
2025-07-13 15:47:23,788 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 16066562 pixels (60.3%)
2025-07-13 15:47:23,811 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 15:47:23,843 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 15:47:23,843 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 15:47:23,844 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 15:47:23,845 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 15:47:24,179 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26626373 pixels
2025-07-13 15:47:24,294 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 5.11 m
2025-07-13 15:47:24,408 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.472
2025-07-13 15:47:24,409 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 15:47:24,410 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:47:24,548 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 15:47:24,599 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 15:47:24,912 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26626373 pixels
2025-07-13 15:47:24,913 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 15:47:25,188 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 15:47:25,189 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 15:47:25,535 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 15:47:25,868 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 15:47:25,868 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 15:47:25,869 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 105 pixels (0.0%)
2025-07-13 15:47:25,870 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 20637 pixels (0.1%)
2025-07-13 15:47:25,871 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 5963 pixels (0.0%)
2025-07-13 15:47:25,877 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 15:47:25,878 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 15:47:25,900 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 15:47:25,903 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 15:47:25,903 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 15:47:25,904 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 15:47:27,145 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_Absorption.tif
2025-07-13 15:47:28,830 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_Backscattering.tif
2025-07-13 15:47:29,688 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_ReferenceBand.tif
2025-07-13 15:47:31,388 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_TSS.tif
2025-07-13 15:47:32,390 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_WaterTypes.tif
2025-07-13 15:47:33,268 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Jiang_ValidMask.tif
2025-07-13 15:47:35,105 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Secchidepth.tif
2025-07-13 15:47:36,771 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Clarityindex.tif
2025-07-13 15:47:38,579 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Euphoticdepth.tif
2025-07-13 15:47:40,373 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Diffuseattenuation.tif
2025-07-13 15:47:42,159 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Beamattenuation.tif
2025-07-13 15:47:43,852 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_Clarity_Turbidityproxy.tif
2025-07-13 15:47:44,571 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Probability.tif
2025-07-13 15:47:45,416 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Risk_Level.tif
2025-07-13 15:47:46,261 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_High_Biomass_Alert.tif
2025-07-13 15:47:47,132 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Extreme_Biomass_Alert.tif
2025-07-13 15:47:47,991 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Ndci_Bloom.tif
2025-07-13 15:47:48,855 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Flh_Bloom.tif
2025-07-13 15:47:49,703 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Mci_Bloom.tif
2025-07-13 15:47:50,562 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Cyanobacteria_Bloom.tif
2025-07-13 15:47:52,210 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Ndci_Values.tif
2025-07-13 15:47:53,962 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Flh_Values.tif
2025-07-13 15:47:55,692 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_HAB_Mci_Values.tif
2025-07-13 15:47:55,885 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_WaterTypes_Legend.txt
2025-07-13 15:47:55,886 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 15:47:55,887 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 15:47:55,888 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 15:47:55,888 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 15:47:55,889 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159
2025-07-13 15:47:56,058 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159 ===
2025-07-13 15:47:56,059 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.0%
2025-07-13 15:47:56,059 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 82.64 g/m¬≥
2025-07-13 15:47:56,060 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 3.88 g/m¬≥
2025-07-13 15:47:56,117 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 15:47:56,141 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 5149915 pixels (19.3%)
2025-07-13 15:47:56,163 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5409888 pixels (20.3%)
2025-07-13 15:47:56,189 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 16066562 pixels (60.3%)
2025-07-13 15:47:56,214 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 15:47:56,285 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 26705 pixels with bloom risk (105 high risk)
2025-07-13 15:47:56,285 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 15:47:56,297 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190528T113321_N0500_R080_T29TNF_20221212T044159_ProductIndex.txt
2025-07-13 15:47:56,301 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 15:47:56,301 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 15:47:56,302 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 15:47:56,303 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 15:47:56,391 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 15:47:56,393 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 24.0MB, status=completed
2025-07-13 15:47:56,393 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.0% coverage, mean=6.69
2025-07-13 15:47:56,394 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.0% coverage, mean=3.37
2025-07-13 15:47:56,395 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.0% coverage, mean=1.75
2025-07-13 15:47:56,395 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.0% coverage, mean=0.03
2025-07-13 15:47:56,396 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.0% coverage, mean=689.95
2025-07-13 15:47:56,397 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.0% coverage, mean=3.88
2025-07-13 15:47:56,397 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.95
2025-07-13 15:47:56,397 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.81
2025-07-13 15:47:56,398 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.0% coverage, mean=5.11
2025-07-13 15:47:56,398 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.0% coverage, mean=0.47
2025-07-13 15:47:56,399 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.0% coverage, mean=13.85
2025-07-13 15:47:56,400 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.0% coverage, mean=1.80
2025-07-13 15:47:56,400 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.0% coverage, mean=1.78
2025-07-13 15:47:56,401 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.0% coverage, mean=29.29
2025-07-13 15:47:56,402 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,402 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,403 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,403 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,404 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,405 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,405 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,406 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,406 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.0% coverage, mean=-0.15
2025-07-13 15:47:56,407 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,408 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 15:47:56,536 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 16/63 (25.4%), ETA: 663.4 minutes
2025-07-13 15:47:56,538 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 15:47:56,538 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 17/63: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057
2025-07-13 15:47:56,539 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 15:47:56,539 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 15:47:56,540 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057.zip
2025-07-13 15:47:56,541 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 15:47:56,541 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 15:47:56,542 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 15:47:56,544 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 15:53:17,758 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:53:17,759 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:53:17,760 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:53:17,760 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190627T113321_T29TNF_Subset_C2RCC.dim (38.3 MB)
2025-07-13 15:53:17,761 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190627T113321_T29TNF_Subset_C2RCC.data
2025-07-13 15:53:17,762 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:53:17,762 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 15:53:17,763 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 15:53:17,764 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 15:53:17,764 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 15:53:17,765 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:53:17,765 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:53:17,766 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:53:17,767 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:53:17,767 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:53:17,768 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:53:17,768 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:53:17,769 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:53:17,770 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:53:17,770 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:53:17,771 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 15:53:17,771 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:53:17,772 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057.zip
2025-07-13 15:53:17,773 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190627T113321_T29TNF_Subset_C2RCC.dim (38.3MB)
2025-07-13 15:53:17,773 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 15:53:17,774 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 15:53:17,774 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 15:53:17,775 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 15:53:17,776 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 15:53:17,776 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 15:53:17,969 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1750
2025-07-13 15:53:18,161 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.7054
2025-07-13 15:53:18,352 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.4861
2025-07-13 15:53:18,353 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 15:53:18,806 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25307373 valid pixels out of 25307373 processed
2025-07-13 15:53:20,383 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 15:53:20,552 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 77.0% coverage, mean=4.635 mg/m¬≥
2025-07-13 15:53:20,553 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 15:53:21,036 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25307373 valid pixels out of 25307373 processed
2025-07-13 15:53:22,565 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 15:53:22,731 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 77.0% coverage, mean=2.746 g/m¬≥
2025-07-13 15:53:22,761 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 15:53:22,762 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 15:53:22,768 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 15:53:22,769 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 15:53:22,770 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 15:53:22,770 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190627T113321_T29TNF_Subset_C2RCC.dim (38.3 MB)
2025-07-13 15:53:22,771 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190627T113321_T29TNF_Subset_C2RCC.data
2025-07-13 15:53:22,771 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 15:53:22,772 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 15:53:22,772 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 15:53:22,773 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 15:53:22,774 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 15:53:22,774 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 15:53:22,775 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 15:53:22,775 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 15:53:22,776 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 15:53:22,777 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 15:53:22,777 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 15:53:22,778 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 15:53:22,778 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 15:53:22,779 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 15:53:22,779 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 15:53:22,780 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 15:53:22,780 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 15:53:22,781 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 15:53:22,782 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 15:53:22,783 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 15:53:22,783 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 15:53:22,784 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 15:53:22,784 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057.zip
2025-07-13 15:53:22,785 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 15:53:22,786 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 15:53:22,786 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 15:53:22,787 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 15:53:22,787 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 15:53:22,788 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 15:53:22,789 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 15:53:22,789 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 15:53:22,790 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057.zip
2025-07-13 15:53:22,792 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 15:53:23,589 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 15:53:24,185 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25307373 valid pixels with corrected Jiang algorithm
2025-07-13 16:01:09,397 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 16:01:09,398 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25307373/32874120 (77.0%)
2025-07-13 16:01:09,464 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 16:01:09,486 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 5959325 pixels (23.5%)
2025-07-13 16:01:09,508 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5519021 pixels (21.8%)
2025-07-13 16:01:09,529 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 13829026 pixels (54.6%)
2025-07-13 16:01:09,551 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 16:01:09,584 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 16:01:09,585 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 16:01:09,585 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 16:01:09,586 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 16:01:09,924 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25307373 pixels
2025-07-13 16:01:10,065 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 6.32 m
2025-07-13 16:01:10,203 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.506
2025-07-13 16:01:10,203 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 16:01:10,204 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:01:10,340 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:01:10,382 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 16:01:10,722 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25307373 pixels
2025-07-13 16:01:10,723 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 16:01:10,998 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 16:01:10,999 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 16:01:11,357 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 16:01:11,684 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 16:01:11,684 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 16:01:11,685 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 321 pixels (0.0%)
2025-07-13 16:01:11,686 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4956 pixels (0.0%)
2025-07-13 16:01:11,687 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2568 pixels (0.0%)
2025-07-13 16:01:11,694 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 16:01:11,695 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 16:01:11,717 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 16:01:11,719 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 16:01:11,719 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 16:01:11,720 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 16:01:13,103 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_Absorption.tif
2025-07-13 16:01:14,825 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_Backscattering.tif
2025-07-13 16:01:15,826 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_ReferenceBand.tif
2025-07-13 16:01:17,529 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_TSS.tif
2025-07-13 16:01:18,533 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_WaterTypes.tif
2025-07-13 16:01:19,450 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Jiang_ValidMask.tif
2025-07-13 16:01:21,298 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Secchidepth.tif
2025-07-13 16:01:23,068 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Clarityindex.tif
2025-07-13 16:01:24,938 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Euphoticdepth.tif
2025-07-13 16:01:26,795 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Diffuseattenuation.tif
2025-07-13 16:01:28,614 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Beamattenuation.tif
2025-07-13 16:01:30,347 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_Clarity_Turbidityproxy.tif
2025-07-13 16:01:31,093 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Probability.tif
2025-07-13 16:01:31,951 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Risk_Level.tif
2025-07-13 16:01:32,830 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_High_Biomass_Alert.tif
2025-07-13 16:01:33,711 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Extreme_Biomass_Alert.tif
2025-07-13 16:01:34,598 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Ndci_Bloom.tif
2025-07-13 16:01:35,450 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Flh_Bloom.tif
2025-07-13 16:01:36,310 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Mci_Bloom.tif
2025-07-13 16:01:37,184 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Cyanobacteria_Bloom.tif
2025-07-13 16:01:38,919 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Ndci_Values.tif
2025-07-13 16:01:40,759 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Flh_Values.tif
2025-07-13 16:01:42,521 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_HAB_Mci_Values.tif
2025-07-13 16:01:42,714 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_WaterTypes_Legend.txt
2025-07-13 16:01:42,715 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 16:01:42,716 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 16:01:42,717 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 16:01:42,717 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 16:01:42,718 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057
2025-07-13 16:01:42,881 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057 ===
2025-07-13 16:01:42,882 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 77.0%
2025-07-13 16:01:42,883 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 81.82 g/m¬≥
2025-07-13 16:01:42,883 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 3.05 g/m¬≥
2025-07-13 16:01:42,950 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 16:01:42,972 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 5959325 pixels (23.5%)
2025-07-13 16:01:42,997 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5519021 pixels (21.8%)
2025-07-13 16:01:43,022 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 13829026 pixels (54.6%)
2025-07-13 16:01:43,046 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 1 pixels (0.0%)
2025-07-13 16:01:43,117 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 7845 pixels with bloom risk (321 high risk)
2025-07-13 16:01:43,118 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 16:01:43,129 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190627T113321_N0500_R080_T29TNF_20230716T095057_ProductIndex.txt
2025-07-13 16:01:43,133 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 16:01:43,134 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 16:01:43,134 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 16:01:43,135 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 16:01:43,225 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 16:01:43,227 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 38.3MB, status=completed
2025-07-13 16:01:43,227 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 77.0% coverage, mean=4.63
2025-07-13 16:01:43,227 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 77.0% coverage, mean=2.75
2025-07-13 16:01:43,228 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 77.0% coverage, mean=1.61
2025-07-13 16:01:43,229 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 77.0% coverage, mean=0.02
2025-07-13 16:01:43,229 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 77.0% coverage, mean=681.26
2025-07-13 16:01:43,230 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 77.0% coverage, mean=3.05
2025-07-13 16:01:43,232 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.78
2025-07-13 16:01:43,232 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.77
2025-07-13 16:01:43,232 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 77.0% coverage, mean=6.32
2025-07-13 16:01:43,233 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 77.0% coverage, mean=0.51
2025-07-13 16:01:43,233 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 77.0% coverage, mean=17.12
2025-07-13 16:01:43,234 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 77.0% coverage, mean=1.65
2025-07-13 16:01:43,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 77.0% coverage, mean=1.63
2025-07-13 16:01:43,235 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 77.0% coverage, mean=23.22
2025-07-13 16:01:43,236 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,236 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,238 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,239 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,240 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,240 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 77.0% coverage, mean=-0.17
2025-07-13 16:01:43,242 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,242 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 16:01:43,352 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 17/63 (27.0%), ETA: 648.3 minutes
2025-07-13 16:01:43,353 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 16:01:43,353 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 18/63: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129
2025-07-13 16:01:43,354 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 16:01:43,355 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 16:01:43,355 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129.zip
2025-07-13 16:01:43,356 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 16:01:43,356 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 16:01:43,357 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 16:01:43,359 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 16:07:16,805 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:07:16,806 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:07:16,807 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:07:16,807 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190717T113321_T29TNF_Subset_C2RCC.dim (42.8 MB)
2025-07-13 16:07:16,808 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190717T113321_T29TNF_Subset_C2RCC.data
2025-07-13 16:07:16,808 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:07:16,809 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 16:07:16,810 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 16:07:16,810 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 16:07:16,811 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 16:07:16,811 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:07:16,812 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:07:16,813 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:07:16,813 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:07:16,814 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:07:16,814 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:07:16,815 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:07:16,815 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:07:16,816 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:07:16,817 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:07:16,817 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 16:07:16,818 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:07:16,818 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129.zip
2025-07-13 16:07:16,819 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190717T113321_T29TNF_Subset_C2RCC.dim (42.8MB)
2025-07-13 16:07:16,820 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.6 minutes
2025-07-13 16:07:16,820 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 16:07:16,821 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 16:07:16,821 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 16:07:16,822 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 16:07:16,823 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 16:07:17,020 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.2194
2025-07-13 16:07:17,217 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8970
2025-07-13 16:07:17,412 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.4564
2025-07-13 16:07:17,413 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 16:07:17,847 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26336413 valid pixels out of 26336413 processed
2025-07-13 16:07:19,390 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 16:07:19,563 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 80.1% coverage, mean=5.595 mg/m¬≥
2025-07-13 16:07:19,564 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 16:07:20,046 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26336413 valid pixels out of 26336413 processed
2025-07-13 16:07:21,568 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 16:07:21,728 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 80.1% coverage, mean=2.823 g/m¬≥
2025-07-13 16:07:21,756 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 16:07:21,756 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 16:07:21,762 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:07:21,762 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:07:21,763 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:07:21,764 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190717T113321_T29TNF_Subset_C2RCC.dim (42.8 MB)
2025-07-13 16:07:21,764 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190717T113321_T29TNF_Subset_C2RCC.data
2025-07-13 16:07:21,765 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:07:21,766 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 16:07:21,766 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 16:07:21,767 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 16:07:21,768 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 16:07:21,768 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:07:21,769 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:07:21,769 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:07:21,770 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:07:21,770 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:07:21,771 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:07:21,771 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:07:21,772 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:07:21,773 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:07:21,773 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:07:21,774 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 16:07:21,774 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 16:07:21,775 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 16:07:21,776 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 16:07:21,776 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:07:21,777 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 16:07:21,777 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 16:07:21,778 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129.zip
2025-07-13 16:07:21,779 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 16:07:21,779 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 16:07:21,780 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 16:07:21,780 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 16:07:21,781 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 16:07:21,781 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 16:07:21,782 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 16:07:21,783 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 16:07:21,784 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129.zip
2025-07-13 16:07:21,786 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 16:07:22,572 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 16:07:23,107 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26336413 valid pixels with corrected Jiang algorithm
2025-07-13 16:15:27,313 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 16:15:27,314 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26336413/32874120 (80.1%)
2025-07-13 16:15:27,372 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 16:15:27,394 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 6670142 pixels (25.3%)
2025-07-13 16:15:27,417 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5221049 pixels (19.8%)
2025-07-13 16:15:27,441 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 14445219 pixels (54.8%)
2025-07-13 16:15:27,466 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 3 pixels (0.0%)
2025-07-13 16:15:27,498 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 16:15:27,499 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 16:15:27,500 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 16:15:27,500 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 16:15:27,846 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26336413 pixels
2025-07-13 16:15:27,963 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 6.62 m
2025-07-13 16:15:28,079 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.511
2025-07-13 16:15:28,080 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 16:15:28,081 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:15:28,217 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:15:28,260 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 16:15:28,570 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26336413 pixels
2025-07-13 16:15:28,571 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 16:15:28,854 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 16:15:28,855 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 16:15:29,206 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 16:15:29,531 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 16:15:29,532 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 16:15:29,533 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 116 pixels (0.0%)
2025-07-13 16:15:29,534 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 3507 pixels (0.0%)
2025-07-13 16:15:29,534 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1651 pixels (0.0%)
2025-07-13 16:15:29,541 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 16:15:29,542 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 16:15:29,564 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 16:15:29,566 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 16:15:29,566 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 16:15:29,567 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 16:15:30,905 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_Absorption.tif
2025-07-13 16:15:32,616 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_Backscattering.tif
2025-07-13 16:15:33,498 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_ReferenceBand.tif
2025-07-13 16:15:35,180 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_TSS.tif
2025-07-13 16:15:36,180 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_WaterTypes.tif
2025-07-13 16:15:37,043 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Jiang_ValidMask.tif
2025-07-13 16:15:38,842 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Secchidepth.tif
2025-07-13 16:15:40,490 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Clarityindex.tif
2025-07-13 16:15:42,284 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Euphoticdepth.tif
2025-07-13 16:15:44,078 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Diffuseattenuation.tif
2025-07-13 16:15:45,851 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Beamattenuation.tif
2025-07-13 16:15:47,542 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_Clarity_Turbidityproxy.tif
2025-07-13 16:15:48,261 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Probability.tif
2025-07-13 16:15:49,119 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Risk_Level.tif
2025-07-13 16:15:49,970 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_High_Biomass_Alert.tif
2025-07-13 16:15:50,823 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Extreme_Biomass_Alert.tif
2025-07-13 16:15:51,677 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Ndci_Bloom.tif
2025-07-13 16:15:52,527 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Flh_Bloom.tif
2025-07-13 16:15:53,372 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Mci_Bloom.tif
2025-07-13 16:15:54,229 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Cyanobacteria_Bloom.tif
2025-07-13 16:15:55,864 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Ndci_Values.tif
2025-07-13 16:15:57,610 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Flh_Values.tif
2025-07-13 16:15:59,334 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_HAB_Mci_Values.tif
2025-07-13 16:15:59,531 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_WaterTypes_Legend.txt
2025-07-13 16:15:59,532 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 16:15:59,532 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 16:15:59,533 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 16:15:59,534 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 16:15:59,535 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129
2025-07-13 16:15:59,693 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129 ===
2025-07-13 16:15:59,694 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 80.1%
2025-07-13 16:15:59,694 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 81.73 g/m¬≥
2025-07-13 16:15:59,695 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 3.24 g/m¬≥
2025-07-13 16:15:59,755 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 16:15:59,789 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 6670142 pixels (25.3%)
2025-07-13 16:15:59,813 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5221049 pixels (19.8%)
2025-07-13 16:15:59,837 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 14445219 pixels (54.8%)
2025-07-13 16:15:59,860 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 3 pixels (0.0%)
2025-07-13 16:15:59,932 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 5274 pixels with bloom risk (116 high risk)
2025-07-13 16:15:59,933 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 16:15:59,937 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190717T113321_N0500_R080_T29TNF_20230724T143129_ProductIndex.txt
2025-07-13 16:15:59,941 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 16:15:59,941 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 16:15:59,942 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 16:15:59,943 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 16:16:00,034 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 16:16:00,035 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 42.8MB, status=completed
2025-07-13 16:16:00,035 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 80.1% coverage, mean=5.59
2025-07-13 16:16:00,036 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 80.1% coverage, mean=2.82
2025-07-13 16:16:00,036 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 80.1% coverage, mean=1.61
2025-07-13 16:16:00,037 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 80.1% coverage, mean=0.02
2025-07-13 16:16:00,037 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 80.1% coverage, mean=679.54
2025-07-13 16:16:00,038 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 80.1% coverage, mean=3.24
2025-07-13 16:16:00,039 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.84
2025-07-13 16:16:00,040 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.80
2025-07-13 16:16:00,040 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 80.1% coverage, mean=6.62
2025-07-13 16:16:00,041 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 80.1% coverage, mean=0.51
2025-07-13 16:16:00,042 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 80.1% coverage, mean=17.93
2025-07-13 16:16:00,042 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 80.1% coverage, mean=1.64
2025-07-13 16:16:00,043 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 80.1% coverage, mean=1.63
2025-07-13 16:16:00,044 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 80.1% coverage, mean=24.58
2025-07-13 16:16:00,044 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,045 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,045 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,046 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,046 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,047 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,048 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,048 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,049 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 80.1% coverage, mean=-0.17
2025-07-13 16:16:00,049 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,050 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 16:16:00,156 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 18/63 (28.6%), ETA: 634.7 minutes
2025-07-13 16:16:00,158 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 16:16:00,158 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 19/63: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921
2025-07-13 16:16:00,158 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 16:16:00,159 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 16:16:00,160 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921.zip
2025-07-13 16:16:00,160 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 16:16:00,161 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 16:16:00,161 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 16:16:00,163 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 16:20:53,965 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:20:53,966 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:20:53,967 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:20:53,967 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190803T112121_T29TNF_Subset_C2RCC.dim (41.8 MB)
2025-07-13 16:20:53,968 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190803T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:20:53,968 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:20:53,969 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 16:20:53,970 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 16:20:53,970 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 16:20:53,971 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 16:20:53,971 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:20:53,972 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:20:53,972 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:20:53,973 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:20:53,974 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:20:53,974 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:20:53,975 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:20:53,975 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:20:53,976 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:20:53,976 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:20:53,977 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 16:20:53,977 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:20:53,978 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921.zip
2025-07-13 16:20:53,979 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190803T112121_T29TNF_Subset_C2RCC.dim (41.8MB)
2025-07-13 16:20:53,979 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 4.9 minutes
2025-07-13 16:20:53,980 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 16:20:53,980 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 16:20:53,981 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 16:20:53,981 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 16:20:53,982 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 16:20:54,174 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0487
2025-07-13 16:20:54,365 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.3588
2025-07-13 16:20:54,560 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1125
2025-07-13 16:20:54,560 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 16:20:54,876 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 14939895 valid pixels out of 14939895 processed
2025-07-13 16:20:55,987 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 16:20:56,110 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 45.4% coverage, mean=2.108 mg/m¬≥
2025-07-13 16:20:56,111 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 16:20:56,486 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 14939895 valid pixels out of 14939895 processed
2025-07-13 16:20:57,585 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 16:20:57,698 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 45.4% coverage, mean=1.059 g/m¬≥
2025-07-13 16:20:57,721 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 16:20:57,722 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 16:20:57,728 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:20:57,728 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:20:57,729 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:20:57,730 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190803T112121_T29TNF_Subset_C2RCC.dim (41.8 MB)
2025-07-13 16:20:57,731 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190803T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:20:57,731 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:20:57,732 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 16:20:57,732 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 16:20:57,733 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 16:20:57,733 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 16:20:57,734 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:20:57,734 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:20:57,735 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:20:57,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:20:57,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:20:57,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:20:57,738 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:20:57,738 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:20:57,739 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:20:57,739 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:20:57,740 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 16:20:57,740 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 16:20:57,741 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 16:20:57,742 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 16:20:57,742 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:20:57,742 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 16:20:57,743 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 16:20:57,744 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921.zip
2025-07-13 16:20:57,744 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 16:20:57,745 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 16:20:57,746 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 16:20:57,746 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 16:20:57,747 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 16:20:57,747 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 16:20:57,748 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 16:20:57,748 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 16:20:57,749 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921.zip
2025-07-13 16:20:57,751 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 16:20:58,547 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 16:20:59,054 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 14939895 valid pixels with corrected Jiang algorithm
2025-07-13 16:25:37,485 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 16:25:37,486 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 14939895/32874120 (45.4%)
2025-07-13 16:25:37,528 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 16:25:37,542 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 6444952 pixels (43.1%)
2025-07-13 16:25:37,555 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5039090 pixels (33.7%)
2025-07-13 16:25:37,569 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 3455853 pixels (23.1%)
2025-07-13 16:25:37,610 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 16:25:37,611 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 16:25:37,611 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 16:25:37,612 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 16:25:37,944 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 14939895 pixels
2025-07-13 16:25:38,073 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 10.55 m
2025-07-13 16:25:38,202 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.684
2025-07-13 16:25:38,203 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 16:25:38,203 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:25:38,338 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:25:38,382 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 16:25:38,667 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 14939895 pixels
2025-07-13 16:25:38,668 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 16:25:38,949 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 16:25:38,950 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 16:25:39,313 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 16:25:39,637 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 16:25:39,638 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 16:25:39,639 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 4 pixels (0.0%)
2025-07-13 16:25:39,639 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 2122 pixels (0.0%)
2025-07-13 16:25:39,640 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 620 pixels (0.0%)
2025-07-13 16:25:39,647 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 16:25:39,647 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 16:25:39,670 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 16:25:39,672 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 16:25:39,673 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 16:25:39,673 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 16:25:40,772 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_Absorption.tif
2025-07-13 16:25:42,008 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_Backscattering.tif
2025-07-13 16:25:42,854 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_ReferenceBand.tif
2025-07-13 16:25:44,076 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_TSS.tif
2025-07-13 16:25:44,949 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_WaterTypes.tif
2025-07-13 16:25:45,817 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Jiang_ValidMask.tif
2025-07-13 16:25:47,207 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Secchidepth.tif
2025-07-13 16:25:48,475 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Clarityindex.tif
2025-07-13 16:25:49,822 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Euphoticdepth.tif
2025-07-13 16:25:51,131 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Diffuseattenuation.tif
2025-07-13 16:25:52,435 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Beamattenuation.tif
2025-07-13 16:25:53,671 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_Clarity_Turbidityproxy.tif
2025-07-13 16:25:54,353 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Probability.tif
2025-07-13 16:25:55,211 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Risk_Level.tif
2025-07-13 16:25:56,083 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_High_Biomass_Alert.tif
2025-07-13 16:25:56,945 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Extreme_Biomass_Alert.tif
2025-07-13 16:25:57,812 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Ndci_Bloom.tif
2025-07-13 16:25:58,661 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Flh_Bloom.tif
2025-07-13 16:25:59,534 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Mci_Bloom.tif
2025-07-13 16:26:00,400 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Cyanobacteria_Bloom.tif
2025-07-13 16:26:01,686 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Ndci_Values.tif
2025-07-13 16:26:03,032 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Flh_Values.tif
2025-07-13 16:26:04,390 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_HAB_Mci_Values.tif
2025-07-13 16:26:04,575 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_WaterTypes_Legend.txt
2025-07-13 16:26:04,576 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 16:26:04,577 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 16:26:04,578 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 16:26:04,578 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 16:26:04,579 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921
2025-07-13 16:26:04,690 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921 ===
2025-07-13 16:26:04,691 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 45.4%
2025-07-13 16:26:04,691 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 83.00 g/m¬≥
2025-07-13 16:26:04,692 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.00 g/m¬≥
2025-07-13 16:26:04,734 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 16:26:04,748 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 6444952 pixels (43.1%)
2025-07-13 16:26:04,761 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5039090 pixels (33.7%)
2025-07-13 16:26:04,774 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 3455853 pixels (23.1%)
2025-07-13 16:26:04,856 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 2746 pixels with bloom risk (4 high risk)
2025-07-13 16:26:04,857 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 16:26:04,868 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190803T112121_N0500_R037_T29TNF_20230718T013921_ProductIndex.txt
2025-07-13 16:26:04,871 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 16:26:04,872 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 16:26:04,873 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 16:26:04,874 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 16:26:04,960 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 16:26:04,961 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 41.8MB, status=completed
2025-07-13 16:26:04,961 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 45.4% coverage, mean=2.11
2025-07-13 16:26:04,962 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 45.4% coverage, mean=1.06
2025-07-13 16:26:04,963 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 45.4% coverage, mean=0.83
2025-07-13 16:26:04,964 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 45.4% coverage, mean=0.01
2025-07-13 16:26:04,964 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 45.4% coverage, mean=637.05
2025-07-13 16:26:04,965 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 45.4% coverage, mean=1.00
2025-07-13 16:26:04,965 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.82
2025-07-13 16:26:04,966 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.45
2025-07-13 16:26:04,966 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 45.4% coverage, mean=10.55
2025-07-13 16:26:04,967 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 45.4% coverage, mean=0.68
2025-07-13 16:26:04,968 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 45.4% coverage, mean=28.58
2025-07-13 16:26:04,968 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 45.4% coverage, mean=0.84
2025-07-13 16:26:04,969 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 45.4% coverage, mean=0.84
2025-07-13 16:26:04,969 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 45.4% coverage, mean=8.02
2025-07-13 16:26:04,970 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,970 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,971 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,971 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,972 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,972 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,973 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,974 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,974 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 45.4% coverage, mean=-0.23
2025-07-13 16:26:04,975 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 16:26:04,975 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 16:26:05,087 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 19/63 (30.2%), ETA: 611.3 minutes
2025-07-13 16:26:05,088 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 16:26:05,089 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 20/63: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934
2025-07-13 16:26:05,090 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 16:26:05,090 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 16:26:05,091 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934.zip
2025-07-13 16:26:05,091 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 16:26:05,092 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 16:26:05,092 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 16:26:05,095 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 16:31:16,528 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:31:16,529 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:31:16,530 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:31:16,530 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190813T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 16:31:16,531 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190813T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:31:16,531 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:31:16,532 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 16:31:16,533 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 16:31:16,533 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 16:31:16,534 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 16:31:16,534 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:31:16,535 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:31:16,536 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:31:16,536 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:31:16,537 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:31:16,537 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:31:16,538 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:31:16,539 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:31:16,539 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:31:16,540 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:31:16,540 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 16:31:16,541 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:31:16,542 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934.zip
2025-07-13 16:31:16,542 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190813T112121_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 16:31:16,543 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 16:31:16,543 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 16:31:16,544 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 16:31:16,544 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 16:31:16,545 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 16:31:16,546 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 16:31:16,744 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0480
2025-07-13 16:31:16,941 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.7330
2025-07-13 16:31:17,139 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1371
2025-07-13 16:31:17,140 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 16:31:17,577 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26847577 valid pixels out of 26847577 processed
2025-07-13 16:31:19,072 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 16:31:19,238 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.7% coverage, mean=1.135 mg/m¬≥
2025-07-13 16:31:19,238 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 16:31:19,707 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26847577 valid pixels out of 26847577 processed
2025-07-13 16:31:21,199 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 16:31:21,365 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.7% coverage, mean=1.090 g/m¬≥
2025-07-13 16:31:21,397 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 16:31:21,398 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 16:31:21,403 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:31:21,403 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:31:21,404 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:31:21,405 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190813T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 16:31:21,405 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190813T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:31:21,406 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:31:21,406 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 16:31:21,407 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 16:31:21,408 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 16:31:21,408 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 16:31:21,409 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:31:21,410 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:31:21,410 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:31:21,411 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:31:21,412 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:31:21,412 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:31:21,413 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:31:21,413 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:31:21,414 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:31:21,414 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:31:21,415 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 16:31:21,416 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 16:31:21,416 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 16:31:21,417 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 16:31:21,417 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:31:21,418 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 16:31:21,419 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 16:31:21,419 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934.zip
2025-07-13 16:31:21,420 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 16:31:21,420 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 16:31:21,421 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 16:31:21,421 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 16:31:21,422 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 16:31:21,422 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 16:31:21,423 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 16:31:21,424 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 16:31:21,425 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934.zip
2025-07-13 16:31:21,426 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 16:31:22,217 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 16:31:22,743 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26847577 valid pixels with corrected Jiang algorithm
2025-07-13 16:39:50,003 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 16:39:50,004 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26847577/32874120 (81.7%)
2025-07-13 16:39:50,061 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 16:39:50,085 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 16884150 pixels (62.9%)
2025-07-13 16:39:50,109 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 7931627 pixels (29.5%)
2025-07-13 16:39:50,133 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 2031800 pixels (7.6%)
2025-07-13 16:39:50,189 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 16:39:50,190 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 16:39:50,190 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 16:39:50,191 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 16:39:50,523 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26847577 pixels
2025-07-13 16:39:50,638 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 13.90 m
2025-07-13 16:39:50,754 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.795
2025-07-13 16:39:50,754 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 16:39:50,755 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:39:50,890 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:39:50,932 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 16:39:51,254 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26847577 pixels
2025-07-13 16:39:51,255 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 16:39:51,530 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 16:39:51,530 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 16:39:51,881 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 16:39:52,217 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 16:39:52,218 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 16:39:52,218 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 78 pixels (0.0%)
2025-07-13 16:39:52,219 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 2143 pixels (0.0%)
2025-07-13 16:39:52,220 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 832 pixels (0.0%)
2025-07-13 16:39:52,227 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 16:39:52,227 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 16:39:52,249 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 16:39:52,251 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 16:39:52,252 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 16:39:52,253 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 16:39:53,747 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_Absorption.tif
2025-07-13 16:39:55,412 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_Backscattering.tif
2025-07-13 16:39:56,267 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_ReferenceBand.tif
2025-07-13 16:39:57,934 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_TSS.tif
2025-07-13 16:39:58,902 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_WaterTypes.tif
2025-07-13 16:39:59,785 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Jiang_ValidMask.tif
2025-07-13 16:40:01,595 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Secchidepth.tif
2025-07-13 16:40:03,345 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Clarityindex.tif
2025-07-13 16:40:05,155 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Euphoticdepth.tif
2025-07-13 16:40:06,949 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Diffuseattenuation.tif
2025-07-13 16:40:08,684 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Beamattenuation.tif
2025-07-13 16:40:10,350 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_Clarity_Turbidityproxy.tif
2025-07-13 16:40:11,065 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Probability.tif
2025-07-13 16:40:11,900 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Risk_Level.tif
2025-07-13 16:40:12,753 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_High_Biomass_Alert.tif
2025-07-13 16:40:13,605 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Extreme_Biomass_Alert.tif
2025-07-13 16:40:14,467 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Ndci_Bloom.tif
2025-07-13 16:40:15,317 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Flh_Bloom.tif
2025-07-13 16:40:16,174 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Mci_Bloom.tif
2025-07-13 16:40:17,037 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Cyanobacteria_Bloom.tif
2025-07-13 16:40:18,652 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Ndci_Values.tif
2025-07-13 16:40:20,442 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Flh_Values.tif
2025-07-13 16:40:22,199 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_HAB_Mci_Values.tif
2025-07-13 16:40:22,385 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_WaterTypes_Legend.txt
2025-07-13 16:40:22,386 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 16:40:22,386 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 16:40:22,387 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 16:40:22,388 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 16:40:22,389 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934
2025-07-13 16:40:22,547 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934 ===
2025-07-13 16:40:22,548 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.7%
2025-07-13 16:40:22,549 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 83.55 g/m¬≥
2025-07-13 16:40:22,549 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.92 g/m¬≥
2025-07-13 16:40:22,606 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 16:40:22,630 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 16884150 pixels (62.9%)
2025-07-13 16:40:22,653 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 7931627 pixels (29.5%)
2025-07-13 16:40:22,676 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 2031800 pixels (7.6%)
2025-07-13 16:40:22,769 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 3053 pixels with bloom risk (78 high risk)
2025-07-13 16:40:22,770 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 16:40:22,775 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190813T112121_N0500_R037_T29TNF_20230506T205934_ProductIndex.txt
2025-07-13 16:40:22,778 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 16:40:22,779 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 16:40:22,780 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 16:40:22,780 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 16:40:22,867 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 16:40:22,868 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 16:40:22,868 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.7% coverage, mean=1.14
2025-07-13 16:40:22,869 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.7% coverage, mean=1.09
2025-07-13 16:40:22,870 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.7% coverage, mean=0.40
2025-07-13 16:40:22,870 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.7% coverage, mean=0.01
2025-07-13 16:40:22,871 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.7% coverage, mean=604.64
2025-07-13 16:40:22,871 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.7% coverage, mean=0.92
2025-07-13 16:40:22,872 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.18
2025-07-13 16:40:22,872 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 16:40:22,873 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.7% coverage, mean=13.90
2025-07-13 16:40:22,873 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.7% coverage, mean=0.80
2025-07-13 16:40:22,874 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.7% coverage, mean=37.64
2025-07-13 16:40:22,875 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.7% coverage, mean=0.41
2025-07-13 16:40:22,875 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.7% coverage, mean=0.41
2025-07-13 16:40:22,876 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.7% coverage, mean=8.03
2025-07-13 16:40:22,876 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,877 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,877 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,878 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,879 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,879 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,880 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,880 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,881 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.7% coverage, mean=-0.24
2025-07-13 16:40:22,881 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,882 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 16:40:22,994 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 20/63 (31.7%), ETA: 598.3 minutes
2025-07-13 16:40:22,997 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 16:40:22,997 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 21/63: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225
2025-07-13 16:40:22,998 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 16:40:22,998 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 16:40:22,999 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225.zip
2025-07-13 16:40:23,000 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 16:40:23,000 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 16:40:23,001 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 16:40:23,002 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 16:45:38,805 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:45:38,806 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:45:38,806 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:45:38,807 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190816T113321_T29TNF_Subset_C2RCC.dim (41.6 MB)
2025-07-13 16:45:38,807 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190816T113321_T29TNF_Subset_C2RCC.data
2025-07-13 16:45:38,808 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:45:38,809 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 16:45:38,809 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 16:45:38,809 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 16:45:38,810 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 16:45:38,811 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:45:38,812 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:45:38,812 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:45:38,812 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:45:38,813 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:45:38,813 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:45:38,814 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:45:38,814 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:45:38,815 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:45:38,815 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:45:38,816 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 16:45:38,817 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:45:38,817 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225.zip
2025-07-13 16:45:38,818 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190816T113321_T29TNF_Subset_C2RCC.dim (41.6MB)
2025-07-13 16:45:38,818 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 16:45:38,819 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 16:45:38,819 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 16:45:38,820 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 16:45:38,821 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 16:45:38,821 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 16:45:39,007 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.2515
2025-07-13 16:45:39,204 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8099
2025-07-13 16:45:39,398 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.0402
2025-07-13 16:45:39,399 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 16:45:39,857 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26822447 valid pixels out of 26822447 processed
2025-07-13 16:45:41,479 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 16:45:41,647 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.6% coverage, mean=6.306 mg/m¬≥
2025-07-13 16:45:41,648 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 16:45:42,125 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26822447 valid pixels out of 26822447 processed
2025-07-13 16:45:43,644 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 16:45:43,810 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.6% coverage, mean=2.218 g/m¬≥
2025-07-13 16:45:43,842 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 16:45:43,842 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 16:45:43,848 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:45:43,849 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:45:43,849 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:45:43,850 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190816T113321_T29TNF_Subset_C2RCC.dim (41.6 MB)
2025-07-13 16:45:43,850 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190816T113321_T29TNF_Subset_C2RCC.data
2025-07-13 16:45:43,851 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:45:43,851 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 16:45:43,852 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 16:45:43,852 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 16:45:43,853 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 16:45:43,854 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:45:43,854 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:45:43,855 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:45:43,855 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:45:43,856 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:45:43,856 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:45:43,857 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:45:43,857 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:45:43,858 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:45:43,858 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:45:43,859 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 16:45:43,859 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 16:45:43,860 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 16:45:43,860 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 16:45:43,860 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:45:43,861 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 16:45:43,861 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 16:45:43,862 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225.zip
2025-07-13 16:45:43,863 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 16:45:43,863 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 16:45:43,864 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 16:45:43,864 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 16:45:43,865 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 16:45:43,865 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 16:45:43,866 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 16:45:43,866 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 16:45:43,867 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225.zip
2025-07-13 16:45:43,869 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 16:45:44,645 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 16:45:45,162 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26822447 valid pixels with corrected Jiang algorithm
2025-07-13 16:53:56,218 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 16:53:56,218 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26822447/32874120 (81.6%)
2025-07-13 16:53:56,277 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 16:53:56,303 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 5356238 pixels (20.0%)
2025-07-13 16:53:56,326 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 7075304 pixels (26.4%)
2025-07-13 16:53:56,351 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 14390898 pixels (53.7%)
2025-07-13 16:53:56,376 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 16:53:56,410 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 16:53:56,411 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 16:53:56,412 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 16:53:56,413 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 16:53:56,764 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26822447 pixels
2025-07-13 16:53:56,878 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 5.28 m
2025-07-13 16:53:56,994 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.502
2025-07-13 16:53:56,994 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 16:53:56,995 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:53:57,136 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 16:53:57,179 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 16:53:57,488 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26822447 pixels
2025-07-13 16:53:57,489 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 16:53:57,776 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 16:53:57,777 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 16:53:58,124 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 16:53:58,446 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 16:53:58,447 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 16:53:58,448 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 52 pixels (0.0%)
2025-07-13 16:53:58,449 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 11469 pixels (0.0%)
2025-07-13 16:53:58,449 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3347 pixels (0.0%)
2025-07-13 16:53:58,456 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 16:53:58,457 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 16:53:58,479 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 16:53:58,481 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 16:53:58,481 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 16:53:58,482 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 16:53:59,817 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_Absorption.tif
2025-07-13 16:54:01,534 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_Backscattering.tif
2025-07-13 16:54:02,439 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_ReferenceBand.tif
2025-07-13 16:54:04,145 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_TSS.tif
2025-07-13 16:54:05,139 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_WaterTypes.tif
2025-07-13 16:54:05,993 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Jiang_ValidMask.tif
2025-07-13 16:54:07,796 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Secchidepth.tif
2025-07-13 16:54:09,450 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Clarityindex.tif
2025-07-13 16:54:11,263 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Euphoticdepth.tif
2025-07-13 16:54:13,090 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Diffuseattenuation.tif
2025-07-13 16:54:14,908 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Beamattenuation.tif
2025-07-13 16:54:16,625 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_Clarity_Turbidityproxy.tif
2025-07-13 16:54:17,349 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Probability.tif
2025-07-13 16:54:18,202 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Risk_Level.tif
2025-07-13 16:54:19,054 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_High_Biomass_Alert.tif
2025-07-13 16:54:19,917 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Extreme_Biomass_Alert.tif
2025-07-13 16:54:20,775 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Ndci_Bloom.tif
2025-07-13 16:54:21,625 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Flh_Bloom.tif
2025-07-13 16:54:22,479 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Mci_Bloom.tif
2025-07-13 16:54:23,333 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Cyanobacteria_Bloom.tif
2025-07-13 16:54:24,981 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Ndci_Values.tif
2025-07-13 16:54:26,746 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Flh_Values.tif
2025-07-13 16:54:28,519 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_HAB_Mci_Values.tif
2025-07-13 16:54:28,707 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_WaterTypes_Legend.txt
2025-07-13 16:54:28,707 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 16:54:28,708 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 16:54:28,709 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 16:54:28,710 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 16:54:28,710 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225
2025-07-13 16:54:28,871 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225 ===
2025-07-13 16:54:28,871 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.6%
2025-07-13 16:54:28,872 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 84.71 g/m¬≥
2025-07-13 16:54:28,873 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.42 g/m¬≥
2025-07-13 16:54:28,931 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 16:54:28,954 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 5356238 pixels (20.0%)
2025-07-13 16:54:28,979 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 7075304 pixels (26.4%)
2025-07-13 16:54:29,003 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 14390898 pixels (53.7%)
2025-07-13 16:54:29,031 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 16:54:29,105 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 14868 pixels with bloom risk (52 high risk)
2025-07-13 16:54:29,106 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 16:54:29,110 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190816T113321_N0500_R080_T29TNF_20230713T110225_ProductIndex.txt
2025-07-13 16:54:29,114 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 16:54:29,115 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 16:54:29,115 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 16:54:29,116 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 16:54:29,206 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 16:54:29,208 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 41.6MB, status=completed
2025-07-13 16:54:29,208 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.6% coverage, mean=6.31
2025-07-13 16:54:29,209 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.6% coverage, mean=2.22
2025-07-13 16:54:29,210 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.6% coverage, mean=1.60
2025-07-13 16:54:29,210 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.6% coverage, mean=0.02
2025-07-13 16:54:29,211 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.6% coverage, mean=684.27
2025-07-13 16:54:29,212 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.6% coverage, mean=2.42
2025-07-13 16:54:29,212 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.91
2025-07-13 16:54:29,213 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 16:54:29,214 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.6% coverage, mean=5.28
2025-07-13 16:54:29,214 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.6% coverage, mean=0.50
2025-07-13 16:54:29,215 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.6% coverage, mean=14.31
2025-07-13 16:54:29,215 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.6% coverage, mean=1.63
2025-07-13 16:54:29,216 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.6% coverage, mean=1.62
2025-07-13 16:54:29,217 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.6% coverage, mean=18.53
2025-07-13 16:54:29,217 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,218 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,218 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,219 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,220 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,220 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,221 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,221 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,222 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.6% coverage, mean=-0.17
2025-07-13 16:54:29,223 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,223 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 16:54:29,332 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 21/63 (33.3%), ETA: 584.7 minutes
2025-07-13 16:54:29,333 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 16:54:29,334 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 22/63: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121
2025-07-13 16:54:29,334 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 16:54:29,335 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 16:54:29,336 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121.zip
2025-07-13 16:54:29,336 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 16:54:29,337 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 16:54:29,338 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 16:54:29,340 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 16:59:23,295 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:59:23,296 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:59:23,296 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:59:23,298 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190823T112121_T29TNF_Subset_C2RCC.dim (25.7 MB)
2025-07-13 16:59:23,298 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190823T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:59:23,299 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:59:23,299 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 16:59:23,300 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 16:59:23,300 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 16:59:23,301 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 16:59:23,302 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:59:23,302 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:59:23,303 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:59:23,304 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:59:23,304 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:59:23,305 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:59:23,305 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:59:23,306 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:59:23,307 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:59:23,307 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:59:23,308 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 16:59:23,309 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:59:23,309 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121.zip
2025-07-13 16:59:23,310 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190823T112121_T29TNF_Subset_C2RCC.dim (25.7MB)
2025-07-13 16:59:23,310 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 4.9 minutes
2025-07-13 16:59:23,311 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 16:59:23,312 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 16:59:23,312 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 16:59:23,313 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 16:59:23,313 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 16:59:23,505 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0359
2025-07-13 16:59:23,696 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.3209
2025-07-13 16:59:23,886 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1037
2025-07-13 16:59:23,887 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 16:59:24,170 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 12876267 valid pixels out of 12876267 processed
2025-07-13 16:59:25,144 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 16:59:25,253 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 39.2% coverage, mean=1.800 mg/m¬≥
2025-07-13 16:59:25,253 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 16:59:25,566 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 12876267 valid pixels out of 12876267 processed
2025-07-13 16:59:26,538 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 16:59:26,637 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 39.2% coverage, mean=1.116 g/m¬≥
2025-07-13 16:59:26,661 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 16:59:26,662 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 16:59:26,668 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 16:59:26,669 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 16:59:26,669 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 16:59:26,670 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190823T112121_T29TNF_Subset_C2RCC.dim (25.7 MB)
2025-07-13 16:59:26,670 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190823T112121_T29TNF_Subset_C2RCC.data
2025-07-13 16:59:26,671 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 16:59:26,671 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 16:59:26,672 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 16:59:26,672 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 16:59:26,674 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 16:59:26,674 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 16:59:26,675 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 16:59:26,675 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 16:59:26,676 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 16:59:26,677 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 16:59:26,677 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 16:59:26,678 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 16:59:26,678 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 16:59:26,679 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 16:59:26,680 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 16:59:26,680 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 16:59:26,681 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 16:59:26,681 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 16:59:26,682 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 16:59:26,683 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 16:59:26,683 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 16:59:26,684 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 16:59:26,685 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121.zip
2025-07-13 16:59:26,685 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 16:59:26,686 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 16:59:26,686 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 16:59:26,687 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 16:59:26,688 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 16:59:26,688 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 16:59:26,689 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 16:59:26,689 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 16:59:26,690 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121.zip
2025-07-13 16:59:26,692 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 16:59:27,473 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 16:59:27,933 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 12876267 valid pixels with corrected Jiang algorithm
2025-07-13 17:03:29,536 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 17:03:29,537 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 12876267/32874120 (39.2%)
2025-07-13 17:03:29,570 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 17:03:29,582 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 6304488 pixels (49.0%)
2025-07-13 17:03:29,594 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 4566080 pixels (35.5%)
2025-07-13 17:03:29,606 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 2005699 pixels (15.6%)
2025-07-13 17:03:29,644 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 17:03:29,645 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 17:03:29,645 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 17:03:29,646 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 17:03:29,989 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 12876267 pixels
2025-07-13 17:03:30,115 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 10.47 m
2025-07-13 17:03:30,239 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.727
2025-07-13 17:03:30,240 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 17:03:30,241 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:03:30,373 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:03:30,416 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 17:03:30,673 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 12876267 pixels
2025-07-13 17:03:30,674 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 17:03:30,959 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 17:03:30,959 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 17:03:31,308 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 17:03:31,644 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 17:03:31,645 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 17:03:31,646 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 6 pixels (0.0%)
2025-07-13 17:03:31,647 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 1488 pixels (0.0%)
2025-07-13 17:03:31,647 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 462 pixels (0.0%)
2025-07-13 17:03:31,654 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 17:03:31,655 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 17:03:31,678 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 17:03:31,680 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 17:03:31,680 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 17:03:31,681 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 17:03:32,676 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_Absorption.tif
2025-07-13 17:03:33,765 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_Backscattering.tif
2025-07-13 17:03:34,557 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_ReferenceBand.tif
2025-07-13 17:03:35,629 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_TSS.tif
2025-07-13 17:03:36,444 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_WaterTypes.tif
2025-07-13 17:03:37,299 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Jiang_ValidMask.tif
2025-07-13 17:03:38,573 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Secchidepth.tif
2025-07-13 17:03:39,717 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Clarityindex.tif
2025-07-13 17:03:40,882 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Euphoticdepth.tif
2025-07-13 17:03:42,059 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Diffuseattenuation.tif
2025-07-13 17:03:43,216 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Beamattenuation.tif
2025-07-13 17:03:44,294 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_Clarity_Turbidityproxy.tif
2025-07-13 17:03:44,955 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Probability.tif
2025-07-13 17:03:45,792 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Risk_Level.tif
2025-07-13 17:03:46,641 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_High_Biomass_Alert.tif
2025-07-13 17:03:47,513 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Extreme_Biomass_Alert.tif
2025-07-13 17:03:48,375 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Ndci_Bloom.tif
2025-07-13 17:03:49,233 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Flh_Bloom.tif
2025-07-13 17:03:50,085 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Mci_Bloom.tif
2025-07-13 17:03:50,940 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Cyanobacteria_Bloom.tif
2025-07-13 17:03:52,104 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Ndci_Values.tif
2025-07-13 17:03:53,240 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Flh_Values.tif
2025-07-13 17:03:54,470 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_HAB_Mci_Values.tif
2025-07-13 17:03:54,654 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_WaterTypes_Legend.txt
2025-07-13 17:03:54,655 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 17:03:54,656 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 17:03:54,656 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 17:03:54,657 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 17:03:54,658 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121
2025-07-13 17:03:54,753 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121 ===
2025-07-13 17:03:54,754 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 39.2%
2025-07-13 17:03:54,754 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.02 - 81.78 g/m¬≥
2025-07-13 17:03:54,756 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.99 g/m¬≥
2025-07-13 17:03:54,788 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 17:03:54,799 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 6304488 pixels (49.0%)
2025-07-13 17:03:54,811 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 4566080 pixels (35.5%)
2025-07-13 17:03:54,822 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 2005699 pixels (15.6%)
2025-07-13 17:03:54,903 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 1956 pixels with bloom risk (6 high risk)
2025-07-13 17:03:54,904 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 17:03:54,908 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190823T112121_N0500_R037_T29TNF_20230506T023121_ProductIndex.txt
2025-07-13 17:03:54,912 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 17:03:54,913 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 17:03:54,914 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 17:03:54,914 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 17:03:55,010 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 17:03:55,011 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 25.7MB, status=completed
2025-07-13 17:03:55,012 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 39.2% coverage, mean=1.80
2025-07-13 17:03:55,012 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 39.2% coverage, mean=1.12
2025-07-13 17:03:55,013 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 39.2% coverage, mean=0.64
2025-07-13 17:03:55,013 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 39.2% coverage, mean=0.01
2025-07-13 17:03:55,014 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 39.2% coverage, mean=625.27
2025-07-13 17:03:55,014 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 39.2% coverage, mean=0.99
2025-07-13 17:03:55,015 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.65
2025-07-13 17:03:55,016 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.39
2025-07-13 17:03:55,016 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 39.2% coverage, mean=10.47
2025-07-13 17:03:55,017 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 39.2% coverage, mean=0.73
2025-07-13 17:03:55,017 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 39.2% coverage, mean=28.35
2025-07-13 17:03:55,018 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 39.2% coverage, mean=0.65
2025-07-13 17:03:55,019 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 39.2% coverage, mean=0.65
2025-07-13 17:03:55,019 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 39.2% coverage, mean=8.26
2025-07-13 17:03:55,020 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,020 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,021 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,021 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,022 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,023 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,023 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,024 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,025 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 39.2% coverage, mean=-0.23
2025-07-13 17:03:55,025 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,026 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 17:03:55,156 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 22/63 (34.9%), ETA: 562.5 minutes
2025-07-13 17:03:55,158 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 17:03:55,159 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 23/63: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203
2025-07-13 17:03:55,159 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 17:03:55,160 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 17:03:55,161 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203.zip
2025-07-13 17:03:55,161 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 17:03:55,162 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 17:03:55,163 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 17:03:55,165 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 17:09:18,000 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:09:18,001 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:09:18,002 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:09:18,003 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190826T113321_T29TNF_Subset_C2RCC.dim (38.9 MB)
2025-07-13 17:09:18,003 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190826T113321_T29TNF_Subset_C2RCC.data
2025-07-13 17:09:18,004 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:09:18,005 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 17:09:18,005 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 17:09:18,006 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 17:09:18,006 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 17:09:18,007 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:09:18,008 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:09:18,008 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:09:18,009 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:09:18,010 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:09:18,010 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:09:18,011 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:09:18,011 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:09:18,012 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:09:18,013 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:09:18,013 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 17:09:18,014 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:09:18,014 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203.zip
2025-07-13 17:09:18,015 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190826T113321_T29TNF_Subset_C2RCC.dim (38.9MB)
2025-07-13 17:09:18,016 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 17:09:18,016 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 17:09:18,017 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 17:09:18,017 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 17:09:18,018 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 17:09:18,019 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 17:09:18,211 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1672
2025-07-13 17:09:18,402 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8674
2025-07-13 17:09:18,595 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.3007
2025-07-13 17:09:18,595 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 17:09:19,031 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26982916 valid pixels out of 26982916 processed
2025-07-13 17:09:20,533 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 17:09:20,708 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.1% coverage, mean=4.081 mg/m¬≥
2025-07-13 17:09:20,709 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 17:09:21,198 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26982916 valid pixels out of 26982916 processed
2025-07-13 17:09:22,642 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 17:09:22,805 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.1% coverage, mean=1.450 g/m¬≥
2025-07-13 17:09:22,834 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 17:09:22,835 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 17:09:22,841 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:09:22,841 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:09:22,842 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:09:22,842 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190826T113321_T29TNF_Subset_C2RCC.dim (38.9 MB)
2025-07-13 17:09:22,843 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190826T113321_T29TNF_Subset_C2RCC.data
2025-07-13 17:09:22,844 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:09:22,844 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 17:09:22,845 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 17:09:22,846 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 17:09:22,846 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 17:09:22,847 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:09:22,848 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:09:22,848 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:09:22,849 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:09:22,850 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:09:22,850 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:09:22,851 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:09:22,852 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:09:22,852 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:09:22,853 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:09:22,853 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 17:09:22,854 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 17:09:22,854 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 17:09:22,855 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 17:09:22,856 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:09:22,856 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 17:09:22,857 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 17:09:22,857 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203.zip
2025-07-13 17:09:22,858 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 17:09:22,858 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 17:09:22,859 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 17:09:22,860 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 17:09:22,860 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 17:09:22,861 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 17:09:22,861 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 17:09:22,862 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 17:09:22,863 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203.zip
2025-07-13 17:09:22,865 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 17:09:23,685 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 17:09:24,219 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26982916 valid pixels with corrected Jiang algorithm
2025-07-13 17:17:37,942 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 17:17:37,943 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26982916/32874120 (82.1%)
2025-07-13 17:17:38,014 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 17:17:38,039 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 3993140 pixels (14.8%)
2025-07-13 17:17:38,062 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 17306258 pixels (64.1%)
2025-07-13 17:17:38,087 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 5683516 pixels (21.1%)
2025-07-13 17:17:38,111 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 17:17:38,143 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 17:17:38,144 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 17:17:38,145 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 17:17:38,146 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 17:17:38,495 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26982916 pixels
2025-07-13 17:17:38,610 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 4.99 m
2025-07-13 17:17:38,733 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.618
2025-07-13 17:17:38,734 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 17:17:38,734 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:17:38,869 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:17:38,913 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 17:17:39,230 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26982916 pixels
2025-07-13 17:17:39,231 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 17:17:39,522 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 17:17:39,523 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 17:17:39,875 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 17:17:40,204 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 17:17:40,205 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 17:17:40,206 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 434 pixels (0.0%)
2025-07-13 17:17:40,207 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4003 pixels (0.0%)
2025-07-13 17:17:40,207 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1623 pixels (0.0%)
2025-07-13 17:17:40,214 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 17:17:40,215 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 17:17:40,237 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 17:17:40,240 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 17:17:40,240 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 17:17:40,241 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 17:17:41,769 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_Absorption.tif
2025-07-13 17:17:43,370 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_Backscattering.tif
2025-07-13 17:17:44,196 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_ReferenceBand.tif
2025-07-13 17:17:45,773 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_TSS.tif
2025-07-13 17:17:46,714 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_WaterTypes.tif
2025-07-13 17:17:47,543 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Jiang_ValidMask.tif
2025-07-13 17:17:49,295 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Secchidepth.tif
2025-07-13 17:17:50,937 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Clarityindex.tif
2025-07-13 17:17:52,676 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Euphoticdepth.tif
2025-07-13 17:17:54,414 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Diffuseattenuation.tif
2025-07-13 17:17:56,176 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Beamattenuation.tif
2025-07-13 17:17:57,805 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_Clarity_Turbidityproxy.tif
2025-07-13 17:17:58,499 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Probability.tif
2025-07-13 17:17:59,309 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Risk_Level.tif
2025-07-13 17:18:00,143 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_High_Biomass_Alert.tif
2025-07-13 17:18:00,997 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Extreme_Biomass_Alert.tif
2025-07-13 17:18:01,847 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Ndci_Bloom.tif
2025-07-13 17:18:02,701 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Flh_Bloom.tif
2025-07-13 17:18:03,543 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Mci_Bloom.tif
2025-07-13 17:18:04,369 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Cyanobacteria_Bloom.tif
2025-07-13 17:18:05,942 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Ndci_Values.tif
2025-07-13 17:18:07,650 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Flh_Values.tif
2025-07-13 17:18:09,397 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_HAB_Mci_Values.tif
2025-07-13 17:18:09,584 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_WaterTypes_Legend.txt
2025-07-13 17:18:09,584 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 17:18:09,585 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 17:18:09,586 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 17:18:09,587 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 17:18:09,588 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203
2025-07-13 17:18:09,752 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203 ===
2025-07-13 17:18:09,753 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.1%
2025-07-13 17:18:09,754 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 84.67 g/m¬≥
2025-07-13 17:18:09,754 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.31 g/m¬≥
2025-07-13 17:18:09,811 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 17:18:09,835 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 3993140 pixels (14.8%)
2025-07-13 17:18:09,858 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 17306258 pixels (64.1%)
2025-07-13 17:18:09,881 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 5683516 pixels (21.1%)
2025-07-13 17:18:09,904 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 17:18:09,974 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 6060 pixels with bloom risk (434 high risk)
2025-07-13 17:18:09,975 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 17:18:09,979 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190826T113321_N0500_R080_T29TNF_20230719T144203_ProductIndex.txt
2025-07-13 17:18:09,982 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 17:18:09,983 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 17:18:09,984 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 17:18:09,984 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 17:18:10,071 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 17:18:10,072 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 38.9MB, status=completed
2025-07-13 17:18:10,073 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.1% coverage, mean=4.08
2025-07-13 17:18:10,073 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.1% coverage, mean=1.45
2025-07-13 17:18:10,074 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.1% coverage, mean=0.90
2025-07-13 17:18:10,075 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.1% coverage, mean=0.01
2025-07-13 17:18:10,075 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.1% coverage, mean=665.26
2025-07-13 17:18:10,076 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.1% coverage, mean=1.31
2025-07-13 17:18:10,076 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.69
2025-07-13 17:18:10,077 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 17:18:10,078 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.1% coverage, mean=4.99
2025-07-13 17:18:10,078 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.1% coverage, mean=0.62
2025-07-13 17:18:10,079 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.1% coverage, mean=13.51
2025-07-13 17:18:10,079 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.1% coverage, mean=0.92
2025-07-13 17:18:10,080 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.1% coverage, mean=0.91
2025-07-13 17:18:10,080 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.1% coverage, mean=10.66
2025-07-13 17:18:10,081 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,081 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,082 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,082 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,083 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,084 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,085 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,086 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,086 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.1% coverage, mean=-0.22
2025-07-13 17:18:10,087 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,087 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 17:18:10,191 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 23/63 (36.5%), ETA: 549.7 minutes
2025-07-13 17:18:10,193 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 17:18:10,193 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 24/63: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501
2025-07-13 17:18:10,194 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 17:18:10,194 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 17:18:10,195 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501.zip
2025-07-13 17:18:10,196 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 17:18:10,196 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 17:18:10,197 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 17:18:10,199 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 17:23:36,384 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:23:36,385 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:23:36,386 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:23:36,386 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190902T112111_T29TNF_Subset_C2RCC.dim (42.5 MB)
2025-07-13 17:23:36,387 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190902T112111_T29TNF_Subset_C2RCC.data
2025-07-13 17:23:36,387 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:23:36,388 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 17:23:36,389 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 17:23:36,389 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 17:23:36,390 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 17:23:36,390 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:23:36,391 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:23:36,391 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:23:36,392 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:23:36,393 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:23:36,394 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:23:36,394 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:23:36,395 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:23:36,395 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:23:36,395 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:23:36,395 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 17:23:36,396 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:23:36,397 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501.zip
2025-07-13 17:23:36,397 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190902T112111_T29TNF_Subset_C2RCC.dim (42.5MB)
2025-07-13 17:23:36,398 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 17:23:36,398 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 17:23:36,399 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 17:23:36,399 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 17:23:36,400 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 17:23:36,400 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 17:23:36,595 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0330
2025-07-13 17:23:36,785 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.5924
2025-07-13 17:23:36,975 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1199
2025-07-13 17:23:36,976 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 17:23:37,408 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26858934 valid pixels out of 26858934 processed
2025-07-13 17:23:38,860 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 17:23:39,029 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.7% coverage, mean=0.769 mg/m¬≥
2025-07-13 17:23:39,030 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 17:23:39,505 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26858934 valid pixels out of 26858934 processed
2025-07-13 17:23:40,936 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 17:23:41,101 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.7% coverage, mean=0.898 g/m¬≥
2025-07-13 17:23:41,130 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 17:23:41,131 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 17:23:41,137 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:23:41,137 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:23:41,138 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:23:41,138 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190902T112111_T29TNF_Subset_C2RCC.dim (42.5 MB)
2025-07-13 17:23:41,139 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190902T112111_T29TNF_Subset_C2RCC.data
2025-07-13 17:23:41,140 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:23:41,140 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 17:23:41,141 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 17:23:41,142 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 17:23:41,142 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 17:23:41,143 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:23:41,143 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:23:41,144 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:23:41,145 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:23:41,145 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:23:41,145 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:23:41,146 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:23:41,147 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:23:41,147 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:23:41,148 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:23:41,148 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 17:23:41,149 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 17:23:41,149 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 17:23:41,150 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 17:23:41,151 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:23:41,151 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 17:23:41,152 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 17:23:41,152 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501.zip
2025-07-13 17:23:41,153 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 17:23:41,153 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 17:23:41,154 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 17:23:41,154 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 17:23:41,155 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 17:23:41,155 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 17:23:41,156 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 17:23:41,157 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 17:23:41,158 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501.zip
2025-07-13 17:23:41,159 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 17:23:41,931 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 17:23:42,464 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26858934 valid pixels with corrected Jiang algorithm
2025-07-13 17:32:11,745 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 17:32:11,746 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26858934/32874120 (81.7%)
2025-07-13 17:32:11,805 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 17:32:11,829 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 18843729 pixels (70.2%)
2025-07-13 17:32:11,852 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 7056565 pixels (26.3%)
2025-07-13 17:32:11,876 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 958625 pixels (3.6%)
2025-07-13 17:32:11,900 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 15 pixels (0.0%)
2025-07-13 17:32:11,933 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 17:32:11,933 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 17:32:11,934 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 17:32:11,935 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 17:32:12,271 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26858934 pixels
2025-07-13 17:32:12,386 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 14.98 m
2025-07-13 17:32:12,501 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.831
2025-07-13 17:32:12,502 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 17:32:12,502 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:32:12,636 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:32:12,679 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 17:32:13,008 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26858934 pixels
2025-07-13 17:32:13,009 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 17:32:13,289 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 17:32:13,290 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 17:32:13,640 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 17:32:13,966 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 17:32:13,967 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 17:32:13,968 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 67 pixels (0.0%)
2025-07-13 17:32:13,969 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 15908 pixels (0.0%)
2025-07-13 17:32:13,969 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3095 pixels (0.0%)
2025-07-13 17:32:13,976 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 17:32:13,976 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 17:32:13,998 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 17:32:14,007 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 17:32:14,008 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 17:32:14,008 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 17:32:15,501 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_Absorption.tif
2025-07-13 17:32:17,101 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_Backscattering.tif
2025-07-13 17:32:17,956 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_ReferenceBand.tif
2025-07-13 17:32:19,572 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_TSS.tif
2025-07-13 17:32:20,543 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_WaterTypes.tif
2025-07-13 17:32:21,411 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Jiang_ValidMask.tif
2025-07-13 17:32:23,163 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Secchidepth.tif
2025-07-13 17:32:24,876 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Clarityindex.tif
2025-07-13 17:32:26,666 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Euphoticdepth.tif
2025-07-13 17:32:28,414 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Diffuseattenuation.tif
2025-07-13 17:32:30,183 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Beamattenuation.tif
2025-07-13 17:32:31,797 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_Clarity_Turbidityproxy.tif
2025-07-13 17:32:32,523 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Probability.tif
2025-07-13 17:32:33,375 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Risk_Level.tif
2025-07-13 17:32:34,240 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_High_Biomass_Alert.tif
2025-07-13 17:32:35,122 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Extreme_Biomass_Alert.tif
2025-07-13 17:32:36,015 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Ndci_Bloom.tif
2025-07-13 17:32:36,897 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Flh_Bloom.tif
2025-07-13 17:32:37,796 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Mci_Bloom.tif
2025-07-13 17:32:38,681 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Cyanobacteria_Bloom.tif
2025-07-13 17:32:40,390 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Ndci_Values.tif
2025-07-13 17:32:42,153 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Flh_Values.tif
2025-07-13 17:32:43,899 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_HAB_Mci_Values.tif
2025-07-13 17:32:44,084 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_WaterTypes_Legend.txt
2025-07-13 17:32:44,085 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 17:32:44,086 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 17:32:44,086 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 17:32:44,087 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 17:32:44,087 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501
2025-07-13 17:32:44,249 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501 ===
2025-07-13 17:32:44,249 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.7%
2025-07-13 17:32:44,250 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.00 g/m¬≥
2025-07-13 17:32:44,251 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.70 g/m¬≥
2025-07-13 17:32:44,308 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 17:32:44,332 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 18843729 pixels (70.2%)
2025-07-13 17:32:44,355 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 7056565 pixels (26.3%)
2025-07-13 17:32:44,379 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 958625 pixels (3.6%)
2025-07-13 17:32:44,402 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 15 pixels (0.0%)
2025-07-13 17:32:44,473 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 19070 pixels with bloom risk (67 high risk)
2025-07-13 17:32:44,474 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 17:32:44,486 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190902T112111_N0500_R037_T29TNF_20230702T064501_ProductIndex.txt
2025-07-13 17:32:44,490 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 17:32:44,490 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 17:32:44,491 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 17:32:44,491 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 17:32:44,579 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 17:32:44,580 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 42.5MB, status=completed
2025-07-13 17:32:44,580 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.7% coverage, mean=0.77
2025-07-13 17:32:44,581 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.7% coverage, mean=0.90
2025-07-13 17:32:44,581 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.7% coverage, mean=0.28
2025-07-13 17:32:44,582 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.7% coverage, mean=0.01
2025-07-13 17:32:44,582 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.7% coverage, mean=594.01
2025-07-13 17:32:44,583 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.7% coverage, mean=0.70
2025-07-13 17:32:44,584 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.09
2025-07-13 17:32:44,585 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 17:32:44,585 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.7% coverage, mean=14.98
2025-07-13 17:32:44,586 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.7% coverage, mean=0.83
2025-07-13 17:32:44,586 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.7% coverage, mean=40.57
2025-07-13 17:32:44,587 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.7% coverage, mean=0.29
2025-07-13 17:32:44,588 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.7% coverage, mean=0.29
2025-07-13 17:32:44,588 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.7% coverage, mean=6.16
2025-07-13 17:32:44,589 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,589 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,590 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,591 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,591 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,592 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,593 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,593 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,594 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.7% coverage, mean=-0.25
2025-07-13 17:32:44,594 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 17:32:44,595 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 17:32:44,699 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 24/63 (38.1%), ETA: 537.3 minutes
2025-07-13 17:32:44,700 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 17:32:44,701 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 25/63: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230
2025-07-13 17:32:44,702 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 17:32:44,702 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 17:32:44,703 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230.zip
2025-07-13 17:32:44,703 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 17:32:44,704 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 17:32:44,704 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 17:32:44,706 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 17:38:11,547 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:38:11,548 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:38:11,549 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:38:11,549 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190905T113321_T29TNF_Subset_C2RCC.dim (23.0 MB)
2025-07-13 17:38:11,550 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190905T113321_T29TNF_Subset_C2RCC.data
2025-07-13 17:38:11,550 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:38:11,551 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 17:38:11,551 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 17:38:11,552 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 17:38:11,552 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 17:38:11,553 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:38:11,554 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:38:11,554 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:38:11,555 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:38:11,556 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:38:11,556 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:38:11,557 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:38:11,557 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:38:11,558 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:38:11,558 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:38:11,559 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 17:38:11,559 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:38:11,560 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230.zip
2025-07-13 17:38:11,561 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190905T113321_T29TNF_Subset_C2RCC.dim (23.0MB)
2025-07-13 17:38:11,561 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 17:38:11,562 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 17:38:11,562 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 17:38:11,563 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 17:38:11,563 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 17:38:11,564 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 17:38:11,766 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.3701
2025-07-13 17:38:11,964 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.7937
2025-07-13 17:38:12,163 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.9363
2025-07-13 17:38:12,164 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 17:38:12,627 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26919117 valid pixels out of 26919117 processed
2025-07-13 17:38:14,196 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 17:38:14,363 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.9% coverage, mean=9.308 mg/m¬≥
2025-07-13 17:38:14,363 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 17:38:14,836 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26919117 valid pixels out of 26919117 processed
2025-07-13 17:38:16,340 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 17:38:16,507 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.9% coverage, mean=3.215 g/m¬≥
2025-07-13 17:38:16,539 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 17:38:16,540 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 17:38:16,545 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:38:16,546 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:38:16,546 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:38:16,547 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190905T113321_T29TNF_Subset_C2RCC.dim (23.0 MB)
2025-07-13 17:38:16,547 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190905T113321_T29TNF_Subset_C2RCC.data
2025-07-13 17:38:16,548 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:38:16,548 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 17:38:16,549 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 17:38:16,550 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 17:38:16,550 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 17:38:16,551 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:38:16,551 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:38:16,552 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:38:16,553 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:38:16,553 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:38:16,554 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:38:16,554 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:38:16,555 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:38:16,555 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:38:16,556 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:38:16,557 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 17:38:16,557 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 17:38:16,558 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 17:38:16,558 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 17:38:16,558 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:38:16,559 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 17:38:16,560 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 17:38:16,560 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230.zip
2025-07-13 17:38:16,560 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 17:38:16,561 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 17:38:16,562 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 17:38:16,562 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 17:38:16,563 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 17:38:16,564 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 17:38:16,564 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 17:38:16,564 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 17:38:16,565 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230.zip
2025-07-13 17:38:16,567 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 17:38:17,372 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 17:38:17,888 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26919117 valid pixels with corrected Jiang algorithm
2025-07-13 17:46:24,841 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 17:46:24,842 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26919117/32874120 (81.9%)
2025-07-13 17:46:24,902 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 17:46:24,926 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 1757938 pixels (6.5%)
2025-07-13 17:46:24,951 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5710050 pixels (21.2%)
2025-07-13 17:46:24,974 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 19451102 pixels (72.3%)
2025-07-13 17:46:24,998 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 17:46:25,032 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 17:46:25,032 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 17:46:25,033 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 17:46:25,034 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 17:46:25,375 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26919117 pixels
2025-07-13 17:46:25,493 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 2.45 m
2025-07-13 17:46:25,618 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.392
2025-07-13 17:46:25,619 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 17:46:25,619 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:46:25,755 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 17:46:25,798 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 17:46:26,114 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26919117 pixels
2025-07-13 17:46:26,115 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 17:46:26,392 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 17:46:26,393 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 17:46:26,787 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 17:46:27,122 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 17:46:27,123 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 17:46:27,124 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 151 pixels (0.0%)
2025-07-13 17:46:27,125 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 13964 pixels (0.0%)
2025-07-13 17:46:27,125 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3411 pixels (0.0%)
2025-07-13 17:46:27,133 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 17:46:27,133 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 17:46:27,156 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 17:46:27,158 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 17:46:27,158 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 17:46:27,159 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 17:46:28,300 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_Absorption.tif
2025-07-13 17:46:30,023 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_Backscattering.tif
2025-07-13 17:46:30,889 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_ReferenceBand.tif
2025-07-13 17:46:32,556 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_TSS.tif
2025-07-13 17:46:33,534 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_WaterTypes.tif
2025-07-13 17:46:34,391 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Jiang_ValidMask.tif
2025-07-13 17:46:36,208 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Secchidepth.tif
2025-07-13 17:46:37,917 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Clarityindex.tif
2025-07-13 17:46:39,698 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Euphoticdepth.tif
2025-07-13 17:46:41,501 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Diffuseattenuation.tif
2025-07-13 17:46:43,308 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Beamattenuation.tif
2025-07-13 17:46:44,991 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_Clarity_Turbidityproxy.tif
2025-07-13 17:46:45,721 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Probability.tif
2025-07-13 17:46:46,566 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Risk_Level.tif
2025-07-13 17:46:47,415 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_High_Biomass_Alert.tif
2025-07-13 17:46:48,269 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Extreme_Biomass_Alert.tif
2025-07-13 17:46:49,120 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Ndci_Bloom.tif
2025-07-13 17:46:49,972 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Flh_Bloom.tif
2025-07-13 17:46:50,822 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Mci_Bloom.tif
2025-07-13 17:46:51,676 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Cyanobacteria_Bloom.tif
2025-07-13 17:46:53,298 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Ndci_Values.tif
2025-07-13 17:46:55,036 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Flh_Values.tif
2025-07-13 17:46:56,793 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_HAB_Mci_Values.tif
2025-07-13 17:46:56,989 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_WaterTypes_Legend.txt
2025-07-13 17:46:56,990 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 17:46:56,990 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 17:46:56,991 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 17:46:56,992 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 17:46:56,992 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230
2025-07-13 17:46:57,154 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230 ===
2025-07-13 17:46:57,155 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.9%
2025-07-13 17:46:57,155 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.54 g/m¬≥
2025-07-13 17:46:57,156 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 3.58 g/m¬≥
2025-07-13 17:46:57,214 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 17:46:57,238 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 1757938 pixels (6.5%)
2025-07-13 17:46:57,261 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5710050 pixels (21.2%)
2025-07-13 17:46:57,284 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 19451102 pixels (72.3%)
2025-07-13 17:46:57,307 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 17:46:57,377 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 17526 pixels with bloom risk (151 high risk)
2025-07-13 17:46:57,377 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 17:46:57,382 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190905T113321_N0500_R080_T29TNF_20230501T110230_ProductIndex.txt
2025-07-13 17:46:57,386 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 17:46:57,386 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 17:46:57,387 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 17:46:57,388 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 17:46:57,475 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 17:46:57,476 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 23.0MB, status=completed
2025-07-13 17:46:57,477 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.9% coverage, mean=9.31
2025-07-13 17:46:57,478 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.9% coverage, mean=3.21
2025-07-13 17:46:57,478 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.9% coverage, mean=2.07
2025-07-13 17:46:57,479 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.9% coverage, mean=0.03
2025-07-13 17:46:57,479 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.9% coverage, mean=712.34
2025-07-13 17:46:57,480 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.9% coverage, mean=3.58
2025-07-13 17:46:57,480 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=2.18
2025-07-13 17:46:57,481 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 17:46:57,482 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.9% coverage, mean=2.45
2025-07-13 17:46:57,483 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.9% coverage, mean=0.39
2025-07-13 17:46:57,483 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.9% coverage, mean=6.63
2025-07-13 17:46:57,484 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.9% coverage, mean=2.11
2025-07-13 17:46:57,484 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.9% coverage, mean=2.10
2025-07-13 17:46:57,485 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.9% coverage, mean=26.87
2025-07-13 17:46:57,485 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,486 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,487 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,487 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,488 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,489 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,489 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,490 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,491 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.9% coverage, mean=-0.14
2025-07-13 17:46:57,491 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,492 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 17:46:57,602 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 25/63 (39.7%), ETA: 524.2 minutes
2025-07-13 17:46:57,603 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 17:46:57,604 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 26/63: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933
2025-07-13 17:46:57,604 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 17:46:57,605 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 17:46:57,606 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933.zip
2025-07-13 17:46:57,606 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 17:46:57,607 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 17:46:57,608 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 17:46:57,610 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 17:52:19,294 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:52:19,295 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:52:19,295 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:52:19,296 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190912T112111_T29TNF_Subset_C2RCC.dim (20.7 MB)
2025-07-13 17:52:19,297 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190912T112111_T29TNF_Subset_C2RCC.data
2025-07-13 17:52:19,297 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:52:19,298 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 17:52:19,299 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 17:52:19,299 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 17:52:19,300 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 17:52:19,300 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:52:19,301 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:52:19,301 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:52:19,302 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:52:19,303 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:52:19,303 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:52:19,304 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:52:19,304 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:52:19,305 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:52:19,306 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:52:19,306 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 17:52:19,307 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:52:19,307 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933.zip
2025-07-13 17:52:19,308 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190912T112111_T29TNF_Subset_C2RCC.dim (20.7MB)
2025-07-13 17:52:19,309 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 17:52:19,309 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 17:52:19,310 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 17:52:19,311 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 17:52:19,311 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 17:52:19,311 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 17:52:19,505 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0294
2025-07-13 17:52:19,701 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.4776
2025-07-13 17:52:19,899 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1086
2025-07-13 17:52:19,900 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 17:52:20,344 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26930830 valid pixels out of 26930830 processed
2025-07-13 17:52:21,805 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 17:52:21,972 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.9% coverage, mean=0.681 mg/m¬≥
2025-07-13 17:52:21,973 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 17:52:22,427 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26930830 valid pixels out of 26930830 processed
2025-07-13 17:52:23,861 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 17:52:24,028 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.9% coverage, mean=0.742 g/m¬≥
2025-07-13 17:52:24,060 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 17:52:24,061 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 17:52:24,066 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 17:52:24,067 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 17:52:24,067 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 17:52:24,068 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190912T112111_T29TNF_Subset_C2RCC.dim (20.7 MB)
2025-07-13 17:52:24,069 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190912T112111_T29TNF_Subset_C2RCC.data
2025-07-13 17:52:24,069 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 17:52:24,070 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 17:52:24,071 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 17:52:24,071 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 17:52:24,072 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 17:52:24,072 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 17:52:24,074 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 17:52:24,074 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 17:52:24,075 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 17:52:24,075 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 17:52:24,076 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 17:52:24,077 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 17:52:24,077 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 17:52:24,078 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 17:52:24,078 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 17:52:24,079 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 17:52:24,080 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 17:52:24,080 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 17:52:24,081 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 17:52:24,081 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 17:52:24,082 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 17:52:24,082 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 17:52:24,083 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933.zip
2025-07-13 17:52:24,084 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 17:52:24,084 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 17:52:24,085 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 17:52:24,085 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 17:52:24,086 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 17:52:24,086 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 17:52:24,087 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 17:52:24,088 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 17:52:24,089 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933.zip
2025-07-13 17:52:24,090 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 17:52:24,867 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 17:52:25,389 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26930830 valid pixels with corrected Jiang algorithm
2025-07-13 18:00:59,796 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 18:00:59,798 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26930830/32874120 (81.9%)
2025-07-13 18:00:59,857 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 18:00:59,881 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 21891803 pixels (81.3%)
2025-07-13 18:00:59,905 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 4341496 pixels (16.1%)
2025-07-13 18:00:59,930 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 697517 pixels (2.6%)
2025-07-13 18:00:59,956 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 14 pixels (0.0%)
2025-07-13 18:00:59,990 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 18:00:59,991 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 18:00:59,991 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 18:00:59,992 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 18:01:00,346 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26930830 pixels
2025-07-13 18:01:00,464 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 17.09 m
2025-07-13 18:01:00,581 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.863
2025-07-13 18:01:00,582 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 18:01:00,583 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:01:00,716 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:01:00,760 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 18:01:01,076 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26930830 pixels
2025-07-13 18:01:01,077 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 18:01:01,369 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 18:01:01,370 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 18:01:01,734 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 18:01:02,066 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 18:01:02,067 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 18:01:02,068 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 102 pixels (0.0%)
2025-07-13 18:01:02,068 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4320 pixels (0.0%)
2025-07-13 18:01:02,069 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1524 pixels (0.0%)
2025-07-13 18:01:02,076 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 18:01:02,077 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 18:01:02,100 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 18:01:02,110 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 18:01:02,111 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 18:01:02,111 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 18:01:03,604 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_Absorption.tif
2025-07-13 18:01:05,187 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_Backscattering.tif
2025-07-13 18:01:06,046 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_ReferenceBand.tif
2025-07-13 18:01:07,661 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_TSS.tif
2025-07-13 18:01:08,595 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_WaterTypes.tif
2025-07-13 18:01:09,467 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Jiang_ValidMask.tif
2025-07-13 18:01:11,180 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Secchidepth.tif
2025-07-13 18:01:12,901 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Clarityindex.tif
2025-07-13 18:01:14,616 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Euphoticdepth.tif
2025-07-13 18:01:16,322 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Diffuseattenuation.tif
2025-07-13 18:01:18,022 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Beamattenuation.tif
2025-07-13 18:01:19,603 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_Clarity_Turbidityproxy.tif
2025-07-13 18:01:20,335 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Probability.tif
2025-07-13 18:01:21,204 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Risk_Level.tif
2025-07-13 18:01:22,049 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_High_Biomass_Alert.tif
2025-07-13 18:01:22,902 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Extreme_Biomass_Alert.tif
2025-07-13 18:01:23,769 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Ndci_Bloom.tif
2025-07-13 18:01:24,637 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Flh_Bloom.tif
2025-07-13 18:01:25,498 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Mci_Bloom.tif
2025-07-13 18:01:26,349 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Cyanobacteria_Bloom.tif
2025-07-13 18:01:27,983 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Ndci_Values.tif
2025-07-13 18:01:29,708 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Flh_Values.tif
2025-07-13 18:01:31,391 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_HAB_Mci_Values.tif
2025-07-13 18:01:31,575 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_WaterTypes_Legend.txt
2025-07-13 18:01:31,575 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 18:01:31,576 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 18:01:31,577 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 18:01:31,578 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 18:01:31,579 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933
2025-07-13 18:01:31,746 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933 ===
2025-07-13 18:01:31,747 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.9%
2025-07-13 18:01:31,748 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.15 g/m¬≥
2025-07-13 18:01:31,748 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.59 g/m¬≥
2025-07-13 18:01:31,806 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 18:01:31,830 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 21891803 pixels (81.3%)
2025-07-13 18:01:31,853 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 4341496 pixels (16.1%)
2025-07-13 18:01:31,877 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 697517 pixels (2.6%)
2025-07-13 18:01:31,900 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 14 pixels (0.0%)
2025-07-13 18:01:31,969 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 5946 pixels with bloom risk (102 high risk)
2025-07-13 18:01:31,969 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 18:01:31,974 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190912T112111_N0500_R037_T29TNF_20230503T115933_ProductIndex.txt
2025-07-13 18:01:31,978 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 18:01:31,979 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 18:01:31,979 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 18:01:31,980 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 18:01:32,067 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 18:01:32,068 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.7MB, status=completed
2025-07-13 18:01:32,069 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.9% coverage, mean=0.68
2025-07-13 18:01:32,069 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.9% coverage, mean=0.74
2025-07-13 18:01:32,070 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.9% coverage, mean=0.21
2025-07-13 18:01:32,070 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.9% coverage, mean=0.01
2025-07-13 18:01:32,071 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.9% coverage, mean=581.59
2025-07-13 18:01:32,071 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.9% coverage, mean=0.59
2025-07-13 18:01:32,072 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.99
2025-07-13 18:01:32,073 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 18:01:32,073 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.9% coverage, mean=17.09
2025-07-13 18:01:32,074 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.9% coverage, mean=0.86
2025-07-13 18:01:32,075 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.9% coverage, mean=46.31
2025-07-13 18:01:32,076 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.9% coverage, mean=0.22
2025-07-13 18:01:32,076 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.9% coverage, mean=0.22
2025-07-13 18:01:32,077 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.9% coverage, mean=5.27
2025-07-13 18:01:32,077 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,078 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,079 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,079 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,080 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,081 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,081 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,082 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,082 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.9% coverage, mean=-0.26
2025-07-13 18:01:32,083 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 18:01:32,084 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 18:01:32,184 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 26/63 (41.3%), ETA: 511.5 minutes
2025-07-13 18:01:32,186 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 18:01:32,187 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 27/63: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407
2025-07-13 18:01:32,187 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 18:01:32,188 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 18:01:32,188 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407.zip
2025-07-13 18:01:32,189 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 18:01:32,190 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 18:01:32,191 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 18:01:32,193 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 18:06:46,324 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:06:46,324 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:06:46,325 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:06:46,326 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190915T113321_T29TNF_Subset_C2RCC.dim (23.2 MB)
2025-07-13 18:06:46,326 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190915T113321_T29TNF_Subset_C2RCC.data
2025-07-13 18:06:46,327 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:06:46,327 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 18:06:46,328 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 18:06:46,329 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 18:06:46,330 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 18:06:46,330 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:06:46,331 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:06:46,332 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:06:46,332 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:06:46,333 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:06:46,334 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:06:46,334 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:06:46,335 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:06:46,336 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:06:46,336 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:06:46,337 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 18:06:46,337 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:06:46,338 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407.zip
2025-07-13 18:06:46,339 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20190915T113321_T29TNF_Subset_C2RCC.dim (23.2MB)
2025-07-13 18:06:46,339 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 18:06:46,340 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 18:06:46,341 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 18:06:46,341 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 18:06:46,342 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 18:06:46,342 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 18:06:46,535 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.5015
2025-07-13 18:06:46,728 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.7470
2025-07-13 18:06:46,919 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=1.0522
2025-07-13 18:06:46,920 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 18:06:47,361 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25997868 valid pixels out of 25997868 processed
2025-07-13 18:06:48,748 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 18:06:48,923 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 79.1% coverage, mean=13.127 mg/m¬≥
2025-07-13 18:06:48,924 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 18:06:49,376 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25997868 valid pixels out of 25997868 processed
2025-07-13 18:06:50,743 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 18:06:50,901 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 79.1% coverage, mean=2.266 g/m¬≥
2025-07-13 18:06:50,928 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 18:06:50,929 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 18:06:50,934 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:06:50,935 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:06:50,936 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:06:50,936 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20190915T113321_T29TNF_Subset_C2RCC.dim (23.2 MB)
2025-07-13 18:06:50,937 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20190915T113321_T29TNF_Subset_C2RCC.data
2025-07-13 18:06:50,937 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:06:50,938 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 18:06:50,939 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 18:06:50,939 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 18:06:50,940 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 18:06:50,940 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:06:50,941 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:06:50,941 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:06:50,942 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:06:50,943 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:06:50,943 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:06:50,944 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:06:50,945 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:06:50,945 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:06:50,946 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:06:50,947 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 18:06:50,947 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 18:06:50,948 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 18:06:50,948 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 18:06:50,949 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:06:50,950 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 18:06:50,950 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 18:06:50,951 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407.zip
2025-07-13 18:06:50,951 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 18:06:50,952 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 18:06:50,952 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 18:06:50,953 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 18:06:50,954 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 18:06:50,954 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 18:06:50,955 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 18:06:50,955 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 18:06:50,957 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407.zip
2025-07-13 18:06:50,958 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 18:06:51,737 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 18:06:52,265 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25997868 valid pixels with corrected Jiang algorithm
2025-07-13 18:14:38,076 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 18:14:38,077 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25997868/32874120 (79.1%)
2025-07-13 18:14:38,135 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 18:14:38,159 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 168228 pixels (0.6%)
2025-07-13 18:14:38,182 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 4201672 pixels (16.2%)
2025-07-13 18:14:38,205 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 21627962 pixels (83.2%)
2025-07-13 18:14:38,227 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 6 pixels (0.0%)
2025-07-13 18:14:38,259 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 18:14:38,260 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 18:14:38,260 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 18:14:38,261 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 18:14:38,596 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25997868 pixels
2025-07-13 18:14:38,711 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 1.19 m
2025-07-13 18:14:38,827 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.334
2025-07-13 18:14:38,828 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 18:14:38,829 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:14:38,976 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:14:39,020 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 18:14:39,329 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25997868 pixels
2025-07-13 18:14:39,329 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 18:14:39,605 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 18:14:39,605 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 18:14:39,960 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 18:14:40,284 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 18:14:40,285 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 18:14:40,286 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 1312 pixels (0.0%)
2025-07-13 18:14:40,287 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 11187 pixels (0.0%)
2025-07-13 18:14:40,287 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 3994 pixels (0.0%)
2025-07-13 18:14:40,294 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 18:14:40,295 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 18:14:40,317 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 18:14:40,318 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 18:14:40,319 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 18:14:40,319 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 18:14:41,182 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_Absorption.tif
2025-07-13 18:14:42,708 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_Backscattering.tif
2025-07-13 18:14:43,580 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_ReferenceBand.tif
2025-07-13 18:14:45,138 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_TSS.tif
2025-07-13 18:14:46,043 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_WaterTypes.tif
2025-07-13 18:14:46,902 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Jiang_ValidMask.tif
2025-07-13 18:14:48,640 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Secchidepth.tif
2025-07-13 18:14:50,258 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Clarityindex.tif
2025-07-13 18:14:51,992 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Euphoticdepth.tif
2025-07-13 18:14:53,725 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Diffuseattenuation.tif
2025-07-13 18:14:55,417 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Beamattenuation.tif
2025-07-13 18:14:56,979 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_Clarity_Turbidityproxy.tif
2025-07-13 18:14:57,718 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Probability.tif
2025-07-13 18:14:58,591 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Risk_Level.tif
2025-07-13 18:14:59,476 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_High_Biomass_Alert.tif
2025-07-13 18:15:00,355 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Extreme_Biomass_Alert.tif
2025-07-13 18:15:01,239 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Ndci_Bloom.tif
2025-07-13 18:15:02,122 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Flh_Bloom.tif
2025-07-13 18:15:03,005 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Mci_Bloom.tif
2025-07-13 18:15:03,872 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Cyanobacteria_Bloom.tif
2025-07-13 18:15:05,418 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Ndci_Values.tif
2025-07-13 18:15:07,024 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Flh_Values.tif
2025-07-13 18:15:08,743 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_HAB_Mci_Values.tif
2025-07-13 18:15:08,928 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_WaterTypes_Legend.txt
2025-07-13 18:15:08,928 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 18:15:08,929 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 18:15:08,930 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 18:15:08,930 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 18:15:08,931 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407
2025-07-13 18:15:09,088 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407 ===
2025-07-13 18:15:09,089 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 79.1%
2025-07-13 18:15:09,089 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.02 - 84.33 g/m¬≥
2025-07-13 18:15:09,090 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.64 g/m¬≥
2025-07-13 18:15:09,156 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 18:15:09,179 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 168228 pixels (0.6%)
2025-07-13 18:15:09,201 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 4201672 pixels (16.2%)
2025-07-13 18:15:09,225 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 21627962 pixels (83.2%)
2025-07-13 18:15:09,249 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 6 pixels (0.0%)
2025-07-13 18:15:09,319 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 16493 pixels with bloom risk (1312 high risk)
2025-07-13 18:15:09,320 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 18:15:09,325 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20190915T113321_N0500_R080_T29TNF_20230501T125407_ProductIndex.txt
2025-07-13 18:15:09,328 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 18:15:09,329 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 18:15:09,329 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 18:15:09,330 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 18:15:09,417 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 18:15:09,418 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 23.2MB, status=completed
2025-07-13 18:15:09,419 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 79.1% coverage, mean=13.13
2025-07-13 18:15:09,420 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 79.1% coverage, mean=2.27
2025-07-13 18:15:09,421 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 79.1% coverage, mean=2.34
2025-07-13 18:15:09,421 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 79.1% coverage, mean=0.02
2025-07-13 18:15:09,422 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 79.1% coverage, mean=726.71
2025-07-13 18:15:09,422 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 79.1% coverage, mean=2.64
2025-07-13 18:15:09,423 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=2.23
2025-07-13 18:15:09,423 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.79
2025-07-13 18:15:09,424 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 79.1% coverage, mean=1.19
2025-07-13 18:15:09,424 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 79.1% coverage, mean=0.33
2025-07-13 18:15:09,425 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 79.1% coverage, mean=3.21
2025-07-13 18:15:09,426 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 79.1% coverage, mean=2.37
2025-07-13 18:15:09,427 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 79.1% coverage, mean=2.36
2025-07-13 18:15:09,427 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 79.1% coverage, mean=19.81
2025-07-13 18:15:09,428 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,429 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,429 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,430 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,430 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,431 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,432 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,432 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,433 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 79.1% coverage, mean=-0.14
2025-07-13 18:15:09,433 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,434 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 18:15:09,553 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 27/63 (42.9%), ETA: 497.4 minutes
2025-07-13 18:15:09,554 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 18:15:09,555 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 28/63: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702
2025-07-13 18:15:09,555 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 18:15:09,556 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 18:15:09,557 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702.zip
2025-07-13 18:15:09,558 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 18:15:09,558 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 18:15:09,559 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 18:15:09,561 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 18:20:29,959 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:20:29,960 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:20:29,960 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:20:29,961 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191002T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 18:20:29,962 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191002T112121_T29TNF_Subset_C2RCC.data
2025-07-13 18:20:29,962 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:20:29,963 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 18:20:29,964 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 18:20:29,964 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 18:20:29,965 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 18:20:29,965 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:20:29,966 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:20:29,967 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:20:29,967 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:20:29,968 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:20:29,969 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:20:29,969 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:20:29,970 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:20:29,970 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:20:29,971 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:20:29,971 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 18:20:29,972 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:20:29,973 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702.zip
2025-07-13 18:20:29,973 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191002T112121_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 18:20:29,974 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 18:20:29,974 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 18:20:29,975 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 18:20:29,976 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 18:20:29,976 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 18:20:29,977 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 18:20:30,173 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0902
2025-07-13 18:20:30,373 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.4568
2025-07-13 18:20:30,564 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.2631
2025-07-13 18:20:30,565 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 18:20:30,995 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25961652 valid pixels out of 25961652 processed
2025-07-13 18:20:32,423 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 18:20:32,600 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 79.0% coverage, mean=2.257 mg/m¬≥
2025-07-13 18:20:32,601 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 18:20:33,071 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25961652 valid pixels out of 25961652 processed
2025-07-13 18:20:34,469 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 18:20:34,628 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 79.0% coverage, mean=0.924 g/m¬≥
2025-07-13 18:20:34,655 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 18:20:34,656 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 18:20:34,662 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:20:34,662 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:20:34,663 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:20:34,663 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191002T112121_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 18:20:34,664 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191002T112121_T29TNF_Subset_C2RCC.data
2025-07-13 18:20:34,665 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:20:34,666 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 18:20:34,666 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 18:20:34,667 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 18:20:34,667 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 18:20:34,668 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:20:34,669 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:20:34,669 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:20:34,670 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:20:34,671 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:20:34,671 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:20:34,672 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:20:34,672 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:20:34,673 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:20:34,673 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:20:34,674 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 18:20:34,675 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 18:20:34,675 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 18:20:34,676 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 18:20:34,676 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:20:34,677 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 18:20:34,677 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 18:20:34,678 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702.zip
2025-07-13 18:20:34,679 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 18:20:34,679 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 18:20:34,680 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 18:20:34,680 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 18:20:34,681 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 18:20:34,682 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 18:20:34,682 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 18:20:34,683 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 18:20:34,684 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702.zip
2025-07-13 18:20:34,685 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 18:20:35,493 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 18:20:36,047 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25961652 valid pixels with corrected Jiang algorithm
2025-07-13 18:28:41,428 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 18:28:41,428 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25961652/32874120 (79.0%)
2025-07-13 18:28:41,491 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 18:28:41,514 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 12410229 pixels (47.8%)
2025-07-13 18:28:41,536 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 9141215 pixels (35.2%)
2025-07-13 18:28:41,559 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 4410198 pixels (17.0%)
2025-07-13 18:28:41,581 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 10 pixels (0.0%)
2025-07-13 18:28:41,613 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 18:28:41,614 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 18:28:41,615 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 18:28:41,616 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 18:28:41,952 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25961652 pixels
2025-07-13 18:28:42,069 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 11.75 m
2025-07-13 18:28:42,187 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.723
2025-07-13 18:28:42,188 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 18:28:42,188 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:28:42,321 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:28:42,363 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 18:28:42,684 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25961652 pixels
2025-07-13 18:28:42,685 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 18:28:42,961 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 18:28:42,962 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 18:28:43,321 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 18:28:43,656 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 18:28:43,657 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 18:28:43,657 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 234 pixels (0.0%)
2025-07-13 18:28:43,658 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 8900 pixels (0.0%)
2025-07-13 18:28:43,658 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 2136 pixels (0.0%)
2025-07-13 18:28:43,665 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 18:28:43,666 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 18:28:43,688 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 18:28:43,691 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 18:28:43,691 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 18:28:43,692 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 18:28:45,084 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_Absorption.tif
2025-07-13 18:28:46,664 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_Backscattering.tif
2025-07-13 18:28:47,524 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_ReferenceBand.tif
2025-07-13 18:28:49,098 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_TSS.tif
2025-07-13 18:28:50,040 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_WaterTypes.tif
2025-07-13 18:28:50,899 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Jiang_ValidMask.tif
2025-07-13 18:28:52,632 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Secchidepth.tif
2025-07-13 18:28:54,305 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Clarityindex.tif
2025-07-13 18:28:56,008 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Euphoticdepth.tif
2025-07-13 18:28:57,725 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Diffuseattenuation.tif
2025-07-13 18:28:59,437 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Beamattenuation.tif
2025-07-13 18:29:01,044 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_Clarity_Turbidityproxy.tif
2025-07-13 18:29:01,770 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Probability.tif
2025-07-13 18:29:02,640 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Risk_Level.tif
2025-07-13 18:29:03,490 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_High_Biomass_Alert.tif
2025-07-13 18:29:04,339 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Extreme_Biomass_Alert.tif
2025-07-13 18:29:05,192 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Ndci_Bloom.tif
2025-07-13 18:29:06,041 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Flh_Bloom.tif
2025-07-13 18:29:06,894 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Mci_Bloom.tif
2025-07-13 18:29:07,762 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Cyanobacteria_Bloom.tif
2025-07-13 18:29:09,375 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Ndci_Values.tif
2025-07-13 18:29:11,059 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Flh_Values.tif
2025-07-13 18:29:12,756 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_HAB_Mci_Values.tif
2025-07-13 18:29:12,941 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_WaterTypes_Legend.txt
2025-07-13 18:29:12,942 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 18:29:12,943 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 18:29:12,943 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 18:29:12,944 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 18:29:12,944 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702
2025-07-13 18:29:13,101 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702 ===
2025-07-13 18:29:13,102 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 79.0%
2025-07-13 18:29:13,103 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 85.32 g/m¬≥
2025-07-13 18:29:13,104 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.87 g/m¬≥
2025-07-13 18:29:13,161 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 18:29:13,184 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 12410229 pixels (47.8%)
2025-07-13 18:29:13,206 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 9141215 pixels (35.2%)
2025-07-13 18:29:13,229 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 4410198 pixels (17.0%)
2025-07-13 18:29:13,251 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 10 pixels (0.0%)
2025-07-13 18:29:13,321 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 11270 pixels with bloom risk (234 high risk)
2025-07-13 18:29:13,322 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 18:29:13,333 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191002T112121_N0500_R037_T29TNF_20230612T153702_ProductIndex.txt
2025-07-13 18:29:13,337 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 18:29:13,337 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 18:29:13,338 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 18:29:13,339 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 18:29:13,437 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 18:29:13,449 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 18:29:13,450 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 79.0% coverage, mean=2.26
2025-07-13 18:29:13,451 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 79.0% coverage, mean=0.92
2025-07-13 18:29:13,451 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 79.0% coverage, mean=0.67
2025-07-13 18:29:13,452 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 79.0% coverage, mean=0.01
2025-07-13 18:29:13,453 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 79.0% coverage, mean=627.55
2025-07-13 18:29:13,453 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 79.0% coverage, mean=0.87
2025-07-13 18:29:13,454 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.34
2025-07-13 18:29:13,455 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.79
2025-07-13 18:29:13,455 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 79.0% coverage, mean=11.75
2025-07-13 18:29:13,456 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 79.0% coverage, mean=0.72
2025-07-13 18:29:13,456 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 79.0% coverage, mean=31.82
2025-07-13 18:29:13,457 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 79.0% coverage, mean=0.68
2025-07-13 18:29:13,458 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 79.0% coverage, mean=0.68
2025-07-13 18:29:13,458 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 79.0% coverage, mean=7.09
2025-07-13 18:29:13,459 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,460 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,461 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,461 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,462 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,462 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,463 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,464 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,464 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 79.0% coverage, mean=-0.24
2025-07-13 18:29:13,465 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,466 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 18:29:13,576 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 28/63 (44.4%), ETA: 483.9 minutes
2025-07-13 18:29:13,577 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 18:29:13,578 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 29/63: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254
2025-07-13 18:29:13,578 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 18:29:13,579 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 18:29:13,580 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254.zip
2025-07-13 18:29:13,580 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 18:29:13,581 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 18:29:13,581 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 18:29:13,583 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 18:34:28,061 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:34:28,062 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:34:28,062 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:34:28,063 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191005T113321_T29TNF_Subset_C2RCC.dim (23.3 MB)
2025-07-13 18:34:28,064 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191005T113321_T29TNF_Subset_C2RCC.data
2025-07-13 18:34:28,064 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:34:28,065 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 18:34:28,066 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 18:34:28,066 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 18:34:28,067 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 18:34:28,067 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:34:28,068 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:34:28,069 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:34:28,069 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:34:28,070 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:34:28,070 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:34:28,071 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:34:28,072 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:34:28,072 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:34:28,073 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:34:28,074 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 18:34:28,074 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:34:28,075 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254.zip
2025-07-13 18:34:28,076 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191005T113321_T29TNF_Subset_C2RCC.dim (23.3MB)
2025-07-13 18:34:28,076 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 18:34:28,077 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 18:34:28,077 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 18:34:28,078 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 18:34:28,079 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 18:34:28,079 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 18:34:28,276 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.3564
2025-07-13 18:34:28,474 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.8151
2025-07-13 18:34:28,676 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.4930
2025-07-13 18:34:28,677 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 18:34:29,135 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27091225 valid pixels out of 27091225 processed
2025-07-13 18:34:30,618 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 18:34:30,788 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.4% coverage, mean=8.857 mg/m¬≥
2025-07-13 18:34:30,789 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 18:34:31,250 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27091225 valid pixels out of 27091225 processed
2025-07-13 18:34:32,694 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 18:34:32,862 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.4% coverage, mean=1.594 g/m¬≥
2025-07-13 18:34:32,893 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 18:34:32,894 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 18:34:32,900 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:34:32,900 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:34:32,901 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:34:32,902 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191005T113321_T29TNF_Subset_C2RCC.dim (23.3 MB)
2025-07-13 18:34:32,902 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191005T113321_T29TNF_Subset_C2RCC.data
2025-07-13 18:34:32,903 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:34:32,904 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 18:34:32,904 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 18:34:32,905 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 18:34:32,906 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 18:34:32,906 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:34:32,907 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:34:32,907 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:34:32,908 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:34:32,909 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:34:32,909 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:34:32,910 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:34:32,911 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:34:32,911 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:34:32,912 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:34:32,912 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 18:34:32,913 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 18:34:32,914 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 18:34:32,914 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 18:34:32,915 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:34:32,915 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 18:34:32,916 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 18:34:32,916 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254.zip
2025-07-13 18:34:32,917 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 18:34:32,918 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 18:34:32,918 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 18:34:32,919 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 18:34:32,920 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 18:34:32,920 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 18:34:32,921 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 18:34:32,921 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 18:34:32,922 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254.zip
2025-07-13 18:34:32,924 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 18:34:33,729 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 18:34:34,271 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27091225 valid pixels with corrected Jiang algorithm
2025-07-13 18:42:43,762 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 18:42:43,763 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27091225/32874120 (82.4%)
2025-07-13 18:42:43,824 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 18:42:43,848 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 1392271 pixels (5.1%)
2025-07-13 18:42:43,873 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 9989776 pixels (36.9%)
2025-07-13 18:42:43,897 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 15709151 pixels (58.0%)
2025-07-13 18:42:43,920 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 18:42:43,954 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 18:42:43,954 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 18:42:43,955 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 18:42:43,955 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 18:42:44,303 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27091225 pixels
2025-07-13 18:42:44,431 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 2.59 m
2025-07-13 18:42:44,549 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.444
2025-07-13 18:42:44,550 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 18:42:44,550 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:42:44,688 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:42:44,731 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 18:42:45,047 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27091225 pixels
2025-07-13 18:42:45,047 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 18:42:45,341 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 18:42:45,342 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 18:42:45,691 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 18:42:46,012 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 18:42:46,013 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 18:42:46,013 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 336 pixels (0.0%)
2025-07-13 18:42:46,014 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 13846 pixels (0.0%)
2025-07-13 18:42:46,015 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 4182 pixels (0.0%)
2025-07-13 18:42:46,022 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 18:42:46,022 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 18:42:46,045 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 18:42:46,054 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 18:42:46,055 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 18:42:46,055 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 18:42:47,288 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_Absorption.tif
2025-07-13 18:42:48,897 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_Backscattering.tif
2025-07-13 18:42:49,766 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_ReferenceBand.tif
2025-07-13 18:42:51,369 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_TSS.tif
2025-07-13 18:42:52,339 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_WaterTypes.tif
2025-07-13 18:42:53,189 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Jiang_ValidMask.tif
2025-07-13 18:42:54,986 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Secchidepth.tif
2025-07-13 18:42:56,662 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Clarityindex.tif
2025-07-13 18:42:58,444 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Euphoticdepth.tif
2025-07-13 18:43:00,296 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Diffuseattenuation.tif
2025-07-13 18:43:02,150 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Beamattenuation.tif
2025-07-13 18:43:03,779 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_Clarity_Turbidityproxy.tif
2025-07-13 18:43:04,505 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Probability.tif
2025-07-13 18:43:05,341 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Risk_Level.tif
2025-07-13 18:43:06,198 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_High_Biomass_Alert.tif
2025-07-13 18:43:07,072 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Extreme_Biomass_Alert.tif
2025-07-13 18:43:07,929 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Ndci_Bloom.tif
2025-07-13 18:43:08,792 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Flh_Bloom.tif
2025-07-13 18:43:09,633 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Mci_Bloom.tif
2025-07-13 18:43:10,486 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Cyanobacteria_Bloom.tif
2025-07-13 18:43:12,067 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Ndci_Values.tif
2025-07-13 18:43:13,762 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Flh_Values.tif
2025-07-13 18:43:15,575 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_HAB_Mci_Values.tif
2025-07-13 18:43:15,767 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_WaterTypes_Legend.txt
2025-07-13 18:43:15,768 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 18:43:15,768 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 18:43:15,769 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 18:43:15,770 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 18:43:15,770 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254
2025-07-13 18:43:15,935 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254 ===
2025-07-13 18:43:15,935 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.4%
2025-07-13 18:43:15,936 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 86.04 g/m¬≥
2025-07-13 18:43:15,937 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.80 g/m¬≥
2025-07-13 18:43:15,998 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 18:43:16,022 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 1392271 pixels (5.1%)
2025-07-13 18:43:16,047 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 9989776 pixels (36.9%)
2025-07-13 18:43:16,071 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 15709151 pixels (58.0%)
2025-07-13 18:43:16,095 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 27 pixels (0.0%)
2025-07-13 18:43:16,167 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 18364 pixels with bloom risk (336 high risk)
2025-07-13 18:43:16,168 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 18:43:16,180 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191005T113321_N0500_R080_T29TNF_20230610T223254_ProductIndex.txt
2025-07-13 18:43:16,184 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 18:43:16,184 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 18:43:16,185 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 18:43:16,186 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 18:43:16,292 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 18:43:16,293 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 23.3MB, status=completed
2025-07-13 18:43:16,293 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.4% coverage, mean=8.86
2025-07-13 18:43:16,294 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.4% coverage, mean=1.59
2025-07-13 18:43:16,294 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.4% coverage, mean=1.77
2025-07-13 18:43:16,295 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.4% coverage, mean=0.01
2025-07-13 18:43:16,296 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.4% coverage, mean=703.09
2025-07-13 18:43:16,296 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.4% coverage, mean=1.80
2025-07-13 18:43:16,297 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=2.08
2025-07-13 18:43:16,297 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 18:43:16,298 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.4% coverage, mean=2.59
2025-07-13 18:43:16,298 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.4% coverage, mean=0.44
2025-07-13 18:43:16,299 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.4% coverage, mean=7.03
2025-07-13 18:43:16,300 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.4% coverage, mean=1.79
2025-07-13 18:43:16,300 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.4% coverage, mean=1.78
2025-07-13 18:43:16,301 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.4% coverage, mean=13.84
2025-07-13 18:43:16,301 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,302 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,303 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,303 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,304 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,305 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,305 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,306 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,306 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.4% coverage, mean=-0.19
2025-07-13 18:43:16,307 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,308 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 18:43:16,444 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 29/63 (46.0%), ETA: 470.3 minutes
2025-07-13 18:43:16,445 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 18:43:16,446 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 30/63: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217
2025-07-13 18:43:16,446 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 18:43:16,447 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 18:43:16,448 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217.zip
2025-07-13 18:43:16,448 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 18:43:16,449 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 18:43:16,449 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 18:43:16,451 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 18:48:39,098 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:48:39,098 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:48:39,099 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:48:39,100 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191022T112121_T29TNF_Subset_C2RCC.dim (25.8 MB)
2025-07-13 18:48:39,101 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191022T112121_T29TNF_Subset_C2RCC.data
2025-07-13 18:48:39,101 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:48:39,102 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 18:48:39,102 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 18:48:39,103 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 18:48:39,103 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 18:48:39,104 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:48:39,105 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:48:39,105 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:48:39,106 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:48:39,106 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:48:39,107 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:48:39,108 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:48:39,108 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:48:39,109 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:48:39,109 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:48:39,110 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 18:48:39,111 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:48:39,111 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217.zip
2025-07-13 18:48:39,112 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191022T112121_T29TNF_Subset_C2RCC.dim (25.8MB)
2025-07-13 18:48:39,113 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.4 minutes
2025-07-13 18:48:39,113 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 18:48:39,114 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 18:48:39,114 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 18:48:39,115 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 18:48:39,115 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 18:48:39,312 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0232
2025-07-13 18:48:39,505 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.4865
2025-07-13 18:48:39,697 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.1297
2025-07-13 18:48:39,698 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 18:48:40,137 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27060097 valid pixels out of 27060097 processed
2025-07-13 18:48:41,593 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 18:48:41,764 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.3% coverage, mean=0.538 mg/m¬≥
2025-07-13 18:48:41,765 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 18:48:42,242 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27060097 valid pixels out of 27060097 processed
2025-07-13 18:48:43,733 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 18:48:43,905 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.3% coverage, mean=0.780 g/m¬≥
2025-07-13 18:48:43,936 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 18:48:43,937 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 18:48:43,943 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 18:48:43,943 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 18:48:43,944 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 18:48:43,945 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191022T112121_T29TNF_Subset_C2RCC.dim (25.8 MB)
2025-07-13 18:48:43,945 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191022T112121_T29TNF_Subset_C2RCC.data
2025-07-13 18:48:43,946 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 18:48:43,947 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 18:48:43,947 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 18:48:43,948 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 18:48:43,948 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 18:48:43,949 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 18:48:43,950 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 18:48:43,950 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 18:48:43,951 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 18:48:43,951 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 18:48:43,952 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 18:48:43,953 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 18:48:43,953 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 18:48:43,954 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 18:48:43,954 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 18:48:43,955 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 18:48:43,955 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 18:48:43,956 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 18:48:43,956 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 18:48:43,957 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 18:48:43,957 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 18:48:43,959 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 18:48:43,959 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217.zip
2025-07-13 18:48:43,959 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 18:48:43,960 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 18:48:43,960 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 18:48:43,961 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 18:48:43,962 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 18:48:43,962 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 18:48:43,963 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 18:48:43,963 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 18:48:43,964 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217.zip
2025-07-13 18:48:43,966 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 18:48:44,788 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 18:48:45,348 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27060097 valid pixels with corrected Jiang algorithm
2025-07-13 18:57:23,937 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 18:57:23,938 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27060097/32874120 (82.3%)
2025-07-13 18:57:23,997 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 18:57:24,022 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 22483933 pixels (83.1%)
2025-07-13 18:57:24,046 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 3973172 pixels (14.7%)
2025-07-13 18:57:24,070 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 602987 pixels (2.2%)
2025-07-13 18:57:24,093 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 5 pixels (0.0%)
2025-07-13 18:57:24,126 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 18:57:24,127 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 18:57:24,128 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 18:57:24,128 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 18:57:24,467 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27060097 pixels
2025-07-13 18:57:24,584 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 17.27 m
2025-07-13 18:57:24,702 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.869
2025-07-13 18:57:24,702 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 18:57:24,703 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:57:24,841 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 18:57:24,884 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 18:57:25,213 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27060097 pixels
2025-07-13 18:57:25,214 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 18:57:25,493 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 18:57:25,494 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 18:57:25,851 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 18:57:26,185 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 18:57:26,186 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 18:57:26,186 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 52 pixels (0.0%)
2025-07-13 18:57:26,187 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 4070 pixels (0.0%)
2025-07-13 18:57:26,188 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1148 pixels (0.0%)
2025-07-13 18:57:26,194 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 18:57:26,195 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 18:57:26,217 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 18:57:26,219 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 18:57:26,220 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 18:57:26,221 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 18:57:27,713 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_Absorption.tif
2025-07-13 18:57:29,291 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_Backscattering.tif
2025-07-13 18:57:30,159 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_ReferenceBand.tif
2025-07-13 18:57:31,747 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_TSS.tif
2025-07-13 18:57:32,653 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_WaterTypes.tif
2025-07-13 18:57:33,510 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Jiang_ValidMask.tif
2025-07-13 18:57:35,244 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Secchidepth.tif
2025-07-13 18:57:36,948 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Clarityindex.tif
2025-07-13 18:57:38,673 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Euphoticdepth.tif
2025-07-13 18:57:40,428 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Diffuseattenuation.tif
2025-07-13 18:57:42,169 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Beamattenuation.tif
2025-07-13 18:57:43,741 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_Clarity_Turbidityproxy.tif
2025-07-13 18:57:44,470 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Probability.tif
2025-07-13 18:57:45,311 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Risk_Level.tif
2025-07-13 18:57:46,152 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_High_Biomass_Alert.tif
2025-07-13 18:57:46,998 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Extreme_Biomass_Alert.tif
2025-07-13 18:57:47,849 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Ndci_Bloom.tif
2025-07-13 18:57:48,705 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Flh_Bloom.tif
2025-07-13 18:57:49,573 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Mci_Bloom.tif
2025-07-13 18:57:50,440 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Cyanobacteria_Bloom.tif
2025-07-13 18:57:52,105 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Ndci_Values.tif
2025-07-13 18:57:53,826 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Flh_Values.tif
2025-07-13 18:57:55,561 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_HAB_Mci_Values.tif
2025-07-13 18:57:55,747 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_WaterTypes_Legend.txt
2025-07-13 18:57:55,748 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 18:57:55,749 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 18:57:55,750 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 18:57:55,750 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 18:57:55,751 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217
2025-07-13 18:57:55,913 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217 ===
2025-07-13 18:57:55,914 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.3%
2025-07-13 18:57:55,915 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 88.00 g/m¬≥
2025-07-13 18:57:55,915 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 0.59 g/m¬≥
2025-07-13 18:57:55,977 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 18:57:56,002 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 22483933 pixels (83.1%)
2025-07-13 18:57:56,028 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 3973172 pixels (14.7%)
2025-07-13 18:57:56,052 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 602987 pixels (2.2%)
2025-07-13 18:57:56,077 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 5 pixels (0.0%)
2025-07-13 18:57:56,150 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 5270 pixels with bloom risk (52 high risk)
2025-07-13 18:57:56,151 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 18:57:56,162 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191022T112121_N0500_R037_T29TNF_20230615T041217_ProductIndex.txt
2025-07-13 18:57:56,166 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 18:57:56,166 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 18:57:56,167 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 18:57:56,168 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 18:57:56,258 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 18:57:56,259 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 25.8MB, status=completed
2025-07-13 18:57:56,260 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.3% coverage, mean=0.54
2025-07-13 18:57:56,260 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.3% coverage, mean=0.78
2025-07-13 18:57:56,261 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.3% coverage, mean=0.20
2025-07-13 18:57:56,262 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.3% coverage, mean=0.01
2025-07-13 18:57:56,263 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.3% coverage, mean=579.43
2025-07-13 18:57:56,263 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.3% coverage, mean=0.59
2025-07-13 18:57:56,264 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.98
2025-07-13 18:57:56,264 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 18:57:56,265 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.3% coverage, mean=17.27
2025-07-13 18:57:56,265 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.3% coverage, mean=0.87
2025-07-13 18:57:56,266 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.3% coverage, mean=46.79
2025-07-13 18:57:56,267 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.3% coverage, mean=0.21
2025-07-13 18:57:56,267 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.3% coverage, mean=0.20
2025-07-13 18:57:56,268 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.3% coverage, mean=5.42
2025-07-13 18:57:56,269 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,269 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,270 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,271 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,271 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,272 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,272 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,273 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,273 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.3% coverage, mean=-0.25
2025-07-13 18:57:56,274 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 18:57:56,275 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=-0.00
2025-07-13 18:57:56,386 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 30/63 (47.6%), ETA: 457.4 minutes
2025-07-13 18:57:56,387 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 18:57:56,388 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 31/63: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623
2025-07-13 18:57:56,388 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 18:57:56,389 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 18:57:56,390 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623.zip
2025-07-13 18:57:56,391 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 18:57:56,391 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 18:57:56,392 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 18:57:56,394 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 19:03:13,904 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:03:13,905 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:03:13,905 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:03:13,906 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191025T113321_T29TNF_Subset_C2RCC.dim (41.0 MB)
2025-07-13 19:03:13,907 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191025T113321_T29TNF_Subset_C2RCC.data
2025-07-13 19:03:13,907 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:03:13,908 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 19:03:13,909 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 19:03:13,909 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 19:03:13,910 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 19:03:13,910 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:03:13,911 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:03:13,911 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:03:13,912 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:03:13,913 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:03:13,914 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:03:13,914 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:03:13,915 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:03:13,915 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:03:13,916 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:03:13,916 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 19:03:13,917 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:03:13,918 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623.zip
2025-07-13 19:03:13,918 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191025T113321_T29TNF_Subset_C2RCC.dim (41.0MB)
2025-07-13 19:03:13,919 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 19:03:13,919 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 19:03:13,920 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 19:03:13,920 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 19:03:13,921 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 19:03:13,922 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 19:03:14,112 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.4669
2025-07-13 19:03:14,305 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.5200
2025-07-13 19:03:14,495 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.6612
2025-07-13 19:03:14,496 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 19:03:14,969 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27083704 valid pixels out of 27083704 processed
2025-07-13 19:03:16,512 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 19:03:16,689 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.4% coverage, mean=11.727 mg/m¬≥
2025-07-13 19:03:16,690 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 19:03:17,194 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27083704 valid pixels out of 27083704 processed
2025-07-13 19:03:18,647 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 19:03:18,811 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.4% coverage, mean=1.448 g/m¬≥
2025-07-13 19:03:18,839 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 19:03:18,840 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 19:03:18,845 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:03:18,846 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:03:18,847 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:03:18,847 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191025T113321_T29TNF_Subset_C2RCC.dim (41.0 MB)
2025-07-13 19:03:18,848 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191025T113321_T29TNF_Subset_C2RCC.data
2025-07-13 19:03:18,849 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:03:18,849 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 19:03:18,850 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 19:03:18,850 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 19:03:18,851 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 19:03:18,852 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:03:18,852 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:03:18,853 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:03:18,854 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:03:18,854 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:03:18,855 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:03:18,855 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:03:18,856 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:03:18,857 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:03:18,857 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:03:18,858 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 19:03:18,858 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 19:03:18,859 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 19:03:18,860 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 19:03:18,860 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:03:18,861 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 19:03:18,861 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 19:03:18,862 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623.zip
2025-07-13 19:03:18,862 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 19:03:18,863 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 19:03:18,863 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 19:03:18,864 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 19:03:18,865 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 19:03:18,865 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 19:03:18,866 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 19:03:18,867 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 19:03:18,868 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623.zip
2025-07-13 19:03:18,869 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 19:03:19,661 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 19:03:20,200 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27083704 valid pixels with corrected Jiang algorithm
2025-07-13 19:11:27,789 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 19:11:27,790 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27083704/32874120 (82.4%)
2025-07-13 19:11:27,849 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 19:11:27,872 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 944177 pixels (3.5%)
2025-07-13 19:11:27,896 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 6025258 pixels (22.2%)
2025-07-13 19:11:27,919 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 20114267 pixels (74.3%)
2025-07-13 19:11:27,942 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 19:11:27,975 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 19:11:27,975 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 19:11:27,976 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 19:11:27,977 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 19:11:28,311 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27083704 pixels
2025-07-13 19:11:28,429 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 1.89 m
2025-07-13 19:11:28,549 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.378
2025-07-13 19:11:28,550 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 19:11:28,551 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:11:28,685 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:11:28,728 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 19:11:29,038 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27083704 pixels
2025-07-13 19:11:29,039 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 19:11:29,317 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 19:11:29,318 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 19:11:29,675 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 19:11:29,997 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 19:11:29,998 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 19:11:29,998 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 31 pixels (0.0%)
2025-07-13 19:11:29,999 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 1884 pixels (0.0%)
2025-07-13 19:11:30,000 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 813 pixels (0.0%)
2025-07-13 19:11:30,006 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 19:11:30,007 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 19:11:30,029 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 19:11:30,031 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 19:11:30,032 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 19:11:30,033 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 19:11:31,081 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_Absorption.tif
2025-07-13 19:11:32,700 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_Backscattering.tif
2025-07-13 19:11:33,582 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_ReferenceBand.tif
2025-07-13 19:11:35,197 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_TSS.tif
2025-07-13 19:11:36,141 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_WaterTypes.tif
2025-07-13 19:11:37,010 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Jiang_ValidMask.tif
2025-07-13 19:11:38,798 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Secchidepth.tif
2025-07-13 19:11:40,459 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Clarityindex.tif
2025-07-13 19:11:42,254 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Euphoticdepth.tif
2025-07-13 19:11:44,072 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Diffuseattenuation.tif
2025-07-13 19:11:45,857 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Beamattenuation.tif
2025-07-13 19:11:47,500 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_Clarity_Turbidityproxy.tif
2025-07-13 19:11:48,232 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Probability.tif
2025-07-13 19:11:49,089 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Risk_Level.tif
2025-07-13 19:11:49,962 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_High_Biomass_Alert.tif
2025-07-13 19:11:50,843 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Extreme_Biomass_Alert.tif
2025-07-13 19:11:51,754 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Ndci_Bloom.tif
2025-07-13 19:11:52,628 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Flh_Bloom.tif
2025-07-13 19:11:53,507 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Mci_Bloom.tif
2025-07-13 19:11:54,372 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Cyanobacteria_Bloom.tif
2025-07-13 19:11:55,996 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Ndci_Values.tif
2025-07-13 19:11:57,713 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Flh_Values.tif
2025-07-13 19:11:59,543 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_HAB_Mci_Values.tif
2025-07-13 19:11:59,729 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_WaterTypes_Legend.txt
2025-07-13 19:11:59,730 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 19:11:59,731 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 19:11:59,732 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 19:11:59,733 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 19:11:59,733 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623
2025-07-13 19:11:59,899 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623 ===
2025-07-13 19:11:59,900 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.4%
2025-07-13 19:11:59,901 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 86.89 g/m¬≥
2025-07-13 19:11:59,902 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.60 g/m¬≥
2025-07-13 19:11:59,963 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 19:11:59,987 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 944177 pixels (3.5%)
2025-07-13 19:12:00,011 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 6025258 pixels (22.2%)
2025-07-13 19:12:00,036 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 20114267 pixels (74.3%)
2025-07-13 19:12:00,061 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 19:12:00,132 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 2728 pixels with bloom risk (31 high risk)
2025-07-13 19:12:00,133 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 19:12:00,145 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191025T113321_N0500_R080_T29TNF_20230713T062623_ProductIndex.txt
2025-07-13 19:12:00,149 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 19:12:00,149 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 19:12:00,150 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 19:12:00,151 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 19:12:00,242 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 19:12:00,243 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 41.0MB, status=completed
2025-07-13 19:12:00,243 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.4% coverage, mean=11.73
2025-07-13 19:12:00,244 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.4% coverage, mean=1.45
2025-07-13 19:12:00,245 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.4% coverage, mean=2.13
2025-07-13 19:12:00,245 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.4% coverage, mean=0.01
2025-07-13 19:12:00,246 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.4% coverage, mean=717.04
2025-07-13 19:12:00,247 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.4% coverage, mean=1.60
2025-07-13 19:12:00,248 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=2.23
2025-07-13 19:12:00,248 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.82
2025-07-13 19:12:00,249 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.4% coverage, mean=1.89
2025-07-13 19:12:00,250 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.4% coverage, mean=0.38
2025-07-13 19:12:00,250 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.4% coverage, mean=5.13
2025-07-13 19:12:00,250 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.4% coverage, mean=2.15
2025-07-13 19:12:00,251 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.4% coverage, mean=2.14
2025-07-13 19:12:00,251 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.4% coverage, mean=12.05
2025-07-13 19:12:00,252 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,253 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,254 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,254 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,255 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,255 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,256 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,257 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,257 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.4% coverage, mean=-0.17
2025-07-13 19:12:00,258 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,259 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 19:12:00,375 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 31/63 (49.2%), ETA: 443.8 minutes
2025-07-13 19:12:00,377 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 19:12:00,378 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 32/63: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450
2025-07-13 19:12:00,378 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 19:12:00,379 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 19:12:00,380 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450.zip
2025-07-13 19:12:00,380 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 19:12:00,381 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 19:12:00,382 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 19:12:00,384 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 19:17:15,501 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:17:15,502 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:17:15,503 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:17:15,504 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191121T112401_T29TNF_Subset_C2RCC.dim (25.5 MB)
2025-07-13 19:17:15,504 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191121T112401_T29TNF_Subset_C2RCC.data
2025-07-13 19:17:15,505 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:17:15,506 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 19:17:15,507 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 19:17:15,507 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 19:17:15,508 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 19:17:15,508 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:17:15,509 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:17:15,509 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:17:15,510 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:17:15,511 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:17:15,511 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:17:15,512 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:17:15,513 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:17:15,513 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:17:15,514 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:17:15,515 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 19:17:15,515 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:17:15,516 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450.zip
2025-07-13 19:17:15,516 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191121T112401_T29TNF_Subset_C2RCC.dim (25.5MB)
2025-07-13 19:17:15,517 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 19:17:15,518 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 19:17:15,518 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 19:17:15,519 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 19:17:15,519 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 19:17:15,520 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 19:17:15,714 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0509
2025-07-13 19:17:15,904 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.9539
2025-07-13 19:17:16,095 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.4446
2025-07-13 19:17:16,096 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 19:17:16,504 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 23721830 valid pixels out of 23721830 processed
2025-07-13 19:17:17,864 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 19:17:18,027 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 72.2% coverage, mean=1.399 mg/m¬≥
2025-07-13 19:17:18,028 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 19:17:18,449 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 23721830 valid pixels out of 23721830 processed
2025-07-13 19:17:19,795 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 19:17:19,946 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 72.2% coverage, mean=1.887 g/m¬≥
2025-07-13 19:17:19,975 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 19:17:19,976 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 19:17:19,981 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:17:19,982 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:17:19,982 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:17:19,984 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191121T112401_T29TNF_Subset_C2RCC.dim (25.5 MB)
2025-07-13 19:17:19,984 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191121T112401_T29TNF_Subset_C2RCC.data
2025-07-13 19:17:19,985 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:17:19,985 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 19:17:19,986 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 19:17:19,986 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 19:17:19,987 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 19:17:19,988 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:17:19,988 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:17:19,989 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:17:19,989 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:17:19,990 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:17:19,991 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:17:19,992 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:17:19,992 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:17:19,993 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:17:19,993 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:17:19,994 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 19:17:19,994 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 19:17:19,995 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 19:17:19,996 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 19:17:19,996 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:17:19,997 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 19:17:19,998 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 19:17:19,998 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450.zip
2025-07-13 19:17:19,999 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 19:17:19,999 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 19:17:20,000 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 19:17:20,001 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 19:17:20,001 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 19:17:20,002 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 19:17:20,003 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 19:17:20,003 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 19:17:20,004 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450.zip
2025-07-13 19:17:20,006 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 19:17:20,771 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 19:17:21,297 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 23721830 valid pixels with corrected Jiang algorithm
2025-07-13 19:24:51,957 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 19:24:51,958 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 23721830/32874120 (72.2%)
2025-07-13 19:24:52,016 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 19:24:52,038 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 16764189 pixels (70.7%)
2025-07-13 19:24:52,061 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 5325408 pixels (22.4%)
2025-07-13 19:24:52,084 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1632226 pixels (6.9%)
2025-07-13 19:24:52,107 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 19:24:52,140 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 19:24:52,142 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 19:24:52,142 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 19:24:52,143 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 19:24:52,483 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 23721830 pixels
2025-07-13 19:24:52,606 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 16.05 m
2025-07-13 19:24:52,727 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.816
2025-07-13 19:24:52,728 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 19:24:52,729 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:24:52,862 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:24:52,905 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 19:24:53,227 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 23721830 pixels
2025-07-13 19:24:53,228 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 19:24:53,505 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 19:24:53,506 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 19:24:53,849 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 19:24:54,186 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 19:24:54,187 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 19:24:54,188 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 372 pixels (0.0%)
2025-07-13 19:24:54,189 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 6792 pixels (0.0%)
2025-07-13 19:24:54,189 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 4363 pixels (0.0%)
2025-07-13 19:24:54,196 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 19:24:54,197 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 19:24:54,219 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 19:24:54,221 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 19:24:54,222 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 19:24:54,222 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 19:24:55,573 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_Absorption.tif
2025-07-13 19:24:57,075 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_Backscattering.tif
2025-07-13 19:24:57,934 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_ReferenceBand.tif
2025-07-13 19:24:59,431 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_TSS.tif
2025-07-13 19:25:00,315 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_WaterTypes.tif
2025-07-13 19:25:01,204 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Jiang_ValidMask.tif
2025-07-13 19:25:02,879 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Secchidepth.tif
2025-07-13 19:25:04,509 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Clarityindex.tif
2025-07-13 19:25:06,093 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Euphoticdepth.tif
2025-07-13 19:25:07,710 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Diffuseattenuation.tif
2025-07-13 19:25:09,326 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Beamattenuation.tif
2025-07-13 19:25:10,801 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_Clarity_Turbidityproxy.tif
2025-07-13 19:25:11,506 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Probability.tif
2025-07-13 19:25:12,350 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Risk_Level.tif
2025-07-13 19:25:13,201 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_High_Biomass_Alert.tif
2025-07-13 19:25:14,051 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Extreme_Biomass_Alert.tif
2025-07-13 19:25:14,914 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Ndci_Bloom.tif
2025-07-13 19:25:15,795 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Flh_Bloom.tif
2025-07-13 19:25:16,671 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Mci_Bloom.tif
2025-07-13 19:25:17,515 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Cyanobacteria_Bloom.tif
2025-07-13 19:25:19,074 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Ndci_Values.tif
2025-07-13 19:25:20,658 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Flh_Values.tif
2025-07-13 19:25:22,269 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_HAB_Mci_Values.tif
2025-07-13 19:25:22,462 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_WaterTypes_Legend.txt
2025-07-13 19:25:22,463 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 19:25:22,464 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 19:25:22,464 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 19:25:22,465 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 19:25:22,466 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450
2025-07-13 19:25:22,615 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450 ===
2025-07-13 19:25:22,616 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 72.2%
2025-07-13 19:25:22,616 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 91.09 g/m¬≥
2025-07-13 19:25:22,617 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.07 g/m¬≥
2025-07-13 19:25:22,672 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 19:25:22,693 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 16764189 pixels (70.7%)
2025-07-13 19:25:22,714 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 5325408 pixels (22.4%)
2025-07-13 19:25:22,736 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1632226 pixels (6.9%)
2025-07-13 19:25:22,758 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 7 pixels (0.0%)
2025-07-13 19:25:22,831 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 11527 pixels with bloom risk (372 high risk)
2025-07-13 19:25:22,831 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 19:25:22,842 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191121T112401_N0500_R037_T29TNF_20230614T042450_ProductIndex.txt
2025-07-13 19:25:22,845 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 19:25:22,846 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 19:25:22,846 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 19:25:22,847 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 19:25:22,938 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 19:25:22,939 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 25.5MB, status=completed
2025-07-13 19:25:22,940 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 72.2% coverage, mean=1.40
2025-07-13 19:25:22,940 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 72.2% coverage, mean=1.89
2025-07-13 19:25:22,941 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 72.2% coverage, mean=0.35
2025-07-13 19:25:22,941 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 72.2% coverage, mean=0.02
2025-07-13 19:25:22,942 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 72.2% coverage, mean=595.96
2025-07-13 19:25:22,943 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 72.2% coverage, mean=2.07
2025-07-13 19:25:22,943 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=0.98
2025-07-13 19:25:22,944 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.72
2025-07-13 19:25:22,944 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 72.2% coverage, mean=16.05
2025-07-13 19:25:22,945 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 72.2% coverage, mean=0.82
2025-07-13 19:25:22,946 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 72.2% coverage, mean=43.46
2025-07-13 19:25:22,947 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 72.2% coverage, mean=0.38
2025-07-13 19:25:22,947 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 72.2% coverage, mean=0.37
2025-07-13 19:25:22,948 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 72.2% coverage, mean=17.82
2025-07-13 19:25:22,949 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,950 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,950 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,951 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,951 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,952 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,953 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,953 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,954 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 72.2% coverage, mean=-0.24
2025-07-13 19:25:22,955 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 19:25:22,955 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 19:25:23,069 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 32/63 (50.8%), ETA: 429.4 minutes
2025-07-13 19:25:23,071 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 19:25:23,071 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 33/63: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406
2025-07-13 19:25:23,072 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 19:25:23,073 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 19:25:23,073 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406.zip
2025-07-13 19:25:23,074 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 19:25:23,074 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 19:25:23,075 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 19:25:23,077 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 19:30:41,846 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:30:41,847 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:30:41,847 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:30:41,848 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191201T112431_T29TNF_Subset_C2RCC.dim (23.9 MB)
2025-07-13 19:30:41,849 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191201T112431_T29TNF_Subset_C2RCC.data
2025-07-13 19:30:41,849 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:30:41,850 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 19:30:41,851 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 19:30:41,851 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 19:30:41,852 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 19:30:41,852 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:30:41,853 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:30:41,853 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:30:41,854 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:30:41,854 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:30:41,855 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:30:41,856 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:30:41,856 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:30:41,857 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:30:41,857 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:30:41,858 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 19:30:41,859 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:30:41,859 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406.zip
2025-07-13 19:30:41,860 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191201T112431_T29TNF_Subset_C2RCC.dim (23.9MB)
2025-07-13 19:30:41,860 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.3 minutes
2025-07-13 19:30:41,861 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 19:30:41,861 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 19:30:41,862 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 19:30:41,863 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 19:30:41,863 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 19:30:42,046 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.0561
2025-07-13 19:30:42,229 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.1271
2025-07-13 19:30:42,410 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.4537
2025-07-13 19:30:42,411 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 19:30:42,824 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 26711368 valid pixels out of 26711368 processed
2025-07-13 19:30:44,399 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 19:30:44,567 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 81.3% coverage, mean=1.359 mg/m¬≥
2025-07-13 19:30:44,568 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 19:30:45,036 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 26711368 valid pixels out of 26711368 processed
2025-07-13 19:30:46,506 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 19:30:46,672 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 81.3% coverage, mean=1.906 g/m¬≥
2025-07-13 19:30:46,704 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 19:30:46,704 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 19:30:46,710 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:30:46,711 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:30:46,711 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:30:46,712 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191201T112431_T29TNF_Subset_C2RCC.dim (23.9 MB)
2025-07-13 19:30:46,712 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191201T112431_T29TNF_Subset_C2RCC.data
2025-07-13 19:30:46,713 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:30:46,713 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 19:30:46,714 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 19:30:46,715 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 19:30:46,715 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 19:30:46,716 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:30:46,716 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:30:46,717 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:30:46,718 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:30:46,718 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:30:46,719 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:30:46,719 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:30:46,720 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:30:46,721 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:30:46,721 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:30:46,722 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 19:30:46,722 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 19:30:46,723 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 19:30:46,723 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 19:30:46,724 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:30:46,724 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 19:30:46,725 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 19:30:46,725 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406.zip
2025-07-13 19:30:46,726 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 19:30:46,726 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 19:30:46,727 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 19:30:46,728 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 19:30:46,728 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 19:30:46,729 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 19:30:46,729 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 19:30:46,730 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 19:30:46,731 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406.zip
2025-07-13 19:30:46,732 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 19:30:47,528 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 19:30:48,080 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 26711368 valid pixels with corrected Jiang algorithm
2025-07-13 19:39:12,130 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 19:39:12,131 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 26711368/32874120 (81.3%)
2025-07-13 19:39:12,193 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 19:39:12,216 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 16342833 pixels (61.2%)
2025-07-13 19:39:12,240 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 8552778 pixels (32.0%)
2025-07-13 19:39:12,262 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 1815737 pixels (6.8%)
2025-07-13 19:39:12,286 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 20 pixels (0.0%)
2025-07-13 19:39:12,319 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 19:39:12,320 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 19:39:12,321 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 19:39:12,321 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 19:39:12,655 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 26711368 pixels
2025-07-13 19:39:12,773 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 13.72 m
2025-07-13 19:39:12,891 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.791
2025-07-13 19:39:12,892 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 19:39:12,893 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:39:13,040 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:39:13,083 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 19:39:13,404 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 26711368 pixels
2025-07-13 19:39:13,405 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 19:39:13,681 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 19:39:13,682 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 19:39:14,040 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 19:39:14,365 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 19:39:14,365 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 19:39:14,366 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 502 pixels (0.0%)
2025-07-13 19:39:14,367 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 11130 pixels (0.0%)
2025-07-13 19:39:14,367 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 4777 pixels (0.0%)
2025-07-13 19:39:14,374 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 19:39:14,375 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 19:39:14,397 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 19:39:14,399 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 19:39:14,399 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 19:39:14,400 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 19:39:15,920 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_Absorption.tif
2025-07-13 19:39:17,563 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_Backscattering.tif
2025-07-13 19:39:18,450 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_ReferenceBand.tif
2025-07-13 19:39:20,077 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_TSS.tif
2025-07-13 19:39:21,018 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_WaterTypes.tif
2025-07-13 19:39:21,878 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Jiang_ValidMask.tif
2025-07-13 19:39:23,651 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Secchidepth.tif
2025-07-13 19:39:25,380 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Clarityindex.tif
2025-07-13 19:39:27,139 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Euphoticdepth.tif
2025-07-13 19:39:28,905 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Diffuseattenuation.tif
2025-07-13 19:39:30,657 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Beamattenuation.tif
2025-07-13 19:39:32,309 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_Clarity_Turbidityproxy.tif
2025-07-13 19:39:33,041 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Probability.tif
2025-07-13 19:39:33,893 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Risk_Level.tif
2025-07-13 19:39:34,736 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_High_Biomass_Alert.tif
2025-07-13 19:39:35,586 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Extreme_Biomass_Alert.tif
2025-07-13 19:39:36,446 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Ndci_Bloom.tif
2025-07-13 19:39:37,302 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Flh_Bloom.tif
2025-07-13 19:39:38,158 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Mci_Bloom.tif
2025-07-13 19:39:39,016 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Cyanobacteria_Bloom.tif
2025-07-13 19:39:40,649 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Ndci_Values.tif
2025-07-13 19:39:42,374 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Flh_Values.tif
2025-07-13 19:39:44,114 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_HAB_Mci_Values.tif
2025-07-13 19:39:44,299 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_WaterTypes_Legend.txt
2025-07-13 19:39:44,299 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 19:39:44,300 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 19:39:44,301 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 19:39:44,302 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 19:39:44,302 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406
2025-07-13 19:39:44,464 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406 ===
2025-07-13 19:39:44,465 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 81.3%
2025-07-13 19:39:44,466 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 90.14 g/m¬≥
2025-07-13 19:39:44,467 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.92 g/m¬≥
2025-07-13 19:39:44,527 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 19:39:44,551 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 16342833 pixels (61.2%)
2025-07-13 19:39:44,575 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 8552778 pixels (32.0%)
2025-07-13 19:39:44,599 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 1815737 pixels (6.8%)
2025-07-13 19:39:44,622 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 20 pixels (0.0%)
2025-07-13 19:39:44,700 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 16409 pixels with bloom risk (502 high risk)
2025-07-13 19:39:44,700 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 19:39:44,705 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191201T112431_N0500_R037_T29TNF_20230608T121406_ProductIndex.txt
2025-07-13 19:39:44,709 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 19:39:44,710 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 19:39:44,710 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 19:39:44,711 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 19:39:44,800 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 19:39:44,801 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 23.9MB, status=completed
2025-07-13 19:39:44,801 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 81.3% coverage, mean=1.36
2025-07-13 19:39:44,802 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 81.3% coverage, mean=1.91
2025-07-13 19:39:44,803 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 81.3% coverage, mean=0.39
2025-07-13 19:39:44,804 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 81.3% coverage, mean=0.02
2025-07-13 19:39:44,805 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 81.3% coverage, mean=605.86
2025-07-13 19:39:44,805 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 81.3% coverage, mean=1.92
2025-07-13 19:39:44,806 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.18
2025-07-13 19:39:44,807 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.81
2025-07-13 19:39:44,807 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 81.3% coverage, mean=13.72
2025-07-13 19:39:44,808 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 81.3% coverage, mean=0.79
2025-07-13 19:39:44,808 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 81.3% coverage, mean=37.16
2025-07-13 19:39:44,809 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 81.3% coverage, mean=0.41
2025-07-13 19:39:44,809 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 81.3% coverage, mean=0.40
2025-07-13 19:39:44,810 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 81.3% coverage, mean=16.34
2025-07-13 19:39:44,810 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,811 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,811 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,812 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,813 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,813 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,814 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,815 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,815 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 81.3% coverage, mean=-0.24
2025-07-13 19:39:44,816 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,816 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 19:39:44,947 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 33/63 (52.4%), ETA: 416.0 minutes
2025-07-13 19:39:44,948 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 19:39:44,949 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 34/63: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849
2025-07-13 19:39:44,949 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 19:39:44,950 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 19:39:44,951 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849.zip
2025-07-13 19:39:44,951 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 19:39:44,952 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 19:39:44,952 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 19:39:44,954 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 19:44:58,434 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:44:58,434 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:44:58,435 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:44:58,436 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191204T113441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 19:44:58,437 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191204T113441_T29TNF_Subset_C2RCC.data
2025-07-13 19:44:58,437 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:44:58,438 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 19:44:58,439 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 19:44:58,439 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 19:44:58,440 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 19:44:58,441 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:44:58,441 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:44:58,442 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:44:58,442 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:44:58,443 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:44:58,444 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:44:58,444 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:44:58,445 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:44:58,445 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:44:58,446 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:44:58,447 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 19:44:58,447 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:44:58,448 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849.zip
2025-07-13 19:44:58,449 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191204T113441_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-13 19:44:58,449 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 19:44:58,450 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 19:44:58,450 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 19:44:58,451 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 19:44:58,452 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 19:44:58,452 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 19:44:58,645 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1720
2025-07-13 19:44:58,837 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=0.9161
2025-07-13 19:44:59,029 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.3732
2025-07-13 19:44:59,029 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 19:44:59,483 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 27158819 valid pixels out of 27158819 processed
2025-07-13 19:45:01,047 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 19:45:01,220 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 82.6% coverage, mean=4.165 mg/m¬≥
2025-07-13 19:45:01,221 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 19:45:01,721 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 27158819 valid pixels out of 27158819 processed
2025-07-13 19:45:03,200 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 19:45:03,374 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 82.6% coverage, mean=1.575 g/m¬≥
2025-07-13 19:45:03,406 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 19:45:03,406 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 19:45:03,412 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:45:03,413 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:45:03,413 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:45:03,414 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191204T113441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-13 19:45:03,415 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191204T113441_T29TNF_Subset_C2RCC.data
2025-07-13 19:45:03,415 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:45:03,416 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 19:45:03,417 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 19:45:03,417 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 19:45:03,418 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 19:45:03,418 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:45:03,419 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:45:03,420 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:45:03,420 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:45:03,421 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:45:03,421 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:45:03,422 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:45:03,422 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:45:03,423 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:45:03,424 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:45:03,424 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 19:45:03,425 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 19:45:03,425 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 19:45:03,426 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 19:45:03,426 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:45:03,427 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 19:45:03,427 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 19:45:03,428 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849.zip
2025-07-13 19:45:03,428 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 19:45:03,429 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 19:45:03,430 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 19:45:03,430 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 19:45:03,431 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 19:45:03,432 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 19:45:03,432 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 19:45:03,433 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 19:45:03,434 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849.zip
2025-07-13 19:45:03,435 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 19:45:04,237 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 19:45:04,782 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 27158819 valid pixels with corrected Jiang algorithm
2025-07-13 19:53:21,296 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 19:53:21,297 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 27158819/32874120 (82.6%)
2025-07-13 19:53:21,359 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 19:53:21,383 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 3200735 pixels (11.8%)
2025-07-13 19:53:21,406 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 19510616 pixels (71.8%)
2025-07-13 19:53:21,429 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 4447460 pixels (16.4%)
2025-07-13 19:53:21,454 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 19:53:21,486 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 19:53:21,487 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 19:53:21,488 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 19:53:21,488 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 19:53:21,840 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 27158819 pixels
2025-07-13 19:53:21,967 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 4.64 m
2025-07-13 19:53:22,084 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.627
2025-07-13 19:53:22,085 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 19:53:22,086 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:53:22,219 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 19:53:22,262 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 19:53:22,606 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 27158819 pixels
2025-07-13 19:53:22,606 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 19:53:22,887 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 19:53:22,888 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 19:53:23,246 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 19:53:23,577 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 19:53:23,578 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 19:53:23,579 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 80 pixels (0.0%)
2025-07-13 19:53:23,579 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 7668 pixels (0.0%)
2025-07-13 19:53:23,580 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 1512 pixels (0.0%)
2025-07-13 19:53:23,587 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 19:53:23,588 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 19:53:23,611 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 19:53:23,613 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 19:53:23,614 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 19:53:23,614 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 19:53:25,136 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_Absorption.tif
2025-07-13 19:53:26,735 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_Backscattering.tif
2025-07-13 19:53:27,615 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_ReferenceBand.tif
2025-07-13 19:53:29,207 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_TSS.tif
2025-07-13 19:53:30,168 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_WaterTypes.tif
2025-07-13 19:53:31,035 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Jiang_ValidMask.tif
2025-07-13 19:53:32,812 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Secchidepth.tif
2025-07-13 19:53:34,528 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Clarityindex.tif
2025-07-13 19:53:36,291 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Euphoticdepth.tif
2025-07-13 19:53:38,073 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Diffuseattenuation.tif
2025-07-13 19:53:39,854 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Beamattenuation.tif
2025-07-13 19:53:41,478 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_Clarity_Turbidityproxy.tif
2025-07-13 19:53:42,202 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Probability.tif
2025-07-13 19:53:43,052 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Risk_Level.tif
2025-07-13 19:53:43,904 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_High_Biomass_Alert.tif
2025-07-13 19:53:44,757 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Extreme_Biomass_Alert.tif
2025-07-13 19:53:45,614 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Ndci_Bloom.tif
2025-07-13 19:53:46,471 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Flh_Bloom.tif
2025-07-13 19:53:47,370 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Mci_Bloom.tif
2025-07-13 19:53:48,228 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Cyanobacteria_Bloom.tif
2025-07-13 19:53:49,822 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Ndci_Values.tif
2025-07-13 19:53:51,521 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Flh_Values.tif
2025-07-13 19:53:53,313 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_HAB_Mci_Values.tif
2025-07-13 19:53:53,497 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_WaterTypes_Legend.txt
2025-07-13 19:53:53,498 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 19:53:53,499 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 19:53:53,500 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 19:53:53,500 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 19:53:53,501 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849
2025-07-13 19:53:53,667 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849 ===
2025-07-13 19:53:53,668 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 82.6%
2025-07-13 19:53:53,669 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 90.60 g/m¬≥
2025-07-13 19:53:53,670 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 1.40 g/m¬≥
2025-07-13 19:53:53,731 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 19:53:53,755 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 3200735 pixels (11.8%)
2025-07-13 19:53:53,778 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 19510616 pixels (71.8%)
2025-07-13 19:53:53,802 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 4447460 pixels (16.4%)
2025-07-13 19:53:53,824 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 8 pixels (0.0%)
2025-07-13 19:53:53,895 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 9260 pixels with bloom risk (80 high risk)
2025-07-13 19:53:53,896 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 19:53:53,907 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191204T113441_N0500_R080_T29TNF_20230609T013849_ProductIndex.txt
2025-07-13 19:53:53,911 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 19:53:53,912 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 19:53:53,912 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 19:53:53,913 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 19:53:54,001 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 19:53:54,002 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 20.8MB, status=completed
2025-07-13 19:53:54,003 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 82.6% coverage, mean=4.17
2025-07-13 19:53:54,004 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 82.6% coverage, mean=1.57
2025-07-13 19:53:54,004 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 82.6% coverage, mean=0.81
2025-07-13 19:53:54,005 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 82.6% coverage, mean=0.01
2025-07-13 19:53:54,006 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 82.6% coverage, mean=664.91
2025-07-13 19:53:54,007 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 82.6% coverage, mean=1.40
2025-07-13 19:53:54,007 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.69
2025-07-13 19:53:54,008 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.83
2025-07-13 19:53:54,009 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 82.6% coverage, mean=4.64
2025-07-13 19:53:54,009 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 82.6% coverage, mean=0.63
2025-07-13 19:53:54,010 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 82.6% coverage, mean=12.56
2025-07-13 19:53:54,010 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 82.6% coverage, mean=0.83
2025-07-13 19:53:54,011 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 82.6% coverage, mean=0.82
2025-07-13 19:53:54,012 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 82.6% coverage, mean=11.48
2025-07-13 19:53:54,012 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,013 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,013 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,014 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,014 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,015 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,015 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,016 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,017 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 82.6% coverage, mean=-0.22
2025-07-13 19:53:54,018 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,018 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 19:53:54,122 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 34/63 (54.0%), ETA: 402.4 minutes
2025-07-13 19:53:54,124 - INFO - [sentinel2_tss_pipeline.py:3300] - 
--------------------------------------------------------------------------------
2025-07-13 19:53:54,124 - INFO - [sentinel2_tss_pipeline.py:3301] - Processing 35/63: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223
2025-07-13 19:53:54,125 - INFO - [sentinel2_tss_pipeline.py:3302] - Mode: complete_pipeline
2025-07-13 19:53:54,125 - INFO - [sentinel2_tss_pipeline.py:3303] - --------------------------------------------------------------------------------
2025-07-13 19:53:54,126 - INFO - [sentinel2_tss_pipeline.py:2761] - Processing: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223.zip
2025-07-13 19:53:54,127 - INFO - [sentinel2_tss_pipeline.py:2762] -   Mode: complete_pipeline
2025-07-13 19:53:54,127 - INFO - [sentinel2_tss_pipeline.py:2763] -   Resolution: 10m
2025-07-13 19:53:54,128 - INFO - [sentinel2_tss_pipeline.py:2764] -   ECMWF: True
2025-07-13 19:53:54,130 - INFO - [sentinel2_tss_pipeline.py:2910] - Starting S2 processing with C2RCC...
2025-07-13 19:59:09,081 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:59:09,082 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:59:09,082 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:59:09,083 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191231T112451_T29TNF_Subset_C2RCC.dim (22.8 MB)
2025-07-13 19:59:09,083 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191231T112451_T29TNF_Subset_C2RCC.data
2025-07-13 19:59:09,084 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:59:09,085 - INFO - [sentinel2_tss_pipeline.py:3093] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-13 19:59:09,086 - INFO - [sentinel2_tss_pipeline.py:3094] -    Using SNAP formulas:
2025-07-13 19:59:09,086 - INFO - [sentinel2_tss_pipeline.py:3095] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-13 19:59:09,087 - INFO - [sentinel2_tss_pipeline.py:3096] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-13 19:59:09,087 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:59:09,088 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:59:09,088 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:59:09,089 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:59:09,090 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:59:09,090 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:59:09,091 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:59:09,091 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:59:09,092 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:59:09,093 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:59:09,093 - INFO - [sentinel2_tss_pipeline.py:3123] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-13 19:59:09,094 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:59:09,095 - INFO - [sentinel2_tss_pipeline.py:2831] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223.zip
2025-07-13 19:59:09,095 - INFO - [sentinel2_tss_pipeline.py:2832] -    Output: Resampled_S2A_20191231T112451_T29TNF_Subset_C2RCC.dim (22.8MB)
2025-07-13 19:59:09,096 - INFO - [sentinel2_tss_pipeline.py:2833] -    Processing time: 5.2 minutes
2025-07-13 19:59:09,096 - INFO - [sentinel2_tss_pipeline.py:2840] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-13 19:59:09,097 - INFO - [sentinel2_tss_pipeline.py:760] - SNAP TSM/CHL Calculator initialized:
2025-07-13 19:59:09,098 - INFO - [sentinel2_tss_pipeline.py:761] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-13 19:59:09,098 - INFO - [sentinel2_tss_pipeline.py:762] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-13 19:59:09,099 - INFO - [sentinel2_tss_pipeline.py:767] - Calculating SNAP TSM/CHL from IOP products...
2025-07-13 19:59:09,294 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded apig: (10980, 2994), mean=0.1477
2025-07-13 19:59:09,487 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bpart: (10980, 2994), mean=1.3407
2025-07-13 19:59:09,680 - INFO - [sentinel2_tss_pipeline.py:793] - ‚úì Loaded bwit: (10980, 2994), mean=0.5378
2025-07-13 19:59:09,681 - INFO - [sentinel2_tss_pipeline.py:803] - Calculating CHL concentration from iop_apig...
2025-07-13 19:59:10,110 - INFO - [sentinel2_tss_pipeline.py:832] - CHL calculation: 25834129 valid pixels out of 25834129 processed
2025-07-13 19:59:11,533 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_chl.img
2025-07-13 19:59:11,698 - INFO - [sentinel2_tss_pipeline.py:851] - ‚úì CHL concentration saved: 78.6% coverage, mean=3.766 mg/m¬≥
2025-07-13 19:59:11,699 - INFO - [sentinel2_tss_pipeline.py:861] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-13 19:59:12,132 - INFO - [sentinel2_tss_pipeline.py:893] - TSM calculation: 25834129 valid pixels out of 25834129 processed
2025-07-13 19:59:13,521 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: conc_tsm.img
2025-07-13 19:59:13,683 - INFO - [sentinel2_tss_pipeline.py:912] - ‚úì TSM concentration saved: 78.6% coverage, mean=2.354 g/m¬≥
2025-07-13 19:59:13,713 - INFO - [sentinel2_tss_pipeline.py:2853] - ‚úÖ SNAP TSM calculation successful!
2025-07-13 19:59:13,724 - INFO - [sentinel2_tss_pipeline.py:2856] - ‚úÖ SNAP CHL calculation successful!
2025-07-13 19:59:13,730 - INFO - [sentinel2_tss_pipeline.py:3072] - ============================================================
2025-07-13 19:59:13,730 - INFO - [sentinel2_tss_pipeline.py:3073] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-13 19:59:13,731 - INFO - [sentinel2_tss_pipeline.py:3074] - ============================================================
2025-07-13 19:59:13,732 - INFO - [sentinel2_tss_pipeline.py:3077] - C2RCC file: Resampled_S2A_20191231T112451_T29TNF_Subset_C2RCC.dim (22.8 MB)
2025-07-13 19:59:13,732 - INFO - [sentinel2_tss_pipeline.py:3078] - Data folder: Resampled_S2A_20191231T112451_T29TNF_Subset_C2RCC.data
2025-07-13 19:59:13,733 - INFO - [sentinel2_tss_pipeline.py:3081] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-13 19:59:13,733 - INFO - [sentinel2_tss_pipeline.py:3083] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-13 19:59:13,734 - INFO - [sentinel2_tss_pipeline.py:3084] -    ‚úì TSM: conc_tsm.img (0.0 KB)
2025-07-13 19:59:13,734 - INFO - [sentinel2_tss_pipeline.py:3085] -    ‚úì CHL: conc_chl.img (0.0 KB)
2025-07-13 19:59:13,735 - INFO - [sentinel2_tss_pipeline.py:3090] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-13 19:59:13,735 - INFO - [sentinel2_tss_pipeline.py:3099] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-13 19:59:13,736 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_apig.img (128414.5 KB)
2025-07-13 19:59:13,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_adet.img (128414.5 KB)
2025-07-13 19:59:13,737 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_agelb.img (128414.5 KB)
2025-07-13 19:59:13,738 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bpart.img (128414.5 KB)
2025-07-13 19:59:13,738 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úì iop_bwit.img (128414.5 KB)
2025-07-13 19:59:13,739 - INFO - [sentinel2_tss_pipeline.py:3104] -    ‚úó iop_btot.img (missing/empty)
2025-07-13 19:59:13,740 - INFO - [sentinel2_tss_pipeline.py:3107] - 
üåä JIANG TSS READINESS (8/8 bands):
2025-07-13 19:59:13,740 - INFO - [sentinel2_tss_pipeline.py:3109] - ‚úÖ READY: All rhow bands available for Jiang TSS processing
2025-07-13 19:59:13,741 - INFO - [sentinel2_tss_pipeline.py:3116] - 
üìä OVERALL ASSESSMENT:
2025-07-13 19:59:13,742 - INFO - [sentinel2_tss_pipeline.py:3118] - üéØ EXCELLENT: Complete TSS analysis pipeline ready!
2025-07-13 19:59:13,742 - INFO - [sentinel2_tss_pipeline.py:3119] -    - SNAP TSM/CHL: Available
2025-07-13 19:59:13,743 - INFO - [sentinel2_tss_pipeline.py:3120] -    - Jiang TSS: Ready
2025-07-13 19:59:13,743 - INFO - [sentinel2_tss_pipeline.py:3121] -    - Advanced algorithms: Can proceed
2025-07-13 19:59:13,744 - INFO - [sentinel2_tss_pipeline.py:3127] - ============================================================
2025-07-13 19:59:13,744 - INFO - [sentinel2_tss_pipeline.py:2861] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-13 19:59:13,745 - INFO - [sentinel2_tss_pipeline.py:2862] -    TSM=True, CHL=True, Uncertainties=False
2025-07-13 19:59:13,745 - INFO - [sentinel2_tss_pipeline.py:3141] - Starting TSS processing for S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223.zip
2025-07-13 19:59:13,746 - INFO - [sentinel2_tss_pipeline.py:2051] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-13 19:59:13,747 - INFO - [sentinel2_tss_pipeline.py:1010] - Initialized Jiang TSS Processor with clean methodology
2025-07-13 19:59:13,747 - INFO - [sentinel2_tss_pipeline.py:1013] - Jiang TSS enabled: True
2025-07-13 19:59:13,748 - INFO - [sentinel2_tss_pipeline.py:1014] - Advanced algorithms enabled: True
2025-07-13 19:59:13,748 - INFO - [sentinel2_tss_pipeline.py:1016] - Working algorithms available:
2025-07-13 19:59:13,749 - INFO - [sentinel2_tss_pipeline.py:1017] -   ‚úì Water Clarity: True
2025-07-13 19:59:13,750 - INFO - [sentinel2_tss_pipeline.py:1018] -   ‚úì HAB Detection: True
2025-07-13 19:59:13,750 - INFO - [sentinel2_tss_pipeline.py:1019] - Note: Only Sentinel-2 compatible algorithms included
2025-07-13 19:59:13,751 - INFO - [sentinel2_tss_pipeline.py:1085] - Starting CORRECTED Jiang TSS processing for S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223.zip
2025-07-13 19:59:13,753 - INFO - [sentinel2_tss_pipeline.py:1055] - Successfully found 8 spectral bands
2025-07-13 19:59:14,567 - INFO - [sentinel2_tss_pipeline.py:1237] - Applying Jiang methodology (exact R translation)
2025-07-13 19:59:15,115 - INFO - [sentinel2_tss_pipeline.py:1355] - Processing 25834129 valid pixels with corrected Jiang algorithm
2025-07-13 20:05:23,691 - INFO - [sentinel2_tss_pipeline.py:6109] - Application finished successfully
2025-07-13 20:07:10,101 - INFO - [sentinel2_tss_pipeline.py:1290] - CORRECTED Jiang processing completed:
2025-07-13 20:07:10,102 - INFO - [sentinel2_tss_pipeline.py:1291] -   Valid pixels: 25834129/32874120 (78.6%)
2025-07-13 20:07:10,159 - INFO - [sentinel2_tss_pipeline.py:1299] - Water type distribution (corrected algorithm):
2025-07-13 20:07:10,181 - INFO - [sentinel2_tss_pipeline.py:1310] -   560nm (Type I (Clear water)): 7384396 pixels (28.6%)
2025-07-13 20:07:10,203 - INFO - [sentinel2_tss_pipeline.py:1310] -   665nm (Type II (Moderately turbid)): 12959967 pixels (50.2%)
2025-07-13 20:07:10,227 - INFO - [sentinel2_tss_pipeline.py:1310] -   740nm (Type III (Highly turbid)): 5489764 pixels (21.3%)
2025-07-13 20:07:10,250 - INFO - [sentinel2_tss_pipeline.py:1310] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 20:07:10,278 - INFO - [sentinel2_tss_pipeline.py:1108] - Processing advanced algorithms
2025-07-13 20:07:10,279 - INFO - [sentinel2_tss_pipeline.py:1141] - Processing working advanced aquatic algorithms
2025-07-13 20:07:10,280 - INFO - [sentinel2_tss_pipeline.py:1154] - Calculating water clarity indices
2025-07-13 20:07:10,280 - INFO - [sentinel2_tss_pipeline.py:2076] - Calculating water clarity indices
2025-07-13 20:07:10,617 - INFO - [sentinel2_tss_pipeline.py:2111] - Water clarity calculated for 25834129 pixels
2025-07-13 20:07:10,762 - INFO - [sentinel2_tss_pipeline.py:2112] - Mean Secchi depth: 7.66 m
2025-07-13 20:07:10,877 - INFO - [sentinel2_tss_pipeline.py:2113] - Mean clarity index: 0.644
2025-07-13 20:07:10,877 - INFO - [sentinel2_tss_pipeline.py:1168] - Water clarity calculation completed: 6 products
2025-07-13 20:07:10,878 - INFO - [sentinel2_tss_pipeline.py:1177] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 20:07:11,034 - INFO - [sentinel2_tss_pipeline.py:2133] - Detecting harmful algal blooms using Sentinel-2 spectral analysis
2025-07-13 20:07:11,076 - INFO - [sentinel2_tss_pipeline.py:2155] - Calculating NDCI (Normalized Difference Chlorophyll Index)
2025-07-13 20:07:11,386 - INFO - [sentinel2_tss_pipeline.py:2185] - NDCI calculated for 25834129 pixels
2025-07-13 20:07:11,387 - INFO - [sentinel2_tss_pipeline.py:2189] - Calculating Fluorescence Line Height (FLH)
2025-07-13 20:07:11,676 - INFO - [sentinel2_tss_pipeline.py:2218] - FLH calculated for 32874120 pixels
2025-07-13 20:07:11,677 - INFO - [sentinel2_tss_pipeline.py:2222] - Calculating Maximum Chlorophyll Index (MCI)
2025-07-13 20:07:12,023 - INFO - [sentinel2_tss_pipeline.py:2255] - MCI calculated for 32874120 pixels
2025-07-13 20:07:12,344 - INFO - [sentinel2_tss_pipeline.py:2298] - HAB detection completed using algorithms: NDCI, FLH, MCI
2025-07-13 20:07:12,344 - INFO - [sentinel2_tss_pipeline.py:2299] - Processed 32874120 pixels
2025-07-13 20:07:12,345 - INFO - [sentinel2_tss_pipeline.py:2300] - High risk: 60 pixels (0.0%)
2025-07-13 20:07:12,346 - INFO - [sentinel2_tss_pipeline.py:2301] - Medium risk: 3343 pixels (0.0%)
2025-07-13 20:07:12,346 - INFO - [sentinel2_tss_pipeline.py:2302] - Low risk: 972 pixels (0.0%)
2025-07-13 20:07:12,353 - INFO - [sentinel2_tss_pipeline.py:1198] - HAB detection completed: 11 products
2025-07-13 20:07:12,354 - INFO - [sentinel2_tss_pipeline.py:1205] - Working advanced algorithms completed: 17 products generated
2025-07-13 20:07:12,377 - INFO - [sentinel2_tss_pipeline.py:1113] - Advanced algorithms completed: 17 additional products
2025-07-13 20:07:12,379 - INFO - [sentinel2_tss_pipeline.py:1707] - Saving 23 products:
2025-07-13 20:07:12,380 - INFO - [sentinel2_tss_pipeline.py:1708] -   Core Jiang products: 6
2025-07-13 20:07:12,380 - INFO - [sentinel2_tss_pipeline.py:1709] -   Advanced products: 17
2025-07-13 20:07:13,820 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_Absorption.tif
2025-07-13 20:07:15,427 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_Backscattering.tif
2025-07-13 20:07:16,326 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_ReferenceBand.tif
2025-07-13 20:07:17,919 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_TSS.tif
2025-07-13 20:07:18,855 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_WaterTypes.tif
2025-07-13 20:07:19,767 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Jiang_ValidMask.tif
2025-07-13 20:07:21,503 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Secchidepth.tif
2025-07-13 20:07:23,192 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Clarityindex.tif
2025-07-13 20:07:24,943 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Euphoticdepth.tif
2025-07-13 20:07:26,696 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Diffuseattenuation.tif
2025-07-13 20:07:28,436 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Beamattenuation.tif
2025-07-13 20:07:30,043 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_Clarity_Turbidityproxy.tif
2025-07-13 20:07:30,803 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Probability.tif
2025-07-13 20:07:31,691 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Risk_Level.tif
2025-07-13 20:07:32,583 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_High_Biomass_Alert.tif
2025-07-13 20:07:33,496 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Extreme_Biomass_Alert.tif
2025-07-13 20:07:34,370 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Ndci_Bloom.tif
2025-07-13 20:07:35,253 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Flh_Bloom.tif
2025-07-13 20:07:36,150 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Mci_Bloom.tif
2025-07-13 20:07:37,019 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Cyanobacteria_Bloom.tif
2025-07-13 20:07:38,606 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Ndci_Values.tif
2025-07-13 20:07:40,251 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Flh_Values.tif
2025-07-13 20:07:42,006 - INFO - [sentinel2_tss_pipeline.py:559] - Successfully wrote raster: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_HAB_Mci_Values.tif
2025-07-13 20:07:42,198 - INFO - [sentinel2_tss_pipeline.py:1860] - Water type legend created: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_WaterTypes_Legend.txt
2025-07-13 20:07:42,199 - INFO - [sentinel2_tss_pipeline.py:1785] - Product saving completed:
2025-07-13 20:07:42,199 - INFO - [sentinel2_tss_pipeline.py:1786] -   Successfully saved: 23 products
2025-07-13 20:07:42,200 - INFO - [sentinel2_tss_pipeline.py:1787] -   Skipped (no data): 0 products
2025-07-13 20:07:42,201 - INFO - [sentinel2_tss_pipeline.py:1788] -   Total attempted: 23 products
2025-07-13 20:07:42,201 - INFO - [sentinel2_tss_pipeline.py:1789] -   Output folder: D:/GSEU_WP5/02_TSS_Results\TSS_Products\S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223
2025-07-13 20:07:42,360 - INFO - [sentinel2_tss_pipeline.py:1927] - === COMPLETE PROCESSING SUMMARY: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223 ===
2025-07-13 20:07:42,361 - INFO - [sentinel2_tss_pipeline.py:1928] - Total coverage: 78.6%
2025-07-13 20:07:42,362 - INFO - [sentinel2_tss_pipeline.py:1929] - TSS range: -0.03 - 82.91 g/m¬≥
2025-07-13 20:07:42,362 - INFO - [sentinel2_tss_pipeline.py:1930] - TSS mean: 2.39 g/m¬≥
2025-07-13 20:07:42,421 - INFO - [sentinel2_tss_pipeline.py:1938] - Jiang water type classification results:
2025-07-13 20:07:42,443 - INFO - [sentinel2_tss_pipeline.py:1949] -   560nm (Type I (Clear)): 7384396 pixels (28.6%)
2025-07-13 20:07:42,465 - INFO - [sentinel2_tss_pipeline.py:1949] -   665nm (Type II (Moderately turbid)): 12959967 pixels (50.2%)
2025-07-13 20:07:42,489 - INFO - [sentinel2_tss_pipeline.py:1949] -   740nm (Type III (Highly turbid)): 5489764 pixels (21.3%)
2025-07-13 20:07:42,512 - INFO - [sentinel2_tss_pipeline.py:1949] -   865nm (Type IV (Extremely turbid)): 2 pixels (0.0%)
2025-07-13 20:07:42,582 - INFO - [sentinel2_tss_pipeline.py:1971] - HAB detection: 4375 pixels with bloom risk (60 high risk)
2025-07-13 20:07:42,582 - INFO - [sentinel2_tss_pipeline.py:1973] - ============================================================
2025-07-13 20:07:42,594 - INFO - [sentinel2_tss_pipeline.py:1909] - Product index created: S2A_MSIL1C_20191231T112451_N0500_R037_T29TNF_20230607T140223_ProductIndex.txt
2025-07-13 20:07:42,598 - INFO - [sentinel2_tss_pipeline.py:1125] - CORRECTED Jiang processing completed:
2025-07-13 20:07:42,598 - INFO - [sentinel2_tss_pipeline.py:1126] -   Jiang products: 6
2025-07-13 20:07:42,599 - INFO - [sentinel2_tss_pipeline.py:1127] -   Advanced products: 17
2025-07-13 20:07:42,600 - INFO - [sentinel2_tss_pipeline.py:1128] -   Total products: 23
2025-07-13 20:07:42,698 - INFO - [sentinel2_tss_pipeline.py:3336] - ‚úì Processing completed: 26 products generated
2025-07-13 20:07:42,699 - INFO - [sentinel2_tss_pipeline.py:3347] -   s2_processing: 22.8MB, status=completed
2025-07-13 20:07:42,700 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_chl: 78.6% coverage, mean=3.77
2025-07-13 20:07:42,701 - INFO - [sentinel2_tss_pipeline.py:3344] -   snap_tsm: 78.6% coverage, mean=2.35
2025-07-13 20:07:42,701 - INFO - [sentinel2_tss_pipeline.py:3344] -   absorption: 78.6% coverage, mean=0.86
2025-07-13 20:07:42,702 - INFO - [sentinel2_tss_pipeline.py:3344] -   backscattering: 78.6% coverage, mean=0.02
2025-07-13 20:07:42,703 - INFO - [sentinel2_tss_pipeline.py:3344] -   reference_band: 78.6% coverage, mean=650.92
2025-07-13 20:07:42,703 - INFO - [sentinel2_tss_pipeline.py:3344] -   tss: 78.6% coverage, mean=2.39
2025-07-13 20:07:42,704 - INFO - [sentinel2_tss_pipeline.py:3344] -   water_type_classification: 100.0% coverage, mean=1.51
2025-07-13 20:07:42,705 - INFO - [sentinel2_tss_pipeline.py:3344] -   valid_mask: 100.0% coverage, mean=0.79
2025-07-13 20:07:42,705 - INFO - [sentinel2_tss_pipeline.py:3344] -   secchi_depth: 78.6% coverage, mean=7.66
2025-07-13 20:07:42,706 - INFO - [sentinel2_tss_pipeline.py:3344] -   clarity_index: 78.6% coverage, mean=0.64
2025-07-13 20:07:42,706 - INFO - [sentinel2_tss_pipeline.py:3344] -   euphotic_depth: 78.6% coverage, mean=20.75
2025-07-13 20:07:42,707 - INFO - [sentinel2_tss_pipeline.py:3344] -   diffuse_attenuation: 78.6% coverage, mean=0.89
2025-07-13 20:07:42,708 - INFO - [sentinel2_tss_pipeline.py:3344] -   beam_attenuation: 78.6% coverage, mean=0.88
2025-07-13 20:07:42,708 - INFO - [sentinel2_tss_pipeline.py:3344] -   turbidity_proxy: 78.6% coverage, mean=19.78
2025-07-13 20:07:42,709 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_probability: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,709 - INFO - [sentinel2_tss_pipeline.py:3344] -   hab_risk_level: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,710 - INFO - [sentinel2_tss_pipeline.py:3344] -   high_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,711 - INFO - [sentinel2_tss_pipeline.py:3344] -   extreme_biomass_alert: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,711 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_bloom: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,712 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_bloom: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,713 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_bloom: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,713 - INFO - [sentinel2_tss_pipeline.py:3344] -   cyanobacteria_bloom: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,714 - INFO - [sentinel2_tss_pipeline.py:3344] -   ndci_values: 78.6% coverage, mean=-0.21
2025-07-13 20:07:42,715 - INFO - [sentinel2_tss_pipeline.py:3344] -   flh_values: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,715 - INFO - [sentinel2_tss_pipeline.py:3344] -   mci_values: 100.0% coverage, mean=0.00
2025-07-13 20:07:42,804 - INFO - [sentinel2_tss_pipeline.py:3385] - ‚Üí Progress: 35/63 (55.6%), ETA: 388.5 minutes
2025-07-13 20:07:43,897 - ERROR - [sentinel2_tss_pipeline.py:5643] - Processing thread error: main thread is not in main loop
