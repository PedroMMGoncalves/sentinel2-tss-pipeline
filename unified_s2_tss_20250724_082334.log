2025-07-24 08:23:34,987 - INFO - [sentinel2_tss_pipeline.py:231] - Logging configured - File: unified_s2_tss_20250724_082334.log
2025-07-24 08:23:34,995 - INFO - [sentinel2_tss_pipeline.py:8000] - Auto-detected SNAP_HOME: C:\Program Files\esa-snap
2025-07-24 08:23:34,996 - INFO - [sentinel2_tss_pipeline.py:8041] - ================================================================================
2025-07-24 08:23:34,996 - INFO - [sentinel2_tss_pipeline.py:8042] - UNIFIED S2 PROCESSING & TSS ESTIMATION PIPELINE v1.0
2025-07-24 08:23:34,997 - INFO - [sentinel2_tss_pipeline.py:8043] - ================================================================================
2025-07-24 08:23:34,997 - INFO - [sentinel2_tss_pipeline.py:8044] - SNAP_HOME: C:\Program Files\esa-snap
2025-07-24 08:23:34,998 - INFO - [sentinel2_tss_pipeline.py:8045] - GPT: C:\Program Files\esa-snap\bin\gpt.exe
2025-07-24 08:23:34,998 - INFO - [sentinel2_tss_pipeline.py:8046] - Python: 3.9.22 | packaged by conda-forge | (main, Apr 10 2025, 22:07:06) [MSC v.1929 64 bit (AMD64)]
2025-07-24 08:23:34,998 - INFO - [sentinel2_tss_pipeline.py:8047] - Platform: win32
2025-07-24 08:23:34,999 - INFO - [sentinel2_tss_pipeline.py:8048] - Working Directory: C:\Users\pedro.goncalves\OneDrive - LNEG - Laboratorio Nacional de Energia e Geologia\GitHub\sentinel2-tss-pipeline
2025-07-24 08:23:35,000 - INFO - [sentinel2_tss_pipeline.py:8049] - ================================================================================
2025-07-24 08:23:35,000 - INFO - [sentinel2_tss_pipeline.py:8058] - Starting GUI application...
2025-07-24 08:23:35,128 - INFO - [sentinel2_tss_pipeline.py:5820] - Added enable_marine_visualization attribute (ENABLED)
2025-07-24 08:23:35,128 - INFO - [sentinel2_tss_pipeline.py:5824] - Added marine_viz_config attribute
2025-07-24 08:23:35,129 - INFO - [sentinel2_tss_pipeline.py:5834] - Creating MarineVisualizationConfig class for full functionality...
2025-07-24 08:23:35,130 - INFO - [sentinel2_tss_pipeline.py:5864] - ‚úì Created complete MarineVisualizationConfig - ALL FEATURES ENABLED
2025-07-24 08:23:35,130 - INFO - [sentinel2_tss_pipeline.py:5902] - ============================================================
2025-07-24 08:23:35,131 - INFO - [sentinel2_tss_pipeline.py:5903] - MARINE VISUALIZATION SYSTEM STATUS:
2025-07-24 08:23:35,131 - INFO - [sentinel2_tss_pipeline.py:5904] - ‚úì Marine visualization enabled: True
2025-07-24 08:23:35,132 - INFO - [sentinel2_tss_pipeline.py:5905] - ‚úì Marine config created: True
2025-07-24 08:23:35,132 - INFO - [sentinel2_tss_pipeline.py:5908] - ENABLED MARINE VISUALIZATION FEATURES:
2025-07-24 08:23:35,133 - INFO - [sentinel2_tss_pipeline.py:5909] -   ‚úì Natural color RGB: True
2025-07-24 08:23:35,134 - INFO - [sentinel2_tss_pipeline.py:5910] -   ‚úì False color RGB: True
2025-07-24 08:23:35,134 - INFO - [sentinel2_tss_pipeline.py:5911] -   ‚úì Water-specific RGB: True
2025-07-24 08:23:35,135 - INFO - [sentinel2_tss_pipeline.py:5912] -   ‚úì Research RGB combinations: True
2025-07-24 08:23:35,135 - INFO - [sentinel2_tss_pipeline.py:5913] -   ‚úì Water quality indices: True
2025-07-24 08:23:35,136 - INFO - [sentinel2_tss_pipeline.py:5914] -   ‚úì Chlorophyll indices: True
2025-07-24 08:23:35,136 - INFO - [sentinel2_tss_pipeline.py:5915] -   ‚úì Turbidity indices: True
2025-07-24 08:23:35,137 - INFO - [sentinel2_tss_pipeline.py:5916] -   ‚úì Advanced indices: True
2025-07-24 08:23:35,137 - INFO - [sentinel2_tss_pipeline.py:5917] -   ‚úì Contrast enhancement: True
2025-07-24 08:23:35,138 - INFO - [sentinel2_tss_pipeline.py:5919] - ‚úì Advanced algorithms enabled: True
2025-07-24 08:23:35,138 - INFO - [sentinel2_tss_pipeline.py:5920] - ‚úì Advanced config created: True
2025-07-24 08:23:35,139 - INFO - [sentinel2_tss_pipeline.py:5921] - ============================================================
2025-07-24 08:23:35,139 - INFO - [sentinel2_tss_pipeline.py:5922] - üé® MARINE VISUALIZATION SYSTEM READY FOR PRODUCTION! üé®
2025-07-24 08:23:35,140 - INFO - [sentinel2_tss_pipeline.py:5923] - Expected outputs per product:
2025-07-24 08:23:35,141 - INFO - [sentinel2_tss_pipeline.py:5924] -   ‚Ä¢ Multiple RGB composites (natural, false color, water-specific)
2025-07-24 08:23:35,141 - INFO - [sentinel2_tss_pipeline.py:5925] -   ‚Ä¢ Water quality spectral indices (NDWI, NDCI, NDTI, etc.)
2025-07-24 08:23:35,141 - INFO - [sentinel2_tss_pipeline.py:5926] -   ‚Ä¢ Chlorophyll indices (CIG, etc.)
2025-07-24 08:23:35,142 - INFO - [sentinel2_tss_pipeline.py:5927] -   ‚Ä¢ Turbidity indices (TSI, etc.)
2025-07-24 08:23:35,142 - INFO - [sentinel2_tss_pipeline.py:5928] -   ‚Ä¢ Advanced marine indices (FUI, SDD, CDOM, etc.)
2025-07-24 08:23:35,143 - INFO - [sentinel2_tss_pipeline.py:5929] -   ‚Ä¢ All outputs in GeoTIFF format with metadata
2025-07-24 08:23:35,143 - INFO - [sentinel2_tss_pipeline.py:5930] - ============================================================
2025-07-24 08:24:51,555 - INFO - [sentinel2_tss_pipeline.py:7245] - ‚úì Marine visualization settings updated from GUI
2025-07-24 08:24:51,556 - INFO - [sentinel2_tss_pipeline.py:7286] - Configuration update completed - Marine visualization OPERATIONAL!
2025-07-24 08:24:51,556 - INFO - [sentinel2_tss_pipeline.py:7302] - Active marine visualization features: Natural RGB, False Color RGB, Water-specific RGB, Water Quality Indices, Chlorophyll Indices, Turbidity Indices
2025-07-24 08:25:03,525 - INFO - [sentinel2_tss_pipeline.py:7245] - ‚úì Marine visualization settings updated from GUI
2025-07-24 08:25:03,526 - INFO - [sentinel2_tss_pipeline.py:7286] - Configuration update completed - Marine visualization OPERATIONAL!
2025-07-24 08:25:03,526 - INFO - [sentinel2_tss_pipeline.py:7302] - Active marine visualization features: Natural RGB, False Color RGB, Water-specific RGB, Water Quality Indices, Chlorophyll Indices, Turbidity Indices
2025-07-24 08:25:05,331 - INFO - [sentinel2_tss_pipeline.py:3754] - SNAP_HOME: C:\Program Files\esa-snap
2025-07-24 08:25:09,363 - INFO - [sentinel2_tss_pipeline.py:3765] - ‚úì GPT validated: C:\Program Files\esa-snap\bin\gpt.exe
2025-07-24 08:25:09,365 - INFO - [sentinel2_tss_pipeline.py:3872] - Complete processing graph saved: s2_complete_processing_with_subset.xml
2025-07-24 08:25:09,365 - INFO - [sentinel2_tss_pipeline.py:3794] - ‚úì Processing graph created for mode: complete_pipeline
2025-07-24 08:25:09,366 - INFO - [sentinel2_tss_pipeline.py:3231] - Initialized S2 Marine Visualization Processor
2025-07-24 08:25:09,367 - INFO - [sentinel2_tss_pipeline.py:3232] - Configuration settings:
2025-07-24 08:25:09,367 - INFO - [sentinel2_tss_pipeline.py:3233] -   Natural color RGB: True
2025-07-24 08:25:09,368 - INFO - [sentinel2_tss_pipeline.py:3234] -   False color RGB: True
2025-07-24 08:25:09,368 - INFO - [sentinel2_tss_pipeline.py:3235] -   Water-specific RGB: True
2025-07-24 08:25:09,369 - INFO - [sentinel2_tss_pipeline.py:3236] -   Research RGB: True
2025-07-24 08:25:09,370 - INFO - [sentinel2_tss_pipeline.py:3237] -   Water quality indices: True
2025-07-24 08:25:09,370 - INFO - [sentinel2_tss_pipeline.py:3238] -   Chlorophyll indices: True
2025-07-24 08:25:09,371 - INFO - [sentinel2_tss_pipeline.py:3239] -   Turbidity indices: True
2025-07-24 08:25:09,371 - INFO - [sentinel2_tss_pipeline.py:3240] -   Advanced indices: True
2025-07-24 08:25:09,372 - INFO - [sentinel2_tss_pipeline.py:3241] -   Output format: GeoTIFF
2025-07-24 08:25:09,372 - INFO - [sentinel2_tss_pipeline.py:3242] -   Contrast enhancement: True
2025-07-24 08:25:09,374 - INFO - [sentinel2_tss_pipeline.py:3243] -   Contrast method: percentile_stretch
2025-07-24 08:25:09,374 - INFO - [sentinel2_tss_pipeline.py:3244] -   Export metadata: True
2025-07-24 08:25:09,374 - INFO - [sentinel2_tss_pipeline.py:3245] -   Create overview images: True
2025-07-24 08:25:09,376 - INFO - [sentinel2_tss_pipeline.py:3260] - Expected products: ~11 RGB composites + ~13 spectral indices
2025-07-24 08:25:09,376 - INFO - [sentinel2_tss_pipeline.py:3261] - Marine visualization processor ready for processing
2025-07-24 08:25:09,376 - INFO - [sentinel2_tss_pipeline.py:1148] - Marine visualization processor initialized
2025-07-24 08:25:09,377 - INFO - [sentinel2_tss_pipeline.py:2590] - Initialized Advanced Aquatic Processor with scientific algorithms
2025-07-24 08:25:09,377 - INFO - [sentinel2_tss_pipeline.py:1161] - Initialized Jiang TSS Processor with enhanced methodology
2025-07-24 08:25:09,378 - INFO - [sentinel2_tss_pipeline.py:1164] - Jiang TSS enabled: True
2025-07-24 08:25:09,378 - INFO - [sentinel2_tss_pipeline.py:1165] - Advanced algorithms enabled: True
2025-07-24 08:25:09,379 - INFO - [sentinel2_tss_pipeline.py:1166] - Marine visualization enabled: True
2025-07-24 08:25:09,379 - INFO - [sentinel2_tss_pipeline.py:1169] - Working algorithms available:
2025-07-24 08:25:09,380 - INFO - [sentinel2_tss_pipeline.py:1170] -   ‚úì Water Clarity: True
2025-07-24 08:25:09,381 - INFO - [sentinel2_tss_pipeline.py:1171] -   ‚úì HAB Detection: True
2025-07-24 08:25:09,381 - INFO - [sentinel2_tss_pipeline.py:1172] - Note: Only Sentinel-2 compatible algorithms included
2025-07-24 08:25:09,382 - INFO - [sentinel2_tss_pipeline.py:1178] - Marine visualization configuration:
2025-07-24 08:25:09,382 - INFO - [sentinel2_tss_pipeline.py:1179] -   ‚úì Natural color RGB: True
2025-07-24 08:25:09,383 - INFO - [sentinel2_tss_pipeline.py:1180] -   ‚úì False color RGB: True
2025-07-24 08:25:09,383 - INFO - [sentinel2_tss_pipeline.py:1181] -   ‚úì Water-specific RGB: True
2025-07-24 08:25:09,384 - INFO - [sentinel2_tss_pipeline.py:1182] -   ‚úì Research RGB: True
2025-07-24 08:25:09,385 - INFO - [sentinel2_tss_pipeline.py:1183] -   ‚úì Water quality indices: True
2025-07-24 08:25:09,385 - INFO - [sentinel2_tss_pipeline.py:1184] -   ‚úì Chlorophyll indices: True
2025-07-24 08:25:09,386 - INFO - [sentinel2_tss_pipeline.py:1185] -   ‚úì Turbidity indices: True
2025-07-24 08:25:09,386 - INFO - [sentinel2_tss_pipeline.py:1186] -   ‚úì Advanced indices: True
2025-07-24 08:25:09,387 - INFO - [sentinel2_tss_pipeline.py:1187] -   Output format: GeoTIFF
2025-07-24 08:25:09,387 - INFO - [sentinel2_tss_pipeline.py:1188] -   Contrast enhancement: True
2025-07-24 08:25:09,388 - INFO - [sentinel2_tss_pipeline.py:1192] - Jiang TSS Processor initialization completed successfully
2025-07-24 08:25:09,389 - INFO - [sentinel2_tss_pipeline.py:4690] - Initialized Unified S2-TSS Processor - Mode: complete_pipeline
2025-07-24 08:25:09,389 - INFO - [sentinel2_tss_pipeline.py:7562] - TEST MODE: Processing only 2 products
2025-07-24 08:25:09,390 - INFO - [sentinel2_tss_pipeline.py:4764] - 
--------------------------------------------------------------------------------
2025-07-24 08:25:09,391 - INFO - [sentinel2_tss_pipeline.py:4765] - Processing 1/2: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753
2025-07-24 08:25:09,391 - INFO - [sentinel2_tss_pipeline.py:4766] - Mode: complete_pipeline
2025-07-24 08:25:09,392 - INFO - [sentinel2_tss_pipeline.py:4767] - --------------------------------------------------------------------------------
2025-07-24 08:25:09,392 - INFO - [sentinel2_tss_pipeline.py:4781] - Step 1: S2 Processing (L1C ‚Üí C2RCC)
2025-07-24 08:25:09,393 - INFO - [sentinel2_tss_pipeline.py:4048] - Processing: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-24 08:25:09,394 - INFO - [sentinel2_tss_pipeline.py:4049] -   Mode: complete_pipeline
2025-07-24 08:25:09,394 - INFO - [sentinel2_tss_pipeline.py:4050] -   Resolution: 10m
2025-07-24 08:25:09,395 - INFO - [sentinel2_tss_pipeline.py:4051] -   ECMWF: True
2025-07-24 08:25:09,397 - INFO - [sentinel2_tss_pipeline.py:4110] - Starting S2 processing with C2RCC...
2025-07-24 08:25:09,397 - INFO - [sentinel2_tss_pipeline.py:4226] - Executing GPT processing...
2025-07-24 08:34:01,287 - INFO - [sentinel2_tss_pipeline.py:4272] - ============================================================
2025-07-24 08:34:01,287 - INFO - [sentinel2_tss_pipeline.py:4273] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-24 08:34:01,290 - INFO - [sentinel2_tss_pipeline.py:4274] - ============================================================
2025-07-24 08:34:01,290 - INFO - [sentinel2_tss_pipeline.py:4275] - C2RCC file: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-24 08:34:01,290 - INFO - [sentinel2_tss_pipeline.py:4276] - Data folder: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4286] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-24 08:34:01,292 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó TSM: conc_tsm.img (missing/empty)
2025-07-24 08:34:01,292 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó CHL: conc_chl.img (missing/empty)
2025-07-24 08:34:01,292 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó TSM uncertainties: unc_tsm.img (missing/empty)
2025-07-24 08:34:01,292 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó CHL uncertainties: unc_chl.img (missing/empty)
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4323] - ‚ÑπÔ∏è  TSM/CHL products will be calculated from IOP products
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4324] -    Using SNAP formulas:
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4325] -    ‚Ä¢ TSM = TSMfac * (bpart + bwit)^TSMexp
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4326] -    ‚Ä¢ CHL = apig^CHLexp * CHLfac
2025-07-24 08:34:01,292 - INFO - [sentinel2_tss_pipeline.py:4329] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-24 08:34:01,300 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_apig.img (146586.6 KB)
2025-07-24 08:34:01,302 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_adet.img (146586.6 KB)
2025-07-24 08:34:01,302 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_agelb.img (146586.6 KB)
2025-07-24 08:34:01,302 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_bpart.img (146586.6 KB)
2025-07-24 08:34:01,302 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_bwit.img (146586.6 KB)
2025-07-24 08:34:01,302 - INFO - [sentinel2_tss_pipeline.py:4495] - üîÑ Calculating missing iop_btot from bpart + bwit...
2025-07-24 08:34:01,663 - INFO - [sentinel2_tss_pipeline.py:4523] - Calculated btot: shape=(10771, 3484), valid_pixels=37526164
2025-07-24 08:34:03,358 - INFO - [sentinel2_tss_pipeline.py:609] - Successfully wrote raster: iop_btot.img
2025-07-24 08:34:03,367 - INFO - [sentinel2_tss_pipeline.py:4536] - ‚úÖ Successfully calculated and saved iop_btot.img (123852.1 KB)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4345] -    ‚úì iop_btot.img (calculated from bpart + bwit)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4353] - 
üåä JIANG TSS READINESS:
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4582] - üîç Checking for water reflectance bands in: D:/GSEU_WP5/02_TSS_Results\C2RCC_Products\Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 443nm: rrs_B1.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 490nm: rrs_B2.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 560nm: rrs_B3.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 665nm: rrs_B4.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 705nm: rrs_B5.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 740nm: rrs_B6.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 783nm: rrs_B7.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 865nm: rrs_B8A.img (rrs)
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4613] - üìä Band type summary: {'rrs': 8}
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4358] - ‚úÖ EXCELLENT: All 8/8 rhow bands available
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4381] - 
üìä OVERALL ASSESSMENT:
2025-07-24 08:34:03,377 - INFO - [sentinel2_tss_pipeline.py:4393] - ‚úÖ ADEQUATE: Jiang TSS ready, some products missing
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:4399] - ============================================================
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:4121] - ‚úÖ S2 processing SUCCESS: S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753.zip
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:4122] -    Output: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8MB)
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:4123] -    Processing time: 8.9 minutes
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:4130] - Calculating missing SNAP TSM/CHL concentrations from IOP products...
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:815] - SNAP TSM/CHL Calculator initialized:
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:816] -   TSM formula: TSM = 1.06 * (bpart + bwit)^0.942
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:817] -   CHL formula: CHL = apig^1.04 * 21.0
2025-07-24 08:34:03,397 - INFO - [sentinel2_tss_pipeline.py:822] - Calculating SNAP TSM/CHL from IOP products...
2025-07-24 08:34:03,640 - INFO - [sentinel2_tss_pipeline.py:848] - ‚úì Loaded apig: (10771, 3484), mean=0.0307
2025-07-24 08:34:03,893 - INFO - [sentinel2_tss_pipeline.py:848] - ‚úì Loaded bpart: (10771, 3484), mean=0.4536
2025-07-24 08:34:04,135 - INFO - [sentinel2_tss_pipeline.py:848] - ‚úì Loaded bwit: (10771, 3484), mean=0.1651
2025-07-24 08:34:04,135 - INFO - [sentinel2_tss_pipeline.py:858] - Calculating CHL concentration from iop_apig...
2025-07-24 08:34:04,582 - INFO - [sentinel2_tss_pipeline.py:887] - CHL calculation: 27150838 valid pixels out of 27150838 processed
2025-07-24 08:34:06,239 - INFO - [sentinel2_tss_pipeline.py:609] - Successfully wrote raster: conc_chl.img
2025-07-24 08:34:06,413 - INFO - [sentinel2_tss_pipeline.py:906] - ‚úì CHL concentration saved: 72.4% coverage, mean=0.822 mg/m¬≥
2025-07-24 08:34:06,414 - INFO - [sentinel2_tss_pipeline.py:916] - Calculating TSM concentration from bpart + bwit (btot approximation)...
2025-07-24 08:34:06,909 - INFO - [sentinel2_tss_pipeline.py:948] - TSM calculation: 27150838 valid pixels out of 27150838 processed
2025-07-24 08:34:08,488 - INFO - [sentinel2_tss_pipeline.py:609] - Successfully wrote raster: conc_tsm.img
2025-07-24 08:34:08,662 - INFO - [sentinel2_tss_pipeline.py:967] - ‚úì TSM concentration saved: 72.4% coverage, mean=0.876 g/m¬≥
2025-07-24 08:34:08,690 - INFO - [sentinel2_tss_pipeline.py:4143] - ‚úÖ SNAP TSM calculation successful!
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4146] - ‚úÖ SNAP CHL calculation successful!
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4272] - ============================================================
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4273] - C2RCC OUTPUT VERIFICATION REPORT
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4274] - ============================================================
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4275] - C2RCC file: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim (20.8 MB)
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4276] - Data folder: Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-24 08:34:08,694 - INFO - [sentinel2_tss_pipeline.py:4286] - 
üß™ SNAP TSM/CHL PRODUCTS (Critical for Analysis):
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4297] -    ‚úì TSM: conc_tsm.img (123543.0 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4297] -    ‚úì CHL: conc_chl.img (128436.9 KB)
2025-07-24 08:34:08,698 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó TSM uncertainties: unc_tsm.img (missing/empty)
2025-07-24 08:34:08,698 - WARNING - [sentinel2_tss_pipeline.py:4307] -    ‚úó CHL uncertainties: unc_chl.img (missing/empty)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4320] - ‚úÖ SUCCESS: Both TSM and CHL products available!
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4321] -    ‚ö† Uncertainties: Not available (calculated products)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4329] - 
üî¨ SNAP IOP PRODUCTS (5/6 available):
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_apig.img (146586.6 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_adet.img (146586.6 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_agelb.img (146586.6 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_bpart.img (146586.6 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_bwit.img (146586.6 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4339] -    ‚úì iop_btot.img (123852.1 KB)
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4353] - 
üåä JIANG TSS READINESS:
2025-07-24 08:34:08,698 - INFO - [sentinel2_tss_pipeline.py:4582] - üîç Checking for water reflectance bands in: D:/GSEU_WP5/02_TSS_Results\C2RCC_Products\Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-24 08:34:08,708 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 443nm: rrs_B1.img (rrs)
2025-07-24 08:34:08,708 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 490nm: rrs_B2.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 560nm: rrs_B3.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 665nm: rrs_B4.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 705nm: rrs_B5.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 740nm: rrs_B6.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 783nm: rrs_B7.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4603] - ‚úì Found band 865nm: rrs_B8A.img (rrs)
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4613] - üìä Band type summary: {'rrs': 8}
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4358] - ‚úÖ EXCELLENT: All 8/8 rhow bands available
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4381] - 
üìä OVERALL ASSESSMENT:
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4390] - üëç GOOD: Jiang TSS ready, SNAP products will be calculated
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4399] - ============================================================
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4159] - üìä UPDATED SNAP PRODUCTS STATUS:
2025-07-24 08:34:08,710 - INFO - [sentinel2_tss_pipeline.py:4160] -    TSM=True, CHL=True, Uncertainties=False
2025-07-24 08:34:08,718 - INFO - [sentinel2_tss_pipeline.py:4170] - ‚úÖ S2 processing completed - ready for TSS processing
2025-07-24 08:34:08,718 - INFO - [sentinel2_tss_pipeline.py:4171] - ‚ÑπÔ∏è  TSS processing (Jiang + Marine Viz) handled by separate processors
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:4797] - Step 2: TSS Processing (Jiang)
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1423] - üßÆ Starting comprehensive TSS processing for S2A_MSIL1C_20190105T112441_N0500_R037_T29TNF_20221215T164753
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1429] - ‚úì Received intermediate paths for band scaling fix:
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1431] -   geometric_path: D:/GSEU_WP5/02_TSS_Results\Geometric_Products\Resampled_S2A_20190105T112441_T29TNF_Subset.dim
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1431] -   c2rcc_path: D:/GSEU_WP5/02_TSS_Results\C2RCC_Products\Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.dim
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1436] - üîç Step 1: Loading water reflectance bands
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1358] - üéØ Searching for COMPLETE 8-band datasets in: D:/GSEU_WP5/02_TSS_Results\C2RCC_Products\Resampled_S2A_20190105T112441_T29TNF_Subset_C2RCC.data
2025-07-24 08:34:08,831 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 443nm: rrs_B1.img (rrs)
2025-07-24 08:34:08,839 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 490nm: rrs_B2.img (rrs)
2025-07-24 08:34:08,839 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 560nm: rrs_B3.img (rrs)
2025-07-24 08:34:08,839 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 665nm: rrs_B4.img (rrs)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 705nm: rrs_B5.img (rrs)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 740nm: rrs_B6.img (rrs)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 783nm: rrs_B7.img (rrs)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1373] - ‚úì Found 865nm: rrs_B8A.img (rrs)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1379] - üìä Band type summary: {'rrs': 8}
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1387] - üéâ PERFECT: Complete 8-band dataset found - Jiang algorithm ready
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1409] - üîß RRS bands detected - no unit conversion needed (already in sr‚Åª¬π)
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1449] - üìä Step 2: Loading band data into memory
2025-07-24 08:34:08,841 - INFO - [sentinel2_tss_pipeline.py:1208] - Loading 8 spectral bands into memory
2025-07-24 08:34:09,972 - INFO - [sentinel2_tss_pipeline.py:1226] - ‚úÖ Successfully loaded 8 bands into memory
2025-07-24 08:34:09,972 - INFO - [sentinel2_tss_pipeline.py:1455] - üîß Step 3: Applying unit conversions
2025-07-24 08:34:09,972 - INFO - [sentinel2_tss_pipeline.py:1248] - üîß Detected band types: ['rrs']
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1279] - ‚úÖ All rrs bands - no conversion needed:
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   443nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   490nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   560nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   665nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   705nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   740nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   783nm: rrs (no conversion)
2025-07-24 08:34:10,107 - INFO - [sentinel2_tss_pipeline.py:1282] -   865nm: rrs (no conversion)
2025-07-24 08:34:10,561 - WARNING - [sentinel2_tss_pipeline.py:1316] - Band 705nm: High Rrs values detected (max=0.027851)
2025-07-24 08:34:10,569 - WARNING - [sentinel2_tss_pipeline.py:1317] -   This may indicate incorrect unit conversion or data issues
2025-07-24 08:34:10,855 - INFO - [sentinel2_tss_pipeline.py:1459] - üßÆ Step 4: Applying Jiang TSS methodology
2025-07-24 08:34:10,855 - INFO - [sentinel2_tss_pipeline.py:1630] - Applying Jiang methodology to pre-converted Rrs data
2025-07-24 08:34:10,926 - INFO - [sentinel2_tss_pipeline.py:1645] - ‚ÑπÔ∏è  Using pre-converted Rrs data (no additional œÄ division)
2025-07-24 08:34:11,310 - INFO - [sentinel2_tss_pipeline.py:1854] - Processing 27150838 valid pixels with corrected Jiang algorithm
